import * as tslib_1 from "tslib";
import { Injectable } from "@angular/core";
import { NgxDatetimeRangePickerConstants } from "./ngx-datetime-range-picker.constants";
import * as i0 from "@angular/core";
const moment = require("moment");
const _ = require("lodash");
const DEFAULT_TYPE = NgxDatetimeRangePickerConstants.DEFAULT.TYPE;
const DEFAULT_INPUT_CLASS = NgxDatetimeRangePickerConstants.DEFAULT.INPUT_CLASS;
const DEFAULT_DATE_FROMAT = NgxDatetimeRangePickerConstants.DEFAULT.DATE_FROMAT;
const DEFAULT_TIME_FORMAT = NgxDatetimeRangePickerConstants.DEFAULT.TIME_FORMAT;
const DEFAULT_START_DATE = NgxDatetimeRangePickerConstants.DEFAULT.START_DATE;
const DEFAULT_END_DATE = NgxDatetimeRangePickerConstants.DEFAULT.END_DATE;
const DEFAULT_MIN_DATE = NgxDatetimeRangePickerConstants.DEFAULT.MIN_DATE;
const DEFAULT_MAX_DATE = NgxDatetimeRangePickerConstants.DEFAULT.MAX_DATE;
const DEFAULT_START_TIME = NgxDatetimeRangePickerConstants.DEFAULT.START_TIME;
const DEFAULT_END_TIME = NgxDatetimeRangePickerConstants.DEFAULT.END_TIME;
const DEFAULT_MODEL_KEYS = NgxDatetimeRangePickerConstants.DEFAULT.MODEL_KEYS;
const MONTHS_AVAILABLE = NgxDatetimeRangePickerConstants.CONSTANT.MONTHS_AVAILABLE;
const DEFAULT_TIMEZONE_CODE = NgxDatetimeRangePickerConstants.DEFAULT.TZ_CODE;
const EU_TZ_CODE = NgxDatetimeRangePickerConstants.CONSTANT.EU_TZ_CODE;
const TZ_NAMES = NgxDatetimeRangePickerConstants.CONSTANT.TZ_NAMES;
let NgxDatetimeRangePickerService = class NgxDatetimeRangePickerService {
    getNotAvailableText() {
        return "N/A";
    }
    getDefaultAriaLabelOptions() {
        return {
            inputField: "Date Range Input Field"
        };
    }
    getDefaultOptions() {
        return {
            dateArray: [],
            startDate: DEFAULT_START_DATE,
            endDate: DEFAULT_END_DATE,
            minDate: DEFAULT_MIN_DATE,
            maxDate: DEFAULT_MAX_DATE,
            startTime: DEFAULT_START_TIME,
            endTime: DEFAULT_END_TIME
        };
    }
    getDefaultSettings() {
        return {
            type: DEFAULT_TYPE,
            modelKeys: DEFAULT_MODEL_KEYS,
            selectedModel: undefined,
            showTimezoneSelect: false,
            useLocalTimezone: false,
            timePicker: false,
            inputClass: DEFAULT_INPUT_CLASS,
            inputDateFormat: null,
            viewDateFormat: DEFAULT_DATE_FROMAT,
            outputDateFormat: DEFAULT_DATE_FROMAT,
            singleDatePicker: false,
            componentDisabled: false,
            placeholder: "Select Date",
            showRowNumber: true,
            availableRanges: {},
            showRanges: true,
            disableWeekends: false,
            disableWeekdays: false,
            retailCalendar: false,
            displayBeginDate: false,
            displayEndDate: false,
            ariaLabels: this.getDefaultAriaLabelOptions()
        };
    }
    formatDateToDefaultFormat(date, format = DEFAULT_DATE_FROMAT) {
        let fromattedDate = null;
        if (date) {
            if (!isNaN(Number(date))) {
                fromattedDate = moment(date).format(DEFAULT_DATE_FROMAT);
            }
            else {
                if (!format) {
                    format = moment(date)._f;
                }
                else {
                    if (format !== moment(date)._f) {
                        console.warn("ERR_NGX_DATETIME_RANGE_PICKER: inputDateFormat !== dateFormat");
                    }
                }
                if (!format) {
                    console.warn("ERR_NGX_DATETIME_RANGE_PICKER: The provided date is in unknown format. Pass the format or pass the date in known format");
                }
                fromattedDate = moment(date, format).format(DEFAULT_DATE_FROMAT);
            }
        }
        return fromattedDate;
    }
    formatTimeToDefaultFormat(time) {
        let formattedTime = null;
        if (time) {
            if (time.indexOf(":") > -1) {
                if (time.indexOf("AM") > -1 || time.indexOf("PM") > -1) {
                    formattedTime = moment(time, "h:mm A").format(DEFAULT_TIME_FORMAT);
                }
                else {
                    formattedTime = time;
                }
            }
            else {
                console.warn("ERR_NGX_DATETIME_RANGE_PICKER: The provided time is not in correct format. Format: HH:mm or hh:mm A");
            }
        }
        return formattedTime;
    }
    getFrequencyColumnHeader(type) {
        return (() => {
            switch (type) {
                case "daily":
                    return "W#";
                case "weekly":
                    return "";
                case "monthly":
                    return "Q#";
                case "quarterly":
                    return "Year";
                case "yearly":
                    return "";
            }
        })();
    }
    getCalendarRowNumberText(type, number) {
        return (() => {
            switch (type) {
                case "daily":
                    return `W${number}`;
                case "weekly":
                    return "";
                case "monthly":
                    return `Q${number}`;
                case "quarterly":
                    return `${number}`;
                case "yearly":
                    return "";
            }
        })();
    }
    createDefaultRanges(config) {
        const ranges = {};
        const type = config.type;
        const maxDate = _.cloneDeep(config.maxDate);
        const formattedMaxDate = this.formatDateToDefaultFormat(maxDate, DEFAULT_DATE_FROMAT);
        if (type === "daily") {
            ranges["Last 7 Days"] = {
                startDate: moment(formattedMaxDate, DEFAULT_DATE_FROMAT)
                    .subtract(6, "days")
                    .format(DEFAULT_DATE_FROMAT),
                endDate: formattedMaxDate
            };
            ranges["Last 30 Days"] = {
                startDate: moment(formattedMaxDate, DEFAULT_DATE_FROMAT)
                    .subtract(29, "days")
                    .format(DEFAULT_DATE_FROMAT),
                endDate: formattedMaxDate
            };
            ranges["Last 90 Days"] = {
                startDate: moment(formattedMaxDate, DEFAULT_DATE_FROMAT)
                    .subtract(89, "days")
                    .format(DEFAULT_DATE_FROMAT),
                endDate: formattedMaxDate
            };
        }
        else if (type === "weekly") {
            ranges["Last 4 Weeks"] = {
                startDate: moment(formattedMaxDate, DEFAULT_DATE_FROMAT)
                    .subtract(3, "weeks")
                    .format(DEFAULT_DATE_FROMAT),
                endDate: formattedMaxDate
            };
            ranges["Last 13 Weeks"] = {
                startDate: moment(formattedMaxDate, DEFAULT_DATE_FROMAT)
                    .subtract(12, "weeks")
                    .format(DEFAULT_DATE_FROMAT),
                endDate: formattedMaxDate
            };
            ranges["Last 26 Weeks"] = {
                startDate: moment(formattedMaxDate, DEFAULT_DATE_FROMAT)
                    .subtract(25, "weeks")
                    .format(DEFAULT_DATE_FROMAT),
                endDate: formattedMaxDate
            };
        }
        else if (type === "monthly") {
            // if(retailCalendar) ? subtract(3, 'months')....so on for 'Last 3 Months'....so on
            ranges["Last 3 Months"] = {
                startDate: moment(formattedMaxDate, DEFAULT_DATE_FROMAT)
                    .subtract(2, "months")
                    .format(DEFAULT_DATE_FROMAT),
                endDate: formattedMaxDate
            };
            ranges["Last 6 Months"] = {
                startDate: moment(formattedMaxDate, DEFAULT_DATE_FROMAT)
                    .subtract(5, "months")
                    .format(DEFAULT_DATE_FROMAT),
                endDate: formattedMaxDate
            };
            ranges["Last 9 Months"] = {
                startDate: moment(formattedMaxDate, DEFAULT_DATE_FROMAT)
                    .subtract(8, "months")
                    .format(DEFAULT_DATE_FROMAT),
                endDate: formattedMaxDate
            };
        }
        else if (type === "quarterly") {
            // if(retailCalendar) ? subtract(1, 'quarters')....so on for 'Last 2 Quarters'....so on
            ranges["Last 2 Quarters"] = {
                startDate: moment(formattedMaxDate, DEFAULT_DATE_FROMAT)
                    .subtract(1, "quarters")
                    .format(DEFAULT_DATE_FROMAT),
                endDate: formattedMaxDate
            };
            ranges["Last 4 Quarters"] = {
                startDate: moment(formattedMaxDate, DEFAULT_DATE_FROMAT)
                    .subtract(3, "quarters")
                    .format(DEFAULT_DATE_FROMAT),
                endDate: formattedMaxDate
            };
        }
        else if (type === "yearly") {
            ranges["Last Year"] = {
                startDate: moment(formattedMaxDate, DEFAULT_DATE_FROMAT)
                    .subtract(1, "year")
                    .format(DEFAULT_DATE_FROMAT),
                endDate: formattedMaxDate
            };
        }
        ranges["Custom Range"] = { startDate: null, endDate: null };
        return ranges;
    }
    getSanitizedDateArray(config) {
        const sanitizedDateArray = [];
        const type = config.type;
        const dateArray = config.dateArray;
        const inputDateFormat = config.inputDateFormat;
        // dateArray can have nulls
        _.forEach(dateArray, (date) => {
            if (date) {
                let format = null;
                if (isNaN(Number(date))) {
                    if (inputDateFormat) {
                        format = inputDateFormat;
                    }
                    else {
                        format = moment(date)._f;
                    }
                }
                if (inputDateFormat !== moment(date)._f) {
                    console.warn("ERR_NGX_DATETIME_RANGE_PICKER: inputDateFormat !== dateFormat in dateArray. Converted dates might not be as expected");
                }
                let value = format ? moment(date, format).format(format) : moment(date).valueOf();
                if (type === "weekly") {
                    value = format
                        ? moment(date, format)
                            .endOf("week")
                            .format(format)
                        : moment(date)
                            .endOf("week")
                            .valueOf();
                }
                else if (type === "monthly") {
                    value = format
                        ? moment(date, format)
                            .endOf("month")
                            .format(format)
                        : moment(date)
                            .endOf("month")
                            .valueOf();
                }
                else if (type === "quarterly") {
                    value = format
                        ? moment(date, format)
                            .endOf("quarter")
                            .format(format)
                        : moment(date)
                            .endOf("quarter")
                            .valueOf();
                }
                else if (type === "yearly") {
                    value = format
                        ? moment(date, format)
                            .endOf("year")
                            .format(format)
                        : moment(date)
                            .endOf("year")
                            .valueOf();
                }
                if (value) {
                    sanitizedDateArray.push(value);
                }
                else {
                    console.warn(`ERR_NGX_DATETIME_RANGE_PICKER: dateArray values are in unknown format. Pass the format or pass the dates in known format`);
                }
            }
        });
        return _.uniqBy(sanitizedDateArray);
    }
    getNumberOfWeeks(date) {
        let numberOfWeeks = null;
        if (date) {
            const monthStart = moment(date, DEFAULT_DATE_FROMAT)
                .startOf("month")
                .day();
            const monthEnd = Number(moment(date, DEFAULT_DATE_FROMAT)
                .endOf("month")
                .format("D"));
            numberOfWeeks = Math.ceil((monthStart + monthEnd) / 7);
        }
        return numberOfWeeks;
    }
    getYearlyWeekCount(year, retailCalendar) {
        let weekCount = null;
        if (year) {
            const yearStartDate = moment(year, "YYYY")
                .startOf("year")
                .format(DEFAULT_DATE_FROMAT);
            const yearEndDate = moment(year, "YYYY")
                .endOf("year")
                .format(DEFAULT_DATE_FROMAT);
            const yearEndWeekEndDate = moment(yearEndDate, DEFAULT_DATE_FROMAT)
                .startOf("week")
                .format(DEFAULT_DATE_FROMAT);
            const yearStartWeekEndDate = moment(yearStartDate, DEFAULT_DATE_FROMAT)
                .endOf("week")
                .format(DEFAULT_DATE_FROMAT);
            const yearSartWeekNumber = this.getWeekNumber(yearStartWeekEndDate);
            const yearEndWeekNumber = this.getWeekNumber(yearEndWeekEndDate);
            weekCount = yearEndWeekNumber - yearSartWeekNumber + 1;
        }
        return weekCount;
    }
    getMonthsAvailable(minDate, maxDate, selectedYear) {
        const months = [];
        if (minDate && maxDate && selectedYear) {
            let minDatems = moment(minDate, DEFAULT_DATE_FROMAT).valueOf();
            let maxDatems = moment(maxDate, DEFAULT_DATE_FROMAT).valueOf();
            const yearStartms = moment()
                .year(selectedYear)
                .startOf("year")
                .valueOf();
            const yearEndms = moment()
                .year(selectedYear)
                .endOf("year")
                .valueOf();
            if (minDatems < yearStartms) {
                minDatems = yearStartms;
            }
            if (maxDatems > yearEndms) {
                maxDatems = yearEndms;
            }
            let minDateMonthNumber = moment(minDatems).month();
            const diff = moment(maxDatems).diff(moment(minDatems), "months");
            const maxMonths = diff < MONTHS_AVAILABLE.length ? diff : MONTHS_AVAILABLE.length;
            for (let i = 0; i <= maxMonths; i++) {
                if (minDateMonthNumber >= MONTHS_AVAILABLE.length) {
                    months.push(MONTHS_AVAILABLE[minDateMonthNumber - MONTHS_AVAILABLE.length]);
                }
                else {
                    months.push(MONTHS_AVAILABLE[minDateMonthNumber]);
                }
                minDateMonthNumber++;
            }
        }
        return months;
    }
    getYearsAvailable(config) {
        const minDate = config ? config.minDate : "";
        const maxDate = config ? config.maxDate : "";
        const years = [];
        if (minDate && maxDate) {
            const minYear = Number(this.getSelectedYear(config, minDate, "left"));
            const maxYear = Number(this.getSelectedYear(config, maxDate, "right"));
            const diff = maxYear - minYear;
            for (let i = 0; i <= diff; i++) {
                years.push(`${minYear + i}`);
            }
        }
        return years.reverse();
    }
    isDateAvailable(date, minDate, maxDate, startDate, endDate, monthStartDate, monthEndDate, config) {
        let available = false;
        const type = config.type;
        const dateArray = config.dateArray ? config.dateArray : [];
        const inputDateFormat = config.inputDateFormat;
        const disableWeekends = config.disableWeekends;
        const disableWeekdays = config.disableWeekdays;
        if (type === "daily") {
            minDate = minDate > monthStartDate ? minDate : monthStartDate;
            maxDate = maxDate < monthEndDate ? maxDate : monthEndDate;
        }
        // if(date === minDate
        //     || date === maxDate) {
        //   available = true;
        // }
        if (date >= minDate && date <= maxDate) {
            if (dateArray.length > 0) {
                available = _.some(dateArray, (d) => {
                    let format = null;
                    if (isNaN(Number(date))) {
                        if (inputDateFormat) {
                            format = inputDateFormat;
                        }
                        else {
                            format = moment(date)._f;
                        }
                    }
                    return moment(d, format).valueOf() === date;
                });
            }
            else {
                available = true;
            }
            if (available) {
                if (disableWeekends) {
                    available = !this.isWeekend(date);
                }
                if (disableWeekdays) {
                    available = !this.isWeekday(date);
                }
            }
        }
        return available;
    }
    isDateInRange(date, minDate, maxDate, startDate, endDate, monthStartDate, monthEndDate, available, config) {
        let inRange = false;
        const type = config.type;
        const singleDatePicker = config.singleDatePicker;
        if (!singleDatePicker) {
            if (type === "daily") {
                minDate = monthStartDate;
                maxDate = monthEndDate;
            }
            if (date >= startDate && date <= endDate && date >= minDate && date <= maxDate) {
                if (available) {
                    inRange = true;
                }
            }
        }
        return inRange;
    }
    isDateActive(date, startDate, endDate, side) {
        let active = false;
        if ((date === startDate && side === "left") || (date === endDate && side === "right")) {
            active = true;
        }
        return active;
    }
    isDateToday(date, config) {
        let today = false;
        const todayDate = moment()
            .startOf("day")
            .valueOf();
        const type = config.type;
        const firstLastDay = this.getFirstLastDay(moment(todayDate).format(DEFAULT_DATE_FROMAT), type);
        const firstDay = moment(firstLastDay.firstDay, DEFAULT_DATE_FROMAT).valueOf();
        const lastDay = moment(firstLastDay.lastDay, DEFAULT_DATE_FROMAT).valueOf();
        if (date >= firstDay && date <= lastDay) {
            today = true;
        }
        return today;
    }
    isWeekday(date, format) {
        return !this.isWeekend(date, format);
    }
    isWeekend(date, format) {
        if (!format) {
            format = null;
        }
        const day = moment(date, format).day();
        return day === 0 || day === 6 ? true : false;
    }
    getCalendarRowVariables(options) {
        const variables = {};
        const type = options.type;
        const monthStartWeekNumber = options.monthStartWeekNumber;
        const dateRows = options.dateRows;
        const year = `${options.year}`;
        if (type === "daily") {
            variables.rowNumber = monthStartWeekNumber + dateRows;
            variables.columns = 6;
        }
        else if (type === "weekly") {
            // variables.rowNumber = `${(dateRows*2)+1} - ${(dateRows*2)+2}`;
            variables.rowNumber = ``;
            variables.columns = 6;
        }
        else if (type === "monthly") {
            variables.rowNumber = dateRows + 1;
            variables.columns = 2;
        }
        else if (type === "quarterly") {
            variables.rowNumber = year.charAt(dateRows);
            variables.columns = 0;
        }
        else if (type === "yearly") {
            variables.rowNumber = "";
            variables.columns = 0;
        }
        return variables;
    }
    getCalendarRowItemVariables(options) {
        const variables = {
            currentItemDate: "",
            rowItemText: "",
            itemCount: null
        };
        const type = options.type;
        const monthStartWeekNumber = options.monthStartWeekNumber;
        const yearStartDate = options.yearStartDate;
        const year = options.year;
        const rowItem = options.rowItem;
        const dateRows = options.dateRows;
        const columns = options.columns;
        const itemCount = rowItem + dateRows * columns + dateRows;
        let currentItemDate = "";
        let rowItemText = "";
        let firstLastDayObject = {};
        if (type === "daily") {
            if (!_.isNil(monthStartWeekNumber) && !_.isNil(dateRows) && !_.isNil(year)) {
                const yearStartDateDaily = moment()
                    .year(year)
                    .startOf("year")
                    .format(DEFAULT_DATE_FROMAT);
                currentItemDate = moment(yearStartDateDaily, DEFAULT_DATE_FROMAT)
                    .add(monthStartWeekNumber + dateRows - 1, "week")
                    .startOf("week")
                    .add(rowItem, "day")
                    .format(DEFAULT_DATE_FROMAT);
                rowItemText = moment(currentItemDate, DEFAULT_DATE_FROMAT).format("D");
            }
        }
        else if (type === "weekly") {
            if (!_.isNil(yearStartDate) && !_.isNil(itemCount)) {
                currentItemDate = moment(yearStartDate, DEFAULT_DATE_FROMAT)
                    .add(itemCount, "week")
                    .endOf("week")
                    .format(DEFAULT_DATE_FROMAT);
                const weekNumber = itemCount + 1;
                rowItemText = `W${weekNumber}`;
            }
        }
        else if (type === "monthly") {
            if (!_.isNil(itemCount) && !_.isNil(year)) {
                currentItemDate = moment()
                    .year(year)
                    .month(itemCount)
                    .endOf("month")
                    .format(DEFAULT_DATE_FROMAT);
                rowItemText = moment(currentItemDate, DEFAULT_DATE_FROMAT).format("MMM");
            }
        }
        else if (type === "quarterly") {
            if (!_.isNil(itemCount) && !_.isNil(year)) {
                currentItemDate = moment()
                    .year(year)
                    .quarter(itemCount + 1)
                    .endOf("quarter")
                    .format(DEFAULT_DATE_FROMAT);
                rowItemText = `Quarter ${itemCount + 1}`;
            }
        }
        firstLastDayObject = this.getFirstLastDay(currentItemDate, type);
        variables.itemCount = itemCount;
        variables.currentItemDate = currentItemDate;
        variables.rowItemText = rowItemText;
        variables.firstDay = firstLastDayObject.firstDay;
        variables.lastDay = firstLastDayObject.lastDay;
        return variables;
    }
    isRowIemValid(options) {
        let valid = false;
        const type = options.type;
        const year = options.year;
        const itemCount = options.itemCount;
        const retailCalendar = options.retailCalendar;
        const validWeekCount = this.getYearlyWeekCount(year, retailCalendar);
        if (type === "daily") {
            valid = true;
        }
        else if (type === "weekly") {
            if (itemCount < validWeekCount) {
                valid = true;
            }
        }
        else if (type === "monthly") {
            return true;
        }
        else if (type === "quarterly") {
            return true;
        }
        return valid;
    }
    formatStartDate(config, returnFormat) {
        const startDate = config ? config.startDate : null;
        const type = config ? config.type : "";
        let formattedStartDate = null;
        if (startDate) {
            formattedStartDate = moment(startDate, DEFAULT_DATE_FROMAT).format(returnFormat);
            if (type === "weekly") {
                formattedStartDate = moment(startDate, DEFAULT_DATE_FROMAT)
                    .startOf("week")
                    .format(returnFormat);
            }
            else if (type === "monthly") {
                formattedStartDate = moment(startDate, DEFAULT_DATE_FROMAT)
                    .startOf("month")
                    .format(returnFormat);
            }
            else if (type === "quarterly") {
                formattedStartDate = moment(startDate, DEFAULT_DATE_FROMAT)
                    .startOf("quarter")
                    .format(returnFormat);
            }
            else if (type === "yearly") {
                formattedStartDate = moment(startDate, DEFAULT_DATE_FROMAT)
                    .startOf("year")
                    .format(returnFormat);
            }
        }
        return formattedStartDate;
    }
    getSelectedYear(config, date, side) {
        return moment(date, DEFAULT_DATE_FROMAT).format("YYYY");
    }
    getFirstLastDay(date, type) {
        let firstDay = "";
        let lastDay = "";
        if (type === "daily") {
            firstDay = lastDay = date;
        }
        else if (type === "weekly") {
            firstDay = moment(date, DEFAULT_DATE_FROMAT)
                .startOf("week")
                .format(DEFAULT_DATE_FROMAT);
            lastDay = moment(date, DEFAULT_DATE_FROMAT)
                .endOf("week")
                .format(DEFAULT_DATE_FROMAT);
        }
        else if (type === "monthly") {
            firstDay = moment(date, DEFAULT_DATE_FROMAT)
                .startOf("month")
                .format(DEFAULT_DATE_FROMAT);
            lastDay = moment(date, DEFAULT_DATE_FROMAT)
                .endOf("month")
                .format(DEFAULT_DATE_FROMAT);
        }
        else if (type === "quarterly") {
            firstDay = moment(date, DEFAULT_DATE_FROMAT)
                .startOf("quarter")
                .format(DEFAULT_DATE_FROMAT);
            lastDay = moment(date, DEFAULT_DATE_FROMAT)
                .endOf("quarter")
                .format(DEFAULT_DATE_FROMAT);
        }
        else if (type === "yearly") {
            firstDay = moment(date, DEFAULT_DATE_FROMAT)
                .startOf("year")
                .format(DEFAULT_DATE_FROMAT);
            lastDay = moment(date, DEFAULT_DATE_FROMAT)
                .endOf("year")
                .format(DEFAULT_DATE_FROMAT);
        }
        return {
            firstDay,
            lastDay
        };
    }
    getLocalTimezone() {
        let tz = /\((.*)\)/.exec(new Date().toString())[1];
        if (tz === "Central Europe Standard Time") {
            tz = EU_TZ_CODE;
        }
        else {
            tz = DEFAULT_TIMEZONE_CODE;
        }
        return tz;
    }
    getZoneDate(tz, format, date) {
        if (date) {
            date = moment(date, format)
                .startOf("day")
                .valueOf();
        }
        else {
            date = moment().valueOf();
        }
        let today = new Date(date).toLocaleString("en-US", {
            timeZone: TZ_NAMES[tz]
        });
        today = moment(today, "MM/DD/YYYY, hh:mm:ss A");
        return today;
    }
    getZoneToday(tz, viewDateFormat) {
        const today = this.getZoneDate(tz, viewDateFormat);
        return moment(today).format(`${viewDateFormat}  hh:mm A`);
    }
    formatToZoneDate(tz, format, date) {
        const formattedDate = this.getZoneDate(tz, format, date);
        return moment(formattedDate).format(`${format}`);
    }
    convertToViewTimeItem(item) {
        let stringified_item = item + "";
        if (stringified_item.length === 1) {
            stringified_item = `0${stringified_item}`;
        }
        return stringified_item;
    }
    getWeekNumber(date) {
        if (date) {
            const year = moment(date, "YYYY-MM-DD").year();
            const month = moment(date, "YYYY-MM-DD").month();
            const day = Number(moment(date, "YYYY-MM-DD").format("D"));
            const yearStartms = new Date(year, 0, 1);
            const datems = new Date(year, month, day);
            return Math.ceil(((datems.getTime() - yearStartms.getTime()) / 86400000 + yearStartms.getDay() + 1) / 7);
        }
        else {
            console.warn("getWeekNumber: Invalid date");
            return this.getNotAvailableText();
        }
    }
};
NgxDatetimeRangePickerService.ngInjectableDef = i0.defineInjectable({ factory: function NgxDatetimeRangePickerService_Factory() { return new NgxDatetimeRangePickerService(); }, token: NgxDatetimeRangePickerService, providedIn: "root" });
NgxDatetimeRangePickerService = tslib_1.__decorate([
    Injectable({
        providedIn: "root"
    })
], NgxDatetimeRangePickerService);
export { NgxDatetimeRangePickerService };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmd4LWRhdGV0aW1lLXJhbmdlLXBpY2tlci5zZXJ2aWNlLmpzIiwic291cmNlUm9vdCI6Im5nOi8vbmd4LWRhdGV0aW1lLXJhbmdlLXBpY2tlci8iLCJzb3VyY2VzIjpbImxpYi9uZ3gtZGF0ZXRpbWUtcmFuZ2UtcGlja2VyLnNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDM0MsT0FBTyxFQUFFLCtCQUErQixFQUFFLE1BQU0sdUNBQXVDLENBQUM7O0FBSXhGLE1BQU0sTUFBTSxHQUFHLE9BQU8sQ0FBQyxRQUFRLENBQUMsQ0FBQztBQUNqQyxNQUFNLENBQUMsR0FBRyxPQUFPLENBQUMsUUFBUSxDQUFDLENBQUM7QUFFNUIsTUFBTSxZQUFZLEdBQUcsK0JBQStCLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQztBQUNsRSxNQUFNLG1CQUFtQixHQUFHLCtCQUErQixDQUFDLE9BQU8sQ0FBQyxXQUFXLENBQUM7QUFDaEYsTUFBTSxtQkFBbUIsR0FBRywrQkFBK0IsQ0FBQyxPQUFPLENBQUMsV0FBVyxDQUFDO0FBQ2hGLE1BQU0sbUJBQW1CLEdBQUcsK0JBQStCLENBQUMsT0FBTyxDQUFDLFdBQVcsQ0FBQztBQUNoRixNQUFNLGtCQUFrQixHQUFHLCtCQUErQixDQUFDLE9BQU8sQ0FBQyxVQUFVLENBQUM7QUFDOUUsTUFBTSxnQkFBZ0IsR0FBRywrQkFBK0IsQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDO0FBQzFFLE1BQU0sZ0JBQWdCLEdBQUcsK0JBQStCLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQztBQUMxRSxNQUFNLGdCQUFnQixHQUFHLCtCQUErQixDQUFDLE9BQU8sQ0FBQyxRQUFRLENBQUM7QUFDMUUsTUFBTSxrQkFBa0IsR0FBRywrQkFBK0IsQ0FBQyxPQUFPLENBQUMsVUFBVSxDQUFDO0FBQzlFLE1BQU0sZ0JBQWdCLEdBQUcsK0JBQStCLENBQUMsT0FBTyxDQUFD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QUFFLENBQUMsR0FBRyxRQUFRLEdBQUcsV0FBVyxDQUFDLE1BQU0sRUFBRSxHQUFHLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO1NBQzFHO2FBQU07WUFDTCxPQUFPLENBQUMsSUFBSSxDQUFDLDZCQUE2QixDQUFDLENBQUM7WUFDNUMsT0FBTyxJQUFJLENBQUMsbUJBQW1CLEVBQUUsQ0FBQztTQUNuQztJQUNILENBQUM7Q0FDRixDQUFBOztBQWh1QlksNkJBQTZCO0lBSHpDLFVBQVUsQ0FBQztRQUNWLFVBQVUsRUFBRSxNQUFNO0tBQ25CLENBQUM7R0FDVyw2QkFBNkIsQ0FndUJ6QztTQWh1QlksNkJBQTZCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gXCJAYW5ndWxhci9jb3JlXCI7XG5pbXBvcnQgeyBOZ3hEYXRldGltZVJhbmdlUGlja2VyQ29uc3RhbnRzIH0gZnJvbSBcIi4vbmd4LWRhdGV0aW1lLXJhbmdlLXBpY2tlci5jb25zdGFudHNcIjtcbmltcG9ydCB7IEFyaWFMYWJlbHNPcHRpb25zLCBOZ3hEYXRldGltZVJhbmdlUGlja2VyT3B0aW9ucywgTmd4RGF0ZXRpbWVSYW5nZVBpY2tlclNldHRpbmdzIH0gZnJvbSBcIi4vaW50ZXJmYWNlcy9pbmRleFwiO1xuXG5kZWNsYXJlIHZhciByZXF1aXJlOiBhbnk7XG5jb25zdCBtb21lbnQgPSByZXF1aXJlKFwibW9tZW50XCIpO1xuY29uc3QgXyA9IHJlcXVpcmUoXCJsb2Rhc2hcIik7XG5cbmNvbnN0IERFRkFVTFRfVFlQRSA9IE5neERhdGV0aW1lUmFuZ2VQaWNrZXJDb25zdGFudHMuREVGQVVMVC5UWVBFO1xuY29uc3QgREVGQVVMVF9JTlBVVF9DTEFTUyA9IE5neERhdGV0aW1lUmFuZ2VQaWNrZXJDb25zdGFudHMuREVGQVVMVC5JTlBVVF9DTEFTUztcbmNvbnN0IERFRkFVTFRfREFURV9GUk9NQVQgPSBOZ3hEYXRldGltZVJhbmdlUGlja2VyQ29uc3RhbnRzLkRFRkFVTFQuREFURV9GUk9NQVQ7XG5jb25zdCBERUZBVUxUX1RJTUVfRk9STUFUID0gTmd4RGF0ZXRpbWVSYW5nZVBpY2tlckNvbnN0YW50cy5ERUZBVUxULlRJTUVfRk9STUFUO1xuY29uc3QgREVGQVVMVF9TVEFSVF9EQVRFID0gTmd4RGF0ZXRpbWVSYW5nZVBpY2tlckNvbnN0YW50cy5ERUZBVUxULlNUQVJUX0RBVEU7XG5jb25zdCBERUZBVUxUX0VORF9EQVRFID0gTmd4RGF0ZXRpbWVSYW5nZVBpY2tlckNvbnN0YW50cy5ERUZBVUxULkVORF9EQVRFO1xuY29uc3QgREVGQVVMVF9NSU5fREFURSA9IE5neERhdGV0aW1lUmFuZ2VQaWNrZXJDb25zdGFudHMuREVGQVVMVC5NSU5fREFURTtcbmNvbnN0IERFRkFVTFRfTUFYX0RBVEUgPSBOZ3hEYXRldGltZVJhbmdlUGlja2VyQ29uc3RhbnRzLkRFRkFVTFQuTUFYX0RBVEU7XG5jb25zdCBERUZBVUxUX1NUQVJUX1RJTUUgPSBOZ3hEYXRldGltZVJhbmdlUGlja2VyQ29uc3RhbnRzLkRFRkFVTFQuU1RBUlRfVElNRTtcbmNvbnN0IERFRkFVTFRfRU5EX1RJTUUgPSBOZ3hEYXRldGltZVJhbmdlUGlja2VyQ29uc3RhbnRzLkRFRkFVTFQuRU5EX1RJTUU7XG5jb25zdCBERUZBVUxUX01PREVMX0tFWVMgPSBOZ3hEYXRldGltZVJhbmdlUGlja2VyQ29uc3RhbnRzLkRFRkFVTFQuTU9ERUxfS0VZUztcbmNvbnN0IE1PTlRIU19BVkFJTEFCTEUgPSBOZ3hEYXRldGltZVJhbmdlUGlja2VyQ29uc3RhbnRzLkNPTlNUQU5ULk1PTlRIU19BVkFJTEFCTEU7XG5jb25zdCBERUZBVUxUX1RJTUVaT05FX0NPREUgPSBOZ3hEYXRldGltZVJhbmdlUGlja2VyQ29uc3RhbnRzLkRFRkFVTFQuVFpfQ09ERTtcbmNvbnN0IEVVX1RaX0NPREUgPSBOZ3hEYXRldGltZVJhbmdlUGlja2VyQ29uc3RhbnRzLkNPTlNUQU5ULkVVX1RaX0NPREU7XG5jb25zdCBUWl9OQU1FUyA9IE5neERhdGV0aW1lUmFuZ2VQaWNrZXJDb25zdGFudHMuQ09OU1RBTlQuVFpfTkFNRVM7XG5cbkBJbmplY3RhYmxlKHtcbiAgcHJvdmlkZWRJbjogXCJyb290XCJcbn0pXG5leHBvcnQgY2xhc3MgTmd4RGF0ZXRpbWVSYW5nZVBpY2tlclNlcnZpY2Uge1xuICBnZXROb3RBdmFpbGFibGVUZXh0KCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIFwiTi9BXCI7XG4gIH1cblxuICBnZXREZWZhdWx0QXJpYUxhYmVsT3B0aW9ucygpOiBBcmlhTGFiZWxzT3B0aW9ucyB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGlucHV0RmllbGQ6IFwiRGF0ZSBSYW5nZSBJbnB1dCBGaWVsZFwiIGFzIHN0cmluZ1xuICAgIH07XG4gIH1cblxuICBnZXREZWZhdWx0T3B0aW9ucygpOiBOZ3hEYXRldGltZVJhbmdlUGlja2VyT3B0aW9ucyB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGRhdGVBcnJheTogW10gYXMgc3RyaW5nW10sXG4gICAgICBzdGFydERhdGU6IERFRkFVTFRfU1RBUlRfREFURSBhcyBzdHJpbmcsXG4gICAgICBlbmREYXRlOiBERUZBVUxUX0VORF9EQVRFIGFzIHN0cmluZyxcbiAgICAgIG1pbkRhdGU6IERFRkFVTFRfTUlOX0RBVEUgYXMgc3RyaW5nLFxuICAgICAgbWF4RGF0ZTogREVGQVVMVF9NQVhfREFURSBhcyBzdHJpbmcsXG4gICAgICBzdGFydFRpbWU6IERFRkFVTFRfU1RBUlRfVElNRSBhcyBzdHJpbmcsXG4gICAgICBlbmRUaW1lOiBERUZBVUxUX0VORF9USU1FIGFzIHN0cmluZ1xuICAgIH07XG4gIH1cblxuICBnZXREZWZhdWx0U2V0dGluZ3MoKTogTmd4RGF0ZXRpbWVSYW5nZVBpY2tlclNldHRpbmdzIHtcbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogREVGQVVMVF9UWVBFIGFzIHN0cmluZyxcbiAgICAgIG1vZGVsS2V5czogREVGQVVMVF9NT0RFTF9LRVlTIGFzIHN0cmluZ1tdLFxuICAgICAgc2VsZWN0ZWRNb2RlbDogdW5kZWZpbmVkIGFzIHN0cmluZyxcbiAgICAgIHNob3dUaW1lem9uZVNlbGVjdDogZmFsc2UgYXMgYm9vbGVhbixcbiAgICAgIHVzZUxvY2FsVGltZXpvbmU6IGZhbHNlIGFzIGJvb2xlYW4sXG4gICAgICB0aW1lUGlja2VyOiBmYWxzZSBhcyBib29sZWFuLFxuICAgICAgaW5wdXRDbGFzczogREVGQVVMVF9JTlBVVF9DTEFTUyBhcyBzdHJpbmcsXG4gICAgICBpbnB1dERhdGVGb3JtYXQ6IG51bGwgYXMgc3RyaW5nLFxuICAgICAgdmlld0RhdGVGb3JtYXQ6IERFRkFVTFRfREFURV9GUk9NQVQgYXMgc3RyaW5nLFxuICAgICAgb3V0cHV0RGF0ZUZvcm1hdDogREVGQVVMVF9EQVRFX0ZST01BVCBhcyBzdHJpbmcsXG4gICAgICBzaW5nbGVEYXRlUGlja2VyOiBmYWxzZSBhcyBib29sZWFuLFxuICAgICAgY29tcG9uZW50RGlzYWJsZWQ6IGZhbHNlIGFzIGJvb2xlYW4sXG4gICAgICBwbGFjZWhvbGRlcjogXCJTZWxlY3QgRGF0ZVwiIGFzIHN0cmluZyxcbiAgICAgIHNob3dSb3dOdW1iZXI6IHRydWUgYXMgYm9vbGVhbixcbiAgICAgIGF2YWlsYWJsZVJhbmdlczoge30gYXMgT2JqZWN0LFxuICAgICAgc2hvd1JhbmdlczogdHJ1ZSBhcyBib29sZWFuLFxuICAgICAgZGlzYWJsZVdlZWtlbmRzOiBmYWxzZSBhcyBib29sZWFuLFxuICAgICAgZGlzYWJsZVdlZWtkYXlzOiBmYWxzZSBhcyBib29sZWFuLFxuICAgICAgcmV0YWlsQ2FsZW5kYXI6IGZhbHNlIGFzIGJvb2xlYW4sXG4gICAgICBkaXNwbGF5QmVnaW5EYXRlOiBmYWxzZSBhcyBib29sZWFuLFxuICAgICAgZGlzcGxheUVuZERhdGU6IGZhbHNlIGFzIGJvb2xlYW4sXG4gICAgICBhcmlhTGFiZWxzOiB0aGlzLmdldERlZmF1bHRBcmlhTGFiZWxPcHRpb25zKCkgYXMgQXJpYUxhYmVsc09wdGlvbnNcbiAgICB9O1xuICB9XG5cbiAgZm9ybWF0RGF0ZVRvRGVmYXVsdEZvcm1hdChkYXRlLCBmb3JtYXQgPSBERUZBVUxUX0RBVEVfRlJPTUFUKTogc3RyaW5nIHtcbiAgICBsZXQgZnJvbWF0dGVkRGF0ZSA9IG51bGw7XG4gICAgaWYgKGRhdGUpIHtcbiAgICAgIGlmICghaXNOYU4oTnVtYmVyKGRhdGUpKSkge1xuICAgICAgICBmcm9tYXR0ZWREYXRlID0gbW9tZW50KGRhdGUpLmZvcm1hdChERUZBVUxUX0RBVEVfRlJPTUFUKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmICghZm9ybWF0KSB7XG4gICAgICAgICAgZm9ybWF0ID0gbW9tZW50KGRhdGUpLl9mO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmIChmb3JtYXQgIT09IG1vbWVudChkYXRlKS5fZikge1xuICAgICAgICAgICAgY29uc29sZS53YXJuKFwiRVJSX05HWF9EQVRFVElNRV9SQU5HRV9QSUNLRVI6IGlucHV0RGF0ZUZvcm1hdCAhPT0gZGF0ZUZvcm1hdFwiKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFmb3JtYXQpIHtcbiAgICAgICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgICAgICBcIkVSUl9OR1hfREFURVRJTUVfUkFOR0VfUElDS0VSOiBUaGUgcHJvdmlkZWQgZGF0ZSBpcyBpbiB1bmtub3duIGZvcm1hdC4gUGFzcyB0aGUgZm9ybWF0IG9yIHBhc3MgdGhlIGRhdGUgaW4ga25vd24gZm9ybWF0XCJcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICAgIGZyb21hdHRlZERhdGUgPSBtb21lbnQoZGF0ZSwgZm9ybWF0KS5mb3JtYXQoREVGQVVMVF9EQVRFX0ZST01BVCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGZyb21hdHRlZERhdGU7XG4gIH1cblxuICBmb3JtYXRUaW1lVG9EZWZhdWx0Rm9ybWF0KHRpbWUpIHtcbiAgICBsZXQgZm9ybWF0dGVkVGltZSA9IG51bGw7XG4gICAgaWYgKHRpbWUpIHtcbiAgICAgIGlmICh0aW1lLmluZGV4T2YoXCI6XCIpID4gLTEpIHtcbiAgICAgICAgaWYgKHRpbWUuaW5kZXhPZihcIkFNXCIpID4gLTEgfHwgdGltZS5pbmRleE9mKFwiUE1cIikgPiAtMSkge1xuICAgICAgICAgIGZvcm1hdHRlZFRpbWUgPSBtb21lbnQodGltZSwgXCJoOm1tIEFcIikuZm9ybWF0KERFRkFVTFRfVElNRV9GT1JNQVQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGZvcm1hdHRlZFRpbWUgPSB0aW1lO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgICAgXCJFUlJfTkdYX0RBVEVUSU1FX1JBTkdFX1BJQ0tFUjogVGhlIHByb3ZpZGVkIHRpbWUgaXMgbm90IGluIGNvcnJlY3QgZm9ybWF0LiBGb3JtYXQ6IEhIOm1tIG9yIGhoOm1tIEFcIlxuICAgICAgICApO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZm9ybWF0dGVkVGltZTtcbiAgfVxuXG4gIGdldEZyZXF1ZW5jeUNvbHVtbkhlYWRlcih0eXBlKSB7XG4gICAgcmV0dXJuICgoKSA9PiB7XG4gICAgICBzd2l0Y2ggKHR5cGUpIHtcbiAgICAgICAgY2FzZSBcImRhaWx5XCI6XG4gICAgICAgICAgcmV0dXJuIFwiVyNcIjtcbiAgICAgICAgY2FzZSBcIndlZWtseVwiOlxuICAgICAgICAgIHJldHVybiBcIlwiO1xuICAgICAgICBjYXNlIFwibW9udGhseVwiOlxuICAgICAgICAgIHJldHVybiBcIlEjXCI7XG4gICAgICAgIGNhc2UgXCJxdWFydGVybHlcIjpcbiAgICAgICAgICByZXR1cm4gXCJZZWFyXCI7XG4gICAgICAgIGNhc2UgXCJ5ZWFybHlcIjpcbiAgICAgICAgICByZXR1cm4gXCJcIjtcbiAgICAgIH1cbiAgICB9KSgpO1xuICB9XG5cbiAgZ2V0Q2FsZW5kYXJSb3dOdW1iZXJUZXh0KHR5cGUsIG51bWJlcikge1xuICAgIHJldHVybiAoKCkgPT4ge1xuICAgICAgc3dpdGNoICh0eXBlKSB7XG4gICAgICAgIGNhc2UgXCJkYWlseVwiOlxuICAgICAgICAgIHJldHVybiBgVyR7bnVtYmVyfWA7XG4gICAgICAgIGNhc2UgXCJ3ZWVrbHlcIjpcbiAgICAgICAgICByZXR1cm4gXCJcIjtcbiAgICAgICAgY2FzZSBcIm1vbnRobHlcIjpcbiAgICAgICAgICByZXR1cm4gYFEke251bWJlcn1gO1xuICAgICAgICBjYXNlIFwicXVhcnRlcmx5XCI6XG4gICAgICAgICAgcmV0dXJuIGAke251bWJlcn1gO1xuICAgICAgICBjYXNlIFwieWVhcmx5XCI6XG4gICAgICAgICAgcmV0dXJuIFwiXCI7XG4gICAgICB9XG4gICAgfSkoKTtcbiAgfVxuXG4gIGNyZWF0ZURlZmF1bHRSYW5nZXMoY29uZmlnKTogT2JqZWN0IHtcbiAgICBjb25zdCByYW5nZXMgPSB7fTtcbiAgICBjb25zdCB0eXBlID0gY29uZmlnLnR5cGU7XG4gICAgY29uc3QgbWF4RGF0ZSA9IF8uY2xvbmVEZWVwKGNvbmZpZy5tYXhEYXRlKTtcbiAgICBjb25zdCBmb3JtYXR0ZWRNYXhEYXRlID0gdGhpcy5mb3JtYXREYXRlVG9EZWZhdWx0Rm9ybWF0KG1heERhdGUsIERFRkFVTFRfREFURV9GUk9NQVQpO1xuXG4gICAgaWYgKHR5cGUgPT09IFwiZGFpbHlcIikge1xuICAgICAgcmFuZ2VzW1wiTGFzdCA3IERheXNcIl0gPSB7XG4gICAgICAgIHN0YXJ0RGF0ZTogbW9tZW50KGZvcm1hdHRlZE1heERhdGUsIERFRkFVTFRfREFURV9GUk9NQVQpXG4gICAgICAgICAgLnN1YnRyYWN0KDYsIFwiZGF5c1wiKVxuICAgICAgICAgIC5mb3JtYXQoREVGQVVMVF9EQVRFX0ZST01BVCksXG4gICAgICAgIGVuZERhdGU6IGZvcm1hdHRlZE1heERhdGVcbiAgICAgIH07XG4gICAgICByYW5nZXNbXCJMYXN0IDMwIERheXNcIl0gPSB7XG4gICAgICAgIHN0YXJ0RGF0ZTogbW9tZW50KGZvcm1hdHRlZE1heERhdGUsIERFRkFVTFRfREFURV9GUk9NQVQpXG4gICAgICAgICAgLnN1YnRyYWN0KDI5LCBcImRheXNcIilcbiAgICAgICAgICAuZm9ybWF0KERFRkFVTFRfREFURV9GUk9NQVQpLFxuICAgICAgICBlbmREYXRlOiBmb3JtYXR0ZWRNYXhEYXRlXG4gICAgICB9O1xuICAgICAgcmFuZ2VzW1wiTGFzdCA5MCBEYXlzXCJdID0ge1xuICAgICAgICBzdGFydERhdGU6IG1vbWVudChmb3JtYXR0ZWRNYXhEYXRlLCBERUZBVUxUX0RBVEVfRlJPTUFUKVxuICAgICAgICAgIC5zdWJ0cmFjdCg4OSwgXCJkYXlzXCIpXG4gICAgICAgICAgLmZvcm1hdChERUZBVUxUX0RBVEVfRlJPTUFUKSxcbiAgICAgICAgZW5kRGF0ZTogZm9ybWF0dGVkTWF4RGF0ZVxuICAgICAgfTtcbiAgICB9IGVsc2UgaWYgKHR5cGUgPT09IFwid2Vla2x5XCIpIHtcbiAgICAgIHJhbmdlc1tcIkxhc3QgNCBXZWVrc1wiXSA9IHtcbiAgICAgICAgc3RhcnREYXRlOiBtb21lbnQoZm9ybWF0dGVkTWF4RGF0ZSwgREVGQVVMVF9EQVRFX0ZST01BVClcbiAgICAgICAgICAuc3VidHJhY3QoMywgXCJ3ZWVrc1wiKVxuICAgICAgICAgIC5mb3JtYXQoREVGQVVMVF9EQVRFX0ZST01BVCksXG4gICAgICAgIGVuZERhdGU6IGZvcm1hdHRlZE1heERhdGVcbiAgICAgIH07XG4gICAgICByYW5nZXNbXCJMYXN0IDEzIFdlZWtzXCJdID0ge1xuICAgICAgICBzdGFydERhdGU6IG1vbWVudChmb3JtYXR0ZWRNYXhEYXRlLCBERUZBVUxUX0RBVEVfRlJPTUFUKVxuICAgICAgICAgIC5zdWJ0cmFjdCgxMiwgXCJ3ZWVrc1wiKVxuICAgICAgICAgIC5mb3JtYXQoREVGQVVMVF9EQVRFX0ZST01BVCksXG4gICAgICAgIGVuZERhdGU6IGZvcm1hdHRlZE1heERhdGVcbiAgICAgIH07XG4gICAgICByYW5nZXNbXCJMYXN0IDI2IFdlZWtzXCJdID0ge1xuICAgICAgICBzdGFydERhdGU6IG1vbWVudChmb3JtYXR0ZWRNYXhEYXRlLCBERUZBVUxUX0RBVEVfRlJPTUFUKVxuICAgICAgICAgIC5zdWJ0cmFjdCgyNSwgXCJ3ZWVrc1wiKVxuICAgICAgICAgIC5mb3JtYXQoREVGQVVMVF9EQVRFX0ZST01BVCksXG4gICAgICAgIGVuZERhdGU6IGZvcm1hdHRlZE1heERhdGVcbiAgICAgIH07XG4gICAgfSBlbHNlIGlmICh0eXBlID09PSBcIm1vbnRobHlcIikge1xuICAgICAgLy8gaWYocmV0YWlsQ2FsZW5kYXIpID8gc3VidHJhY3QoMywgJ21vbnRocycpLi4uLnNvIG9uIGZvciAnTGFzdCAzIE1vbnRocycuLi4uc28gb25cbiAgICAgIHJhbmdlc1tcIkxhc3QgMyBNb250aHNcIl0gPSB7XG4gICAgICAgIHN0YXJ0RGF0ZTogbW9tZW50KGZvcm1hdHRlZE1heERhdGUsIERFRkFVTFRfREFURV9GUk9NQVQpXG4gICAgICAgICAgLnN1YnRyYWN0KDIsIFwibW9udGhzXCIpXG4gICAgICAgICAgLmZvcm1hdChERUZBVUxUX0RBVEVfRlJPTUFUKSxcbiAgICAgICAgZW5kRGF0ZTogZm9ybWF0dGVkTWF4RGF0ZVxuICAgICAgfTtcbiAgICAgIHJhbmdlc1tcIkxhc3QgNiBNb250aHNcIl0gPSB7XG4gICAgICAgIHN0YXJ0RGF0ZTogbW9tZW50KGZvcm1hdHRlZE1heERhdGUsIERFRkFVTFRfREFURV9GUk9NQVQpXG4gICAgICAgICAgLnN1YnRyYWN0KDUsIFwibW9udGhzXCIpXG4gICAgICAgICAgLmZvcm1hdChERUZBVUxUX0RBVEVfRlJPTUFUKSxcbiAgICAgICAgZW5kRGF0ZTogZm9ybWF0dGVkTWF4RGF0ZVxuICAgICAgfTtcbiAgICAgIHJhbmdlc1tcIkxhc3QgOSBNb250aHNcIl0gPSB7XG4gICAgICAgIHN0YXJ0RGF0ZTogbW9tZW50KGZvcm1hdHRlZE1heERhdGUsIERFRkFVTFRfREFURV9GUk9NQVQpXG4gICAgICAgICAgLnN1YnRyYWN0KDgsIFwibW9udGhzXCIpXG4gICAgICAgICAgLmZvcm1hdChERUZBVUxUX0RBVEVfRlJPTUFUKSxcbiAgICAgICAgZW5kRGF0ZTogZm9ybWF0dGVkTWF4RGF0ZVxuICAgICAgfTtcbiAgICB9IGVsc2UgaWYgKHR5cGUgPT09IFwicXVhcnRlcmx5XCIpIHtcbiAgICAgIC8vIGlmKHJldGFpbENhbGVuZGFyKSA/IHN1YnRyYWN0KDEsICdxdWFydGVycycpLi4uLnNvIG9uIGZvciAnTGFzdCAyIFF1YXJ0ZXJzJy4uLi5zbyBvblxuICAgICAgcmFuZ2VzW1wiTGFzdCAyIFF1YXJ0ZXJzXCJdID0ge1xuICAgICAgICBzdGFydERhdGU6IG1vbWVudChmb3JtYXR0ZWRNYXhEYXRlLCBERUZBVUxUX0RBVEVfRlJPTUFUKVxuICAgICAgICAgIC5zdWJ0cmFjdCgxLCBcInF1YXJ0ZXJzXCIpXG4gICAgICAgICAgLmZvcm1hdChERUZBVUxUX0RBVEVfRlJPTUFUKSxcbiAgICAgICAgZW5kRGF0ZTogZm9ybWF0dGVkTWF4RGF0ZVxuICAgICAgfTtcbiAgICAgIHJhbmdlc1tcIkxhc3QgNCBRdWFydGVyc1wiXSA9IHtcbiAgICAgICAgc3RhcnREYXRlOiBtb21lbnQoZm9ybWF0dGVkTWF4RGF0ZSwgREVGQVVMVF9EQVRFX0ZST01BVClcbiAgICAgICAgICAuc3VidHJhY3QoMywgXCJxdWFydGVyc1wiKVxuICAgICAgICAgIC5mb3JtYXQoREVGQVVMVF9EQVRFX0ZST01BVCksXG4gICAgICAgIGVuZERhdGU6IGZvcm1hdHRlZE1heERhdGVcbiAgICAgIH07XG4gICAgfSBlbHNlIGlmICh0eXBlID09PSBcInllYXJseVwiKSB7XG4gICAgICByYW5nZXNbXCJMYXN0IFllYXJcIl0gPSB7XG4gICAgICAgIHN0YXJ0RGF0ZTogbW9tZW50KGZvcm1hdHRlZE1heERhdGUsIERFRkFVTFRfREFURV9GUk9NQVQpXG4gICAgICAgICAgLnN1YnRyYWN0KDEsIFwieWVhclwiKVxuICAgICAgICAgIC5mb3JtYXQoREVGQVVMVF9EQVRFX0ZST01BVCksXG4gICAgICAgIGVuZERhdGU6IGZvcm1hdHRlZE1heERhdGVcbiAgICAgIH07XG4gICAgfVxuICAgIHJhbmdlc1tcIkN1c3RvbSBSYW5nZVwiXSA9IHsgc3RhcnREYXRlOiBudWxsLCBlbmREYXRlOiBudWxsIH07XG4gICAgcmV0dXJuIHJhbmdlcztcbiAgfVxuXG4gIGdldFNhbml0aXplZERhdGVBcnJheShjb25maWcpIHtcbiAgICBjb25zdCBzYW5pdGl6ZWREYXRlQXJyYXkgPSBbXTtcbiAgICBjb25zdCB0eXBlID0gY29uZmlnLnR5cGU7XG4gICAgY29uc3QgZGF0ZUFycmF5ID0gY29uZmlnLmRhdGVBcnJheTtcbiAgICBjb25zdCBpbnB1dERhdGVGb3JtYXQgPSBjb25maWcuaW5wdXREYXRlRm9ybWF0O1xuXG4gICAgLy8gZGF0ZUFycmF5IGNhbiBoYXZlIG51bGxzXG4gICAgXy5mb3JFYWNoKGRhdGVBcnJheSwgKGRhdGUpID0+IHtcbiAgICAgIGlmIChkYXRlKSB7XG4gICAgICAgIGxldCBmb3JtYXQgPSBudWxsO1xuICAgICAgICBpZiAoaXNOYU4oTnVtYmVyKGRhdGUpKSkge1xuICAgICAgICAgIGlmIChpbnB1dERhdGVGb3JtYXQpIHtcbiAgICAgICAgICAgIGZvcm1hdCA9IGlucHV0RGF0ZUZvcm1hdDtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZm9ybWF0ID0gbW9tZW50KGRhdGUpLl9mO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChpbnB1dERhdGVGb3JtYXQgIT09IG1vbWVudChkYXRlKS5fZikge1xuICAgICAgICAgIGNvbnNvbGUud2FybihcbiAgICAgICAgICAgIFwiRVJSX05HWF9EQVRFVElNRV9SQU5HRV9QSUNLRVI6IGlucHV0RGF0ZUZvcm1hdCAhPT0gZGF0ZUZvcm1hdCBpbiBkYXRlQXJyYXkuIENvbnZlcnRlZCBkYXRlcyBtaWdodCBub3QgYmUgYXMgZXhwZWN0ZWRcIlxuICAgICAgICAgICk7XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgdmFsdWUgPSBmb3JtYXQgPyBtb21lbnQoZGF0ZSwgZm9ybWF0KS5mb3JtYXQoZm9ybWF0KSA6IG1vbWVudChkYXRlKS52YWx1ZU9mKCk7XG4gICAgICAgIGlmICh0eXBlID09PSBcIndlZWtseVwiKSB7XG4gICAgICAgICAgdmFsdWUgPSBmb3JtYXRcbiAgICAgICAgICAgID8gbW9tZW50KGRhdGUsIGZvcm1hdClcbiAgICAgICAgICAgICAgICAuZW5kT2YoXCJ3ZWVrXCIpXG4gICAgICAgICAgICAgICAgLmZvcm1hdChmb3JtYXQpXG4gICAgICAgICAgICA6IG1vbWVudChkYXRlKVxuICAgICAgICAgICAgICAgIC5lbmRPZihcIndlZWtcIilcbiAgICAgICAgICAgICAgICAudmFsdWVPZigpO1xuICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT09IFwibW9udGhseVwiKSB7XG4gICAgICAgICAgdmFsdWUgPSBmb3JtYXRcbiAgICAgICAgICAgID8gbW9tZW50KGRhdGUsIGZvcm1hdClcbiAgICAgICAgICAgICAgICAuZW5kT2YoXCJtb250aFwiKVxuICAgICAgICAgICAgICAgIC5mb3JtYXQoZm9ybWF0KVxuICAgICAgICAgICAgOiBtb21lbnQoZGF0ZSlcbiAgICAgICAgICAgICAgICAuZW5kT2YoXCJtb250aFwiKVxuICAgICAgICAgICAgICAgIC52YWx1ZU9mKCk7XG4gICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gXCJxdWFydGVybHlcIikge1xuICAgICAgICAgIHZhbHVlID0gZm9ybWF0XG4gICAgICAgICAgICA/IG1vbWVudChkYXRlLCBmb3JtYXQpXG4gICAgICAgICAgICAgICAgLmVuZE9mKFwicXVhcnRlclwiKVxuICAgICAgICAgICAgICAgIC5mb3JtYXQoZm9ybWF0KVxuICAgICAgICAgICAgOiBtb21lbnQoZGF0ZSlcbiAgICAgICAgICAgICAgICAuZW5kT2YoXCJxdWFydGVyXCIpXG4gICAgICAgICAgICAgICAgLnZhbHVlT2YoKTtcbiAgICAgICAgfSBlbHNlIGlmICh0eXBlID09PSBcInllYXJseVwiKSB7XG4gICAgICAgICAgdmFsdWUgPSBmb3JtYXRcbiAgICAgICAgICAgID8gbW9tZW50KGRhdGUsIGZvcm1hdClcbiAgICAgICAgICAgICAgICAuZW5kT2YoXCJ5ZWFyXCIpXG4gICAgICAgICAgICAgICAgLmZvcm1hdChmb3JtYXQpXG4gICAgICAgICAgICA6IG1vbWVudChkYXRlKVxuICAgICAgICAgICAgICAgIC5lbmRPZihcInllYXJcIilcbiAgICAgICAgICAgICAgICAudmFsdWVPZigpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh2YWx1ZSkge1xuICAgICAgICAgIHNhbml0aXplZERhdGVBcnJheS5wdXNoKHZhbHVlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgICAgICBgRVJSX05HWF9EQVRFVElNRV9SQU5HRV9QSUNLRVI6IGRhdGVBcnJheSB2YWx1ZXMgYXJlIGluIHVua25vd24gZm9ybWF0LiBQYXNzIHRoZSBmb3JtYXQgb3IgcGFzcyB0aGUgZGF0ZXMgaW4ga25vd24gZm9ybWF0YFxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHJldHVybiBfLnVuaXFCeShzYW5pdGl6ZWREYXRlQXJyYXkpO1xuICB9XG5cbiAgZ2V0TnVtYmVyT2ZXZWVrcyhkYXRlKTogbnVtYmVyIHtcbiAgICBsZXQgbnVtYmVyT2ZXZWVrcyA9IG51bGw7XG4gICAgaWYgKGRhdGUpIHtcbiAgICAgIGNvbnN0IG1vbnRoU3RhcnQ6IG51bWJlciA9IG1vbWVudChkYXRlLCBERUZBVUxUX0RBVEVfRlJPTUFUKVxuICAgICAgICAuc3RhcnRPZihcIm1vbnRoXCIpXG4gICAgICAgIC5kYXkoKTtcbiAgICAgIGNvbnN0IG1vbnRoRW5kOiBudW1iZXIgPSBOdW1iZXIoXG4gICAgICAgIG1vbWVudChkYXRlLCBERUZBVUxUX0RBVEVfRlJPTUFUKVxuICAgICAgICAgIC5lbmRPZihcIm1vbnRoXCIpXG4gICAgICAgICAgLmZvcm1hdChcIkRcIilcbiAgICAgICk7XG4gICAgICBudW1iZXJPZldlZWtzID0gTWF0aC5jZWlsKChtb250aFN0YXJ0ICsgbW9udGhFbmQpIC8gNyk7XG4gICAgfVxuICAgIHJldHVybiBudW1iZXJPZldlZWtzO1xuICB9XG5cbiAgZ2V0WWVhcmx5V2Vla0NvdW50KHllYXIsIHJldGFpbENhbGVuZGFyPykge1xuICAgIGxldCB3ZWVrQ291bnQ6IG51bWJlciA9IG51bGw7XG4gICAgaWYgKHllYXIpIHtcbiAgICAgIGNvbnN0IHllYXJTdGFydERhdGUgPSBtb21lbnQoeWVhciwgXCJZWVlZXCIpXG4gICAgICAgIC5zdGFydE9mKFwieWVhclwiKVxuICAgICAgICAuZm9ybWF0KERFRkFVTFRfREFURV9GUk9NQVQpO1xuICAgICAgY29uc3QgeWVhckVuZERhdGUgPSBtb21lbnQoeWVhciwgXCJZWVlZXCIpXG4gICAgICAgIC5lbmRPZihcInllYXJcIilcbiAgICAgICAgLmZvcm1hdChERUZBVUxUX0RBVEVfRlJPTUFUKTtcbiAgICAgIGNvbnN0IHllYXJFbmRXZWVrRW5kRGF0ZSA9IG1vbWVudCh5ZWFyRW5kRGF0ZSwgREVGQVVMVF9EQVRFX0ZST01BVClcbiAgICAgICAgLnN0YXJ0T2YoXCJ3ZWVrXCIpXG4gICAgICAgIC5mb3JtYXQoREVGQVVMVF9EQVRFX0ZST01BVCk7XG5cbiAgICAgIGNvbnN0IHllYXJTdGFydFdlZWtFbmREYXRlID0gbW9tZW50KHllYXJTdGFydERhdGUsIERFRkFVTFRfREFURV9GUk9NQVQpXG4gICAgICAgIC5lbmRPZihcIndlZWtcIilcbiAgICAgICAgLmZvcm1hdChERUZBVUxUX0RBVEVfRlJPTUFUKTtcblxuICAgICAgY29uc3QgeWVhclNhcnRXZWVrTnVtYmVyID0gdGhpcy5nZXRXZWVrTnVtYmVyKHllYXJTdGFydFdlZWtFbmREYXRlKTtcbiAgICAgIGNvbnN0IHllYXJFbmRXZWVrTnVtYmVyID0gdGhpcy5nZXRXZWVrTnVtYmVyKHllYXJFbmRXZWVrRW5kRGF0ZSk7XG4gICAgICB3ZWVrQ291bnQgPSB5ZWFyRW5kV2Vla051bWJlciAtIHllYXJTYXJ0V2Vla051bWJlciArIDE7XG4gICAgfVxuICAgIHJldHVybiB3ZWVrQ291bnQ7XG4gIH1cblxuICBnZXRNb250aHNBdmFpbGFibGUobWluRGF0ZSwgbWF4RGF0ZSwgc2VsZWN0ZWRZZWFyKSB7XG4gICAgY29uc3QgbW9udGhzID0gW107XG4gICAgaWYgKG1pbkRhdGUgJiYgbWF4RGF0ZSAmJiBzZWxlY3RlZFllYXIpIHtcbiAgICAgIGxldCBtaW5EYXRlbXMgPSBtb21lbnQobWluRGF0ZSwgREVGQVVMVF9EQVRFX0ZST01BVCkudmFsdWVPZigpO1xuICAgICAgbGV0IG1heERhdGVtcyA9IG1vbWVudChtYXhEYXRlLCBERUZBVUxUX0RBVEVfRlJPTUFUKS52YWx1ZU9mKCk7XG4gICAgICBjb25zdCB5ZWFyU3RhcnRtcyA9IG1vbWVudCgpXG4gICAgICAgIC55ZWFyKHNlbGVjdGVkWWVhcilcbiAgICAgICAgLnN0YXJ0T2YoXCJ5ZWFyXCIpXG4gICAgICAgIC52YWx1ZU9mKCk7XG4gICAgICBjb25zdCB5ZWFyRW5kbXMgPSBtb21lbnQoKVxuICAgICAgICAueWVhcihzZWxlY3RlZFllYXIpXG4gICAgICAgIC5lbmRPZihcInllYXJcIilcbiAgICAgICAgLnZhbHVlT2YoKTtcblxuICAgICAgaWYgKG1pbkRhdGVtcyA8IHllYXJTdGFydG1zKSB7XG4gICAgICAgIG1pbkRhdGVtcyA9IHllYXJTdGFydG1zO1xuICAgICAgfVxuICAgICAgaWYgKG1heERhdGVtcyA+IHllYXJFbmRtcykge1xuICAgICAgICBtYXhEYXRlbXMgPSB5ZWFyRW5kbXM7XG4gICAgICB9XG5cbiAgICAgIGxldCBtaW5EYXRlTW9udGhOdW1iZXIgPSBtb21lbnQobWluRGF0ZW1zKS5tb250aCgpO1xuICAgICAgY29uc3QgZGlmZjogbnVtYmVyID0gbW9tZW50KG1heERhdGVtcykuZGlmZihtb21lbnQobWluRGF0ZW1zKSwgXCJtb250aHNcIik7XG4gICAgICBjb25zdCBtYXhNb250aHMgPSBkaWZmIDwgTU9OVEhTX0FWQUlMQUJMRS5sZW5ndGggPyBkaWZmIDogTU9OVEhTX0FWQUlMQUJMRS5sZW5ndGg7XG5cbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDw9IG1heE1vbnRoczsgaSsrKSB7XG4gICAgICAgIGlmIChtaW5EYXRlTW9udGhOdW1iZXIgPj0gTU9OVEhTX0FWQUlMQUJMRS5sZW5ndGgpIHtcbiAgICAgICAgICBtb250aHMucHVzaChNT05USFNfQVZBSUxBQkxFW21pbkRhdGVNb250aE51bWJlciAtIE1PTlRIU19BVkFJTEFCTEUubGVuZ3RoXSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbW9udGhzLnB1c2goTU9OVEhTX0FWQUlMQUJMRVttaW5EYXRlTW9udGhOdW1iZXJdKTtcbiAgICAgICAgfVxuICAgICAgICBtaW5EYXRlTW9udGhOdW1iZXIrKztcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG1vbnRocztcbiAgfVxuXG4gIGdldFllYXJzQXZhaWxhYmxlKGNvbmZpZykge1xuICAgIGNvbnN0IG1pbkRhdGUgPSBjb25maWcgPyBjb25maWcubWluRGF0ZSA6IFwiXCI7XG4gICAgY29uc3QgbWF4RGF0ZSA9IGNvbmZpZyA/IGNvbmZpZy5tYXhEYXRlIDogXCJcIjtcbiAgICBjb25zdCB5ZWFycyA9IFtdO1xuICAgIGlmIChtaW5EYXRlICYmIG1heERhdGUpIHtcbiAgICAgIGNvbnN0IG1pblllYXIgPSBOdW1iZXIodGhpcy5nZXRTZWxlY3RlZFllYXIoY29uZmlnLCBtaW5EYXRlLCBcImxlZnRcIikpO1xuICAgICAgY29uc3QgbWF4WWVhciA9IE51bWJlcih0aGlzLmdldFNlbGVjdGVkWWVhcihjb25maWcsIG1heERhdGUsIFwicmlnaHRcIikpO1xuICAgICAgY29uc3QgZGlmZiA9IG1heFllYXIgLSBtaW5ZZWFyO1xuXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8PSBkaWZmOyBpKyspIHtcbiAgICAgICAgeWVhcnMucHVzaChgJHttaW5ZZWFyICsgaX1gKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHllYXJzLnJldmVyc2UoKTtcbiAgfVxuXG4gIGlzRGF0ZUF2YWlsYWJsZShkYXRlLCBtaW5EYXRlLCBtYXhEYXRlLCBzdGFydERhdGUsIGVuZERhdGUsIG1vbnRoU3RhcnREYXRlLCBtb250aEVuZERhdGUsIGNvbmZpZyk6IGJvb2xlYW4ge1xuICAgIGxldCBhdmFpbGFibGUgPSBmYWxzZTtcbiAgICBjb25zdCB0eXBlID0gY29uZmlnLnR5cGU7XG4gICAgY29uc3QgZGF0ZUFycmF5ID0gY29uZmlnLmRhdGVBcnJheSA/IGNvbmZpZy5kYXRlQXJyYXkgOiBbXTtcbiAgICBjb25zdCBpbnB1dERhdGVGb3JtYXQgPSBjb25maWcuaW5wdXREYXRlRm9ybWF0O1xuICAgIGNvbnN0IGRpc2FibGVXZWVrZW5kcyA9IGNvbmZpZy5kaXNhYmxlV2Vla2VuZHM7XG4gICAgY29uc3QgZGlzYWJsZVdlZWtkYXlzID0gY29uZmlnLmRpc2FibGVXZWVrZGF5cztcbiAgICBpZiAodHlwZSA9PT0gXCJkYWlseVwiKSB7XG4gICAgICBtaW5EYXRlID0gbWluRGF0ZSA+IG1vbnRoU3RhcnREYXRlID8gbWluRGF0ZSA6IG1vbnRoU3RhcnREYXRlO1xuICAgICAgbWF4RGF0ZSA9IG1heERhdGUgPCBtb250aEVuZERhdGUgPyBtYXhEYXRlIDogbW9udGhFbmREYXRlO1xuICAgIH1cblxuICAgIC8vIGlmKGRhdGUgPT09IG1pbkRhdGVcbiAgICAvLyAgICAgfHwgZGF0ZSA9PT0gbWF4RGF0ZSkge1xuICAgIC8vICAgYXZhaWxhYmxlID0gdHJ1ZTtcbiAgICAvLyB9XG5cbiAgICBpZiAoZGF0ZSA+PSBtaW5EYXRlICYmIGRhdGUgPD0gbWF4RGF0ZSkge1xuICAgICAgaWYgKGRhdGVBcnJheS5sZW5ndGggPiAwKSB7XG4gICAgICAgIGF2YWlsYWJsZSA9IF8uc29tZShkYXRlQXJyYXksIChkKSA9PiB7XG4gICAgICAgICAgbGV0IGZvcm1hdCA9IG51bGw7XG4gICAgICAgICAgaWYgKGlzTmFOKE51bWJlcihkYXRlKSkpIHtcbiAgICAgICAgICAgIGlmIChpbnB1dERhdGVGb3JtYXQpIHtcbiAgICAgICAgICAgICAgZm9ybWF0ID0gaW5wdXREYXRlRm9ybWF0O1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgZm9ybWF0ID0gbW9tZW50KGRhdGUpLl9mO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gbW9tZW50KGQsIGZvcm1hdCkudmFsdWVPZigpID09PSBkYXRlO1xuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGF2YWlsYWJsZSA9IHRydWU7XG4gICAgICB9XG5cbiAgICAgIGlmIChhdmFpbGFibGUpIHtcbiAgICAgICAgaWYgKGRpc2FibGVXZWVrZW5kcykge1xuICAgICAgICAgIGF2YWlsYWJsZSA9ICF0aGlzLmlzV2Vla2VuZChkYXRlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZGlzYWJsZVdlZWtkYXlzKSB7XG4gICAgICAgICAgYXZhaWxhYmxlID0gIXRoaXMuaXNXZWVrZGF5KGRhdGUpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBhdmFpbGFibGU7XG4gIH1cblxuICBpc0RhdGVJblJhbmdlKGRhdGUsIG1pbkRhdGUsIG1heERhdGUsIHN0YXJ0RGF0ZSwgZW5kRGF0ZSwgbW9udGhTdGFydERhdGUsIG1vbnRoRW5kRGF0ZSwgYXZhaWxhYmxlLCBjb25maWcpOiBib29sZWFuIHtcbiAgICBsZXQgaW5SYW5nZSA9IGZhbHNlO1xuICAgIGNvbnN0IHR5cGUgPSBjb25maWcudHlwZTtcbiAgICBjb25zdCBzaW5nbGVEYXRlUGlja2VyID0gY29uZmlnLnNpbmdsZURhdGVQaWNrZXI7XG4gICAgaWYgKCFzaW5nbGVEYXRlUGlja2VyKSB7XG4gICAgICBpZiAodHlwZSA9PT0gXCJkYWlseVwiKSB7XG4gICAgICAgIG1pbkRhdGUgPSBtb250aFN0YXJ0RGF0ZTtcbiAgICAgICAgbWF4RGF0ZSA9IG1vbnRoRW5kRGF0ZTtcbiAgICAgIH1cbiAgICAgIGlmIChkYXRlID49IHN0YXJ0RGF0ZSAmJiBkYXRlIDw9IGVuZERhdGUgJiYgZGF0ZSA+PSBtaW5EYXRlICYmIGRhdGUgPD0gbWF4RGF0ZSkge1xuICAgICAgICBpZiAoYXZhaWxhYmxlKSB7XG4gICAgICAgICAgaW5SYW5nZSA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGluUmFuZ2U7XG4gIH1cblxuICBpc0RhdGVBY3RpdmUoZGF0ZSwgc3RhcnREYXRlLCBlbmREYXRlLCBzaWRlKTogYm9vbGVhbiB7XG4gICAgbGV0IGFjdGl2ZSA9IGZhbHNlO1xuICAgIGlmICgoZGF0ZSA9PT0gc3RhcnREYXRlICYmIHNpZGUgPT09IFwibGVmdFwiKSB8fCAoZGF0ZSA9PT0gZW5kRGF0ZSAmJiBzaWRlID09PSBcInJpZ2h0XCIpKSB7XG4gICAgICBhY3RpdmUgPSB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gYWN0aXZlO1xuICB9XG5cbiAgaXNEYXRlVG9kYXkoZGF0ZSwgY29uZmlnKTogYm9vbGVhbiB7XG4gICAgbGV0IHRvZGF5ID0gZmFsc2U7XG4gICAgY29uc3QgdG9kYXlEYXRlID0gbW9tZW50KClcbiAgICAgIC5zdGFydE9mKFwiZGF5XCIpXG4gICAgICAudmFsdWVPZigpO1xuICAgIGNvbnN0IHR5cGUgPSBjb25maWcudHlwZTtcbiAgICBjb25zdCBmaXJzdExhc3REYXkgPSB0aGlzLmdldEZpcnN0TGFzdERheShtb21lbnQodG9kYXlEYXRlKS5mb3JtYXQoREVGQVVMVF9EQVRFX0ZST01BVCksIHR5cGUpO1xuICAgIGNvbnN0IGZpcnN0RGF5ID0gbW9tZW50KGZpcnN0TGFzdERheS5maXJzdERheSwgREVGQVVMVF9EQVRFX0ZST01BVCkudmFsdWVPZigpO1xuICAgIGNvbnN0IGxhc3REYXkgPSBtb21lbnQoZmlyc3RMYXN0RGF5Lmxhc3REYXksIERFRkFVTFRfREFURV9GUk9NQVQpLnZhbHVlT2YoKTtcbiAgICBpZiAoZGF0ZSA+PSBmaXJzdERheSAmJiBkYXRlIDw9IGxhc3REYXkpIHtcbiAgICAgIHRvZGF5ID0gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIHRvZGF5O1xuICB9XG5cbiAgaXNXZWVrZGF5KGRhdGUsIGZvcm1hdD8pIHtcbiAgICByZXR1cm4gIXRoaXMuaXNXZWVrZW5kKGRhdGUsIGZvcm1hdCk7XG4gIH1cblxuICBpc1dlZWtlbmQoZGF0ZSwgZm9ybWF0Pykge1xuICAgIGlmICghZm9ybWF0KSB7XG4gICAgICBmb3JtYXQgPSBudWxsO1xuICAgIH1cbiAgICBjb25zdCBkYXkgPSBtb21lbnQoZGF0ZSwgZm9ybWF0KS5kYXkoKTtcbiAgICByZXR1cm4gZGF5ID09PSAwIHx8IGRheSA9PT0gNiA/IHRydWUgOiBmYWxzZTtcbiAgfVxuXG4gIGdldENhbGVuZGFyUm93VmFyaWFibGVzKG9wdGlvbnMpIHtcbiAgICBjb25zdCB2YXJpYWJsZXM6IGFueSA9IHt9O1xuICAgIGNvbnN0IHR5cGUgPSBvcHRpb25zLnR5cGU7XG4gICAgY29uc3QgbW9udGhTdGFydFdlZWtOdW1iZXIgPSBvcHRpb25zLm1vbnRoU3RhcnRXZWVrTnVtYmVyO1xuICAgIGNvbnN0IGRhdGVSb3dzID0gb3B0aW9ucy5kYXRlUm93cztcbiAgICBjb25zdCB5ZWFyID0gYCR7b3B0aW9ucy55ZWFyfWA7XG5cbiAgICBpZiAodHlwZSA9PT0gXCJkYWlseVwiKSB7XG4gICAgICB2YXJpYWJsZXMucm93TnVtYmVyID0gbW9udGhTdGFydFdlZWtOdW1iZXIgKyBkYXRlUm93cztcbiAgICAgIHZhcmlhYmxlcy5jb2x1bW5zID0gNjtcbiAgICB9IGVsc2UgaWYgKHR5cGUgPT09IFwid2Vla2x5XCIpIHtcbiAgICAgIC8vIHZhcmlhYmxlcy5yb3dOdW1iZXIgPSBgJHsoZGF0ZVJvd3MqMikrMX0gLSAkeyhkYXRlUm93cyoyKSsyfWA7XG4gICAgICB2YXJpYWJsZXMucm93TnVtYmVyID0gYGA7XG4gICAgICB2YXJpYWJsZXMuY29sdW1ucyA9IDY7XG4gICAgfSBlbHNlIGlmICh0eXBlID09PSBcIm1vbnRobHlcIikge1xuICAgICAgdmFyaWFibGVzLnJvd051bWJlciA9IGRhdGVSb3dzICsgMTtcbiAgICAgIHZhcmlhYmxlcy5jb2x1bW5zID0gMjtcbiAgICB9IGVsc2UgaWYgKHR5cGUgPT09IFwicXVhcnRlcmx5XCIpIHtcbiAgICAgIHZhcmlhYmxlcy5yb3dOdW1iZXIgPSB5ZWFyLmNoYXJBdChkYXRlUm93cyk7XG4gICAgICB2YXJpYWJsZXMuY29sdW1ucyA9IDA7XG4gICAgfSBlbHNlIGlmICh0eXBlID09PSBcInllYXJseVwiKSB7XG4gICAgICB2YXJpYWJsZXMucm93TnVtYmVyID0gXCJcIjtcbiAgICAgIHZhcmlhYmxlcy5jb2x1bW5zID0gMDtcbiAgICB9XG5cbiAgICByZXR1cm4gdmFyaWFibGVzO1xuICB9XG5cbiAgZ2V0Q2FsZW5kYXJSb3dJdGVtVmFyaWFibGVzKG9wdGlvbnMpIHtcbiAgICBjb25zdCB2YXJpYWJsZXM6IGFueSA9IHtcbiAgICAgIGN1cnJlbnRJdGVtRGF0ZTogXCJcIixcbiAgICAgIHJvd0l0ZW1UZXh0OiBcIlwiLFxuICAgICAgaXRlbUNvdW50OiBudWxsXG4gICAgfTtcbiAgICBjb25zdCB0eXBlID0gb3B0aW9ucy50eXBlO1xuICAgIGNvbnN0IG1vbnRoU3RhcnRXZWVrTnVtYmVyID0gb3B0aW9ucy5tb250aFN0YXJ0V2Vla051bWJlcjtcbiAgICBjb25zdCB5ZWFyU3RhcnREYXRlID0gb3B0aW9ucy55ZWFyU3RhcnREYXRlO1xuICAgIGNvbnN0IHllYXIgPSBvcHRpb25zLnllYXI7XG4gICAgY29uc3Qgcm93SXRlbSA9IG9wdGlvbnMucm93SXRlbTtcbiAgICBjb25zdCBkYXRlUm93cyA9IG9wdGlvbnMuZGF0ZVJvd3M7XG4gICAgY29uc3QgY29sdW1ucyA9IG9wdGlvbnMuY29sdW1ucztcbiAgICBjb25zdCBpdGVtQ291bnQgPSByb3dJdGVtICsgZGF0ZVJvd3MgKiBjb2x1bW5zICsgZGF0ZVJvd3M7XG4gICAgbGV0IGN1cnJlbnRJdGVtRGF0ZSA9IFwiXCI7XG4gICAgbGV0IHJvd0l0ZW1UZXh0ID0gXCJcIjtcbiAgICBsZXQgZmlyc3RMYXN0RGF5T2JqZWN0OiBhbnkgPSB7fTtcblxuICAgIGlmICh0eXBlID09PSBcImRhaWx5XCIpIHtcbiAgICAgIGlmICghXy5pc05pbChtb250aFN0YXJ0V2Vla051bWJlcikgJiYgIV8uaXNOaWwoZGF0ZVJvd3MpICYmICFfLmlzTmlsKHllYXIpKSB7XG4gICAgICAgIGNvbnN0IHllYXJTdGFydERhdGVEYWlseSA9IG1vbWVudCgpXG4gICAgICAgICAgLnllYXIoeWVhcilcbiAgICAgICAgICAuc3RhcnRPZihcInllYXJcIilcbiAgICAgICAgICAuZm9ybWF0KERFRkFVTFRfREFURV9GUk9NQVQpO1xuICAgICAgICBjdXJyZW50SXRlbURhdGUgPSBtb21lbnQoeWVhclN0YXJ0RGF0ZURhaWx5LCBERUZBVUxUX0RBVEVfRlJPTUFUKVxuICAgICAgICAgIC5hZGQobW9udGhTdGFydFdlZWtOdW1iZXIgKyBkYXRlUm93cyAtIDEsIFwid2Vla1wiKVxuICAgICAgICAgIC5zdGFydE9mKFwid2Vla1wiKVxuICAgICAgICAgIC5hZGQocm93SXRlbSwgXCJkYXlcIilcbiAgICAgICAgICAuZm9ybWF0KERFRkFVTFRfREFURV9GUk9NQVQpO1xuICAgICAgICByb3dJdGVtVGV4dCA9IG1vbWVudChjdXJyZW50SXRlbURhdGUsIERFRkFVTFRfREFURV9GUk9NQVQpLmZvcm1hdChcIkRcIik7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmICh0eXBlID09PSBcIndlZWtseVwiKSB7XG4gICAgICBpZiAoIV8uaXNOaWwoeWVhclN0YXJ0RGF0ZSkgJiYgIV8uaXNOaWwoaXRlbUNvdW50KSkge1xuICAgICAgICBjdXJyZW50SXRlbURhdGUgPSBtb21lbnQoeWVhclN0YXJ0RGF0ZSwgREVGQVVMVF9EQVRFX0ZST01BVClcbiAgICAgICAgICAuYWRkKGl0ZW1Db3VudCwgXCJ3ZWVrXCIpXG4gICAgICAgICAgLmVuZE9mKFwid2Vla1wiKVxuICAgICAgICAgIC5mb3JtYXQoREVGQVVMVF9EQVRFX0ZST01BVCk7XG4gICAgICAgIGNvbnN0IHdlZWtOdW1iZXI6IGFueSA9IGl0ZW1Db3VudCArIDE7XG4gICAgICAgIHJvd0l0ZW1UZXh0ID0gYFcke3dlZWtOdW1iZXJ9YDtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKHR5cGUgPT09IFwibW9udGhseVwiKSB7XG4gICAgICBpZiAoIV8uaXNOaWwoaXRlbUNvdW50KSAmJiAhXy5pc05pbCh5ZWFyKSkge1xuICAgICAgICBjdXJyZW50SXRlbURhdGUgPSBtb21lbnQoKVxuICAgICAgICAgIC55ZWFyKHllYXIpXG4gICAgICAgICAgLm1vbnRoKGl0ZW1Db3VudClcbiAgICAgICAgICAuZW5kT2YoXCJtb250aFwiKVxuICAgICAgICAgIC5mb3JtYXQoREVGQVVMVF9EQVRFX0ZST01BVCk7XG4gICAgICAgIHJvd0l0ZW1UZXh0ID0gbW9tZW50KGN1cnJlbnRJdGVtRGF0ZSwgREVGQVVMVF9EQVRFX0ZST01BVCkuZm9ybWF0KFwiTU1NXCIpO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gXCJxdWFydGVybHlcIikge1xuICAgICAgaWYgKCFfLmlzTmlsKGl0ZW1Db3VudCkgJiYgIV8uaXNOaWwoeWVhcikpIHtcbiAgICAgICAgY3VycmVudEl0ZW1EYXRlID0gbW9tZW50KClcbiAgICAgICAgICAueWVhcih5ZWFyKVxuICAgICAgICAgIC5xdWFydGVyKGl0ZW1Db3VudCArIDEpXG4gICAgICAgICAgLmVuZE9mKFwicXVhcnRlclwiKVxuICAgICAgICAgIC5mb3JtYXQoREVGQVVMVF9EQVRFX0ZST01BVCk7XG4gICAgICAgIHJvd0l0ZW1UZXh0ID0gYFF1YXJ0ZXIgJHtpdGVtQ291bnQgKyAxfWA7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZmlyc3RMYXN0RGF5T2JqZWN0ID0gdGhpcy5nZXRGaXJzdExhc3REYXkoY3VycmVudEl0ZW1EYXRlLCB0eXBlKTtcblxuICAgIHZhcmlhYmxlcy5pdGVtQ291bnQgPSBpdGVtQ291bnQ7XG4gICAgdmFyaWFibGVzLmN1cnJlbnRJdGVtRGF0ZSA9IGN1cnJlbnRJdGVtRGF0ZTtcbiAgICB2YXJpYWJsZXMucm93SXRlbVRleHQgPSByb3dJdGVtVGV4dDtcbiAgICB2YXJpYWJsZXMuZmlyc3REYXkgPSBmaXJzdExhc3REYXlPYmplY3QuZmlyc3REYXk7XG4gICAgdmFyaWFibGVzLmxhc3REYXkgPSBmaXJzdExhc3REYXlPYmplY3QubGFzdERheTtcbiAgICByZXR1cm4gdmFyaWFibGVzO1xuICB9XG5cbiAgaXNSb3dJZW1WYWxpZChvcHRpb25zKTogYm9vbGVhbiB7XG4gICAgbGV0IHZhbGlkID0gZmFsc2U7XG4gICAgY29uc3QgdHlwZSA9IG9wdGlvbnMudHlwZTtcbiAgICBjb25zdCB5ZWFyID0gb3B0aW9ucy55ZWFyO1xuICAgIGNvbnN0IGl0ZW1Db3VudCA9IG9wdGlvbnMuaXRlbUNvdW50O1xuICAgIGNvbnN0IHJldGFpbENhbGVuZGFyID0gb3B0aW9ucy5yZXRhaWxDYWxlbmRhcjtcbiAgICBjb25zdCB2YWxpZFdlZWtDb3VudCA9IHRoaXMuZ2V0WWVhcmx5V2Vla0NvdW50KHllYXIsIHJldGFpbENhbGVuZGFyKTtcblxuICAgIGlmICh0eXBlID09PSBcImRhaWx5XCIpIHtcbiAgICAgIHZhbGlkID0gdHJ1ZTtcbiAgICB9IGVsc2UgaWYgKHR5cGUgPT09IFwid2Vla2x5XCIpIHtcbiAgICAgIGlmIChpdGVtQ291bnQgPCB2YWxpZFdlZWtDb3VudCkge1xuICAgICAgICB2YWxpZCA9IHRydWU7XG4gICAgICB9XG4gICAgfSBlbHNlIGlmICh0eXBlID09PSBcIm1vbnRobHlcIikge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBlbHNlIGlmICh0eXBlID09PSBcInF1YXJ0ZXJseVwiKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICByZXR1cm4gdmFsaWQ7XG4gIH1cblxuICBmb3JtYXRTdGFydERhdGUoY29uZmlnLCByZXR1cm5Gb3JtYXQpIHtcbiAgICBjb25zdCBzdGFydERhdGUgPSBjb25maWcgPyBjb25maWcuc3RhcnREYXRlIDogbnVsbDtcbiAgICBjb25zdCB0eXBlID0gY29uZmlnID8gY29uZmlnLnR5cGUgOiBcIlwiO1xuICAgIGxldCBmb3JtYXR0ZWRTdGFydERhdGUgPSBudWxsO1xuXG4gICAgaWYgKHN0YXJ0RGF0ZSkge1xuICAgICAgZm9ybWF0dGVkU3RhcnREYXRlID0gbW9tZW50KHN0YXJ0RGF0ZSwgREVGQVVMVF9EQVRFX0ZST01BVCkuZm9ybWF0KHJldHVybkZvcm1hdCk7XG4gICAgICBpZiAodHlwZSA9PT0gXCJ3ZWVrbHlcIikge1xuICAgICAgICBmb3JtYXR0ZWRTdGFydERhdGUgPSBtb21lbnQoc3RhcnREYXRlLCBERUZBVUxUX0RBVEVfRlJPTUFUKVxuICAgICAgICAgIC5zdGFydE9mKFwid2Vla1wiKVxuICAgICAgICAgIC5mb3JtYXQocmV0dXJuRm9ybWF0KTtcbiAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gXCJtb250aGx5XCIpIHtcbiAgICAgICAgZm9ybWF0dGVkU3RhcnREYXRlID0gbW9tZW50KHN0YXJ0RGF0ZSwgREVGQVVMVF9EQVRFX0ZST01BVClcbiAgICAgICAgICAuc3RhcnRPZihcIm1vbnRoXCIpXG4gICAgICAgICAgLmZvcm1hdChyZXR1cm5Gb3JtYXQpO1xuICAgICAgfSBlbHNlIGlmICh0eXBlID09PSBcInF1YXJ0ZXJseVwiKSB7XG4gICAgICAgIGZvcm1hdHRlZFN0YXJ0RGF0ZSA9IG1vbWVudChzdGFydERhdGUsIERFRkFVTFRfREFURV9GUk9NQVQpXG4gICAgICAgICAgLnN0YXJ0T2YoXCJxdWFydGVyXCIpXG4gICAgICAgICAgLmZvcm1hdChyZXR1cm5Gb3JtYXQpO1xuICAgICAgfSBlbHNlIGlmICh0eXBlID09PSBcInllYXJseVwiKSB7XG4gICAgICAgIGZvcm1hdHRlZFN0YXJ0RGF0ZSA9IG1vbWVudChzdGFydERhdGUsIERFRkFVTFRfREFURV9GUk9NQVQpXG4gICAgICAgICAgLnN0YXJ0T2YoXCJ5ZWFyXCIpXG4gICAgICAgICAgLmZvcm1hdChyZXR1cm5Gb3JtYXQpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBmb3JtYXR0ZWRTdGFydERhdGU7XG4gIH1cblxuICBnZXRTZWxlY3RlZFllYXIoY29uZmlnLCBkYXRlLCBzaWRlKTogc3RyaW5nIHtcbiAgICByZXR1cm4gbW9tZW50KGRhdGUsIERFRkFVTFRfREFURV9GUk9NQVQpLmZvcm1hdChcIllZWVlcIik7XG4gIH1cblxuICBnZXRGaXJzdExhc3REYXkoZGF0ZSwgdHlwZSkge1xuICAgIGxldCBmaXJzdERheSA9IFwiXCI7XG4gICAgbGV0IGxhc3REYXkgPSBcIlwiO1xuXG4gICAgaWYgKHR5cGUgPT09IFwiZGFpbHlcIikge1xuICAgICAgZmlyc3REYXkgPSBsYXN0RGF5ID0gZGF0ZTtcbiAgICB9IGVsc2UgaWYgKHR5cGUgPT09IFwid2Vla2x5XCIpIHtcbiAgICAgIGZpcnN0RGF5ID0gbW9tZW50KGRhdGUsIERFRkFVTFRfREFURV9GUk9NQVQpXG4gICAgICAgIC5zdGFydE9mKFwid2Vla1wiKVxuICAgICAgICAuZm9ybWF0KERFRkFVTFRfREFURV9GUk9NQVQpO1xuICAgICAgbGFzdERheSA9IG1vbWVudChkYXRlLCBERUZBVUxUX0RBVEVfRlJPTUFUKVxuICAgICAgICAuZW5kT2YoXCJ3ZWVrXCIpXG4gICAgICAgIC5mb3JtYXQoREVGQVVMVF9EQVRFX0ZST01BVCk7XG4gICAgfSBlbHNlIGlmICh0eXBlID09PSBcIm1vbnRobHlcIikge1xuICAgICAgZmlyc3REYXkgPSBtb21lbnQoZGF0ZSwgREVGQVVMVF9EQVRFX0ZST01BVClcbiAgICAgICAgLnN0YXJ0T2YoXCJtb250aFwiKVxuICAgICAgICAuZm9ybWF0KERFRkFVTFRfREFURV9GUk9NQVQpO1xuICAgICAgbGFzdERheSA9IG1vbWVudChkYXRlLCBERUZBVUxUX0RBVEVfRlJPTUFUKVxuICAgICAgICAuZW5kT2YoXCJtb250aFwiKVxuICAgICAgICAuZm9ybWF0KERFRkFVTFRfREFURV9GUk9NQVQpO1xuICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gXCJxdWFydGVybHlcIikge1xuICAgICAgZmlyc3REYXkgPSBtb21lbnQoZGF0ZSwgREVGQVVMVF9EQVRFX0ZST01BVClcbiAgICAgICAgLnN0YXJ0T2YoXCJxdWFydGVyXCIpXG4gICAgICAgIC5mb3JtYXQoREVGQVVMVF9EQVRFX0ZST01BVCk7XG4gICAgICBsYXN0RGF5ID0gbW9tZW50KGRhdGUsIERFRkFVTFRfREFURV9GUk9NQVQpXG4gICAgICAgIC5lbmRPZihcInF1YXJ0ZXJcIilcbiAgICAgICAgLmZvcm1hdChERUZBVUxUX0RBVEVfRlJPTUFUKTtcbiAgICB9IGVsc2UgaWYgKHR5cGUgPT09IFwieWVhcmx5XCIpIHtcbiAgICAgIGZpcnN0RGF5ID0gbW9tZW50KGRhdGUsIERFRkFVTFRfREFURV9GUk9NQVQpXG4gICAgICAgIC5zdGFydE9mKFwieWVhclwiKVxuICAgICAgICAuZm9ybWF0KERFRkFVTFRfREFURV9GUk9NQVQpO1xuICAgICAgbGFzdERheSA9IG1vbWVudChkYXRlLCBERUZBVUxUX0RBVEVfRlJPTUFUKVxuICAgICAgICAuZW5kT2YoXCJ5ZWFyXCIpXG4gICAgICAgIC5mb3JtYXQoREVGQVVMVF9EQVRFX0ZST01BVCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIGZpcnN0RGF5LFxuICAgICAgbGFzdERheVxuICAgIH07XG4gIH1cblxuICBnZXRMb2NhbFRpbWV6b25lKCkge1xuICAgIGxldCB0eiA9IC9cXCgoLiopXFwpLy5leGVjKG5ldyBEYXRlKCkudG9TdHJpbmcoKSlbMV07XG5cbiAgICBpZiAodHogPT09IFwiQ2VudHJhbCBFdXJvcGUgU3RhbmRhcmQgVGltZVwiKSB7XG4gICAgICB0eiA9IEVVX1RaX0NPREU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHR6ID0gREVGQVVMVF9USU1FWk9ORV9DT0RFO1xuICAgIH1cblxuICAgIHJldHVybiB0ejtcbiAgfVxuXG4gIGdldFpvbmVEYXRlKHR6LCBmb3JtYXQsIGRhdGU/KSB7XG4gICAgaWYgKGRhdGUpIHtcbiAgICAgIGRhdGUgPSBtb21lbnQoZGF0ZSwgZm9ybWF0KVxuICAgICAgICAuc3RhcnRPZihcImRheVwiKVxuICAgICAgICAudmFsdWVPZigpO1xuICAgIH0gZWxzZSB7XG4gICAgICBkYXRlID0gbW9tZW50KCkudmFsdWVPZigpO1xuICAgIH1cblxuICAgIGxldCB0b2RheSA9IG5ldyBEYXRlKGRhdGUpLnRvTG9jYWxlU3RyaW5nKFwiZW4tVVNcIiwge1xuICAgICAgdGltZVpvbmU6IFRaX05BTUVTW3R6XVxuICAgIH0pO1xuICAgIHRvZGF5ID0gbW9tZW50KHRvZGF5LCBcIk1NL0REL1lZWVksIGhoOm1tOnNzIEFcIik7XG4gICAgcmV0dXJuIHRvZGF5O1xuICB9XG5cbiAgZ2V0Wm9uZVRvZGF5KHR6LCB2aWV3RGF0ZUZvcm1hdCkge1xuICAgIGNvbnN0IHRvZGF5ID0gdGhpcy5nZXRab25lRGF0ZSh0eiwgdmlld0RhdGVGb3JtYXQpO1xuICAgIHJldHVybiBtb21lbnQodG9kYXkpLmZvcm1hdChgJHt2aWV3RGF0ZUZvcm1hdH0gIGhoOm1tIEFgKTtcbiAgfVxuXG4gIGZvcm1hdFRvWm9uZURhdGUodHosIGZvcm1hdCwgZGF0ZSkge1xuICAgIGNvbnN0IGZvcm1hdHRlZERhdGUgPSB0aGlzLmdldFpvbmVEYXRlKHR6LCBmb3JtYXQsIGRhdGUpO1xuICAgIHJldHVybiBtb21lbnQoZm9ybWF0dGVkRGF0ZSkuZm9ybWF0KGAke2Zvcm1hdH1gKTtcbiAgfVxuXG4gIGNvbnZlcnRUb1ZpZXdUaW1lSXRlbShpdGVtKSB7XG4gICAgbGV0IHN0cmluZ2lmaWVkX2l0ZW0gPSBpdGVtICsgXCJcIjtcbiAgICBpZiAoc3RyaW5naWZpZWRfaXRlbS5sZW5ndGggPT09IDEpIHtcbiAgICAgIHN0cmluZ2lmaWVkX2l0ZW0gPSBgMCR7c3RyaW5naWZpZWRfaXRlbX1gO1xuICAgIH1cbiAgICByZXR1cm4gc3RyaW5naWZpZWRfaXRlbTtcbiAgfVxuXG4gIGdldFdlZWtOdW1iZXIoZGF0ZSk6IGFueSB7XG4gICAgaWYgKGRhdGUpIHtcbiAgICAgIGNvbnN0IHllYXIgPSBtb21lbnQoZGF0ZSwgXCJZWVlZLU1NLUREXCIpLnllYXIoKTtcbiAgICAgIGNvbnN0IG1vbnRoID0gbW9tZW50KGRhdGUsIFwiWVlZWS1NTS1ERFwiKS5tb250aCgpO1xuICAgICAgY29uc3QgZGF5ID0gTnVtYmVyKG1vbWVudChkYXRlLCBcIllZWVktTU0tRERcIikuZm9ybWF0KFwiRFwiKSk7XG5cbiAgICAgIGNvbnN0IHllYXJTdGFydG1zID0gbmV3IERhdGUoeWVhciwgMCwgMSk7XG4gICAgICBjb25zdCBkYXRlbXMgPSBuZXcgRGF0ZSh5ZWFyLCBtb250aCwgZGF5KTtcbiAgICAgIHJldHVybiBNYXRoLmNlaWwoKChkYXRlbXMuZ2V0VGltZSgpIC0geWVhclN0YXJ0bXMuZ2V0VGltZSgpKSAvIDg2NDAwMDAwICsgeWVhclN0YXJ0bXMuZ2V0RGF5KCkgKyAxKSAvIDcpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zb2xlLndhcm4oXCJnZXRXZWVrTnVtYmVyOiBJbnZhbGlkIGRhdGVcIik7XG4gICAgICByZXR1cm4gdGhpcy5nZXROb3RBdmFpbGFibGVUZXh0KCk7XG4gICAgfVxuICB9XG59XG4iXX0=