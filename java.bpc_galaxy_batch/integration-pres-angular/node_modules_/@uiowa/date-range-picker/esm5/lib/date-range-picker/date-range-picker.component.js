/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, Output, EventEmitter, ElementRef, ViewChild } from '@angular/core';
import { NgbInputDatepicker } from '@ng-bootstrap/ng-bootstrap';
import { DateRange } from '../models/date-range';
import { NgbDateNativeAdapter } from '../services/NgbDateNativeAdapter';
var DateRangePickerComponent = /** @class */ (function () {
    function DateRangePickerComponent(dateAdapter) {
        var _this = this;
        this.dateAdapter = dateAdapter;
        this.disabled = false;
        this.dateRangeChange = new EventEmitter();
        this.isInside = function (date) { return date.after(_this.fromDate) && date.before(_this.toDate); };
        this.isFrom = function (date) { return date.equals(_this.fromDate); };
        this.isTo = function (date) { return date.equals(_this.toDate); };
        this.isDisabled = function (date) { return date.after(_this.max) || date.before(_this.min); };
        this.isInFuture = function (date) { return date.after(_this.toDate); };
    }
    /**
     * @return {?}
     */
    DateRangePickerComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        this.fromDate = this.dateAdapter.fromModel(this.dateRange.start);
        this.toDate = this.dateAdapter.fromModel(this.dateRange.end);
        this.min = this.minDate ? this.dateAdapter.fromModel(this.minDate) : null;
        this.max = this.maxDate ? this.dateAdapter.fromModel(this.maxDate) : null;
        this.inputElRef.nativeElement.value = this.formatInputText();
        if (this.fromDate) {
            this.dp.startDate = {
                year: this.fromDate.year,
                month: this.fromDate.month
            };
        }
    };
    /**
     * @param {?} changes
     * @return {?}
     */
    DateRangePickerComponent.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        if (changes.dateRange || changes.disabled) {
            this.ngOnInit();
        }
    };
    /**
     * @param {?} date
     * @param {?} dp
     * @return {?}
     */
    DateRangePickerComponent.prototype.onDateChange = /**
     * @param {?} date
     * @param {?} dp
     * @return {?}
     */
    function (date, dp) {
        if (!this.fromDate && !this.toDate) {
            this.fromDate = date;
            this.dateRange.start = this.dateAdapter.toModel(this.fromDate);
        }
        else if (this.fromDate && !this.toDate && date.after(this.fromDate)) {
            this.toDate = date;
            this.dateRange.end = this.dateAdapter.toModel(this.toDate);
            dp.close();
        }
        else {
            this.toDate = null;
            this.fromDate = date;
            this.dateRange.start = this.dateAdapter.toModel(this.fromDate);
            this.dateRange.end = null;
        }
        this.inputElRef.nativeElement.value = this.formatInputText();
        this.dateRangeChange.emit(this.dateRange);
    };
    /**
     * @private
     * @return {?}
     */
    DateRangePickerComponent.prototype.formatInputText = /**
     * @private
     * @return {?}
     */
    function () {
        if (this.dateRange.start &&
            this.dateRange.end &&
            DateRange.isValidDate(this.dateRange.start) &&
            DateRange.isValidDate(this.dateRange.end)) {
            return this.dateRange.start.toLocaleDateString() + " - " + this.dateRange.end.toLocaleDateString();
        }
        return '';
    };
    /**
     * @param {?} date
     * @return {?}
     */
    DateRangePickerComponent.prototype.isHovered = /**
     * @param {?} date
     * @return {?}
     */
    function (date) {
        return (this.fromDate &&
            !this.toDate &&
            this.hoveredDate &&
            date.after(this.fromDate) &&
            date.before(this.hoveredDate));
    };
    /**
     * @param {?} date
     * @return {?}
     */
    DateRangePickerComponent.prototype.isWeekend = /**
     * @param {?} date
     * @return {?}
     */
    function (date) {
        /** @type {?} */
        var d = new Date(date.year, date.month - 1, date.day);
        return d.getDay() === 0 || d.getDay() === 6;
    };
    DateRangePickerComponent.decorators = [
        { type: Component, args: [{
                    selector: 'date-range-picker',
                    template: "<div class=\"input-group\">\r\n  <input ngbDatepicker #dp=\"ngbDatepicker\" type=\"text\" class=\"form-control\" style=\"max-width:200px;\" readonly\r\n    [disabled]=\"disabled\" [autoClose]=\"false\" [displayMonths]=\"2\" [dayTemplate]=\"t\" [showWeekNumbers]=\"false\"\r\n    [markDisabled]=\"isDisabled\" [firstDayOfWeek]=\"7\" (click)=\"dp.toggle()\" (dateSelect)=\"onDateChange($event, dp)\">\r\n  <div class=\"input-group-append\">\r\n    <button class=\"btn btn-outline-secondary d-flex align-items-center\" (click)=\"dp.toggle()\" type=\"button\">\r\n      <svg aria-hidden=\"true\" role=\"icon\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 448 512\">\r\n        <path fill=\"currentColor\" d=\"M148 288h-40c-6.6 0-12-5.4-12-12v-40c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12zm108-12v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm96 0v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm-96 96v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm-96 0v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm192 0v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm96-260v352c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V112c0-26.5 21.5-48 48-48h48V12c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v52h128V12c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v52h48c26.5 0 48 21.5 48 48zm-48 346V160H48v298c0 3.3 2.7 6 6 6h340c3.3 0 6-2.7 6-6z\"></path>\r\n      </svg>\r\n    </button>\r\n  </div>\r\n</div>\r\n\r\n<ng-template #t let-date=\"date\" let-focused=\"focused\" let-disabled=\"disabled\">\r\n  <span class=\"custom-day\" [class.focused]=\"focused\" [class.range]=\"isFrom(date) || isTo(date) || isInside(date) || isHovered(date)\"\r\n    [class.faded]=\"isHovered(date) || isInside(date)\" [class.weekend]=\"isWeekend(date)\" [class.disabled]=\"disabled\"\r\n    (mouseenter)=\"hoveredDate = date\" (mouseleave)=\"hoveredDate = null\">\r\n    {{ date.day }}\r\n  </span>\r\n</ng-template>\r\n",
                    styles: [".custom-day{text-align:center;padding:.185rem .25rem;display:inline-block;height:2rem;width:2rem}.custom-day.focused{background-color:#e6e6e6}.custom-day.range,.custom-day:hover{background-color:#0275d8;color:#fff}.custom-day.faded{background-color:rgba(2,117,216,.5)}.custom-day.weekend{color:#ff6e6e}.custom-day.disabled{color:#c8cdd2}svg{width:1rem;height:1rem}"]
                }] }
    ];
    /** @nocollapse */
    DateRangePickerComponent.ctorParameters = function () { return [
        { type: NgbDateNativeAdapter }
    ]; };
    DateRangePickerComponent.propDecorators = {
        dateRange: [{ type: Input }],
        minDate: [{ type: Input }],
        maxDate: [{ type: Input }],
        disabled: [{ type: Input }],
        dateRangeChange: [{ type: Output }],
        inputElRef: [{ type: ViewChild, args: ['dp', { read: ElementRef },] }],
        dp: [{ type: ViewChild, args: ['dp',] }]
    };
    return DateRangePickerComponent;
}());
export { DateRangePickerComponent };
if (false) {
    /** @type {?} */
    DateRangePickerComponent.prototype.dateRange;
    /** @type {?} */
    DateRangePickerComponent.prototype.minDate;
    /** @type {?} */
    DateRangePickerComponent.prototype.maxDate;
    /** @type {?} */
    DateRangePickerComponent.prototype.disabled;
    /** @type {?} */
    DateRangePickerComponent.prototype.dateRangeChange;
    /** @type {?} */
    DateRangePickerComponent.prototype.hoveredDate;
    /**
     * @type {?}
     * @private
     */
    DateRangePickerComponent.prototype.fromDate;
    /**
     * @type {?}
     * @private
     */
    DateRangePickerComponent.prototype.toDate;
    /**
     * @type {?}
     * @private
     */
    DateRangePickerComponent.prototype.min;
    /**
     * @type {?}
     * @private
     */
    DateRangePickerComponent.prototype.max;
    /**
     * @type {?}
     * @private
     */
    DateRangePickerComponent.prototype.inputElRef;
    /**
     * @type {?}
     * @private
     */
    DateRangePickerComponent.prototype.dp;
    /** @type {?} */
    DateRangePickerComponent.prototype.isInside;
    /** @type {?} */
    DateRangePickerComponent.prototype.isFrom;
    /** @type {?} */
    DateRangePickerComponent.prototype.isTo;
    /** @type {?} */
    DateRangePickerComponent.prototype.isDisabled;
    /** @type {?} */
    DateRangePickerComponent.prototype.isInFuture;
    /**
     * @type {?}
     * @private
     */
    DateRangePickerComponent.prototype.dateAdapter;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0ZS1yYW5nZS1waWNrZXIuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQHVpb3dhL2RhdGUtcmFuZ2UtcGlja2VyLyIsInNvdXJjZXMiOlsibGliL2RhdGUtcmFuZ2UtcGlja2VyL2RhdGUtcmFuZ2UtcGlja2VyLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUNMLFNBQVMsRUFFVCxLQUFLLEVBQ0wsTUFBTSxFQUNOLFlBQVksRUFDWixVQUFVLEVBQ1YsU0FBUyxFQUdWLE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sRUFBRSxrQkFBa0IsRUFBVyxNQUFNLDRCQUE0QixDQUFDO0FBQ3pFLE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQztBQUNqRCxPQUFPLEVBQUUsb0JBQW9CLEVBQUUsTUFBTSxrQ0FBa0MsQ0FBQztBQUV4RTtJQTJCRSxrQ0FBNkIsV0FBaUM7UUFBOUQsaUJBQWtFO1FBQXJDLGdCQUFXLEdBQVgsV0FBVyxDQUFzQjtRQWQ5RCxhQUFRLEdBQUssS0FBSyxDQUFDO1FBRW5CLG9CQUFlLEdBQUcsSUFBSSxZQUFZLEVBQWEsQ0FBQztRQXlFaEQsYUFBUSxHQUFHLFVBQUEsSUFBSSxJQUFJLE9BQUEsSUFBSSxDQUFDLEtBQUssQ0FBQyxLQUFJLENBQUMsUUFBUSxDQUFDLElBQUksSUFBSSxDQUFDLE1BQU0sQ0FBQyxLQUFJLENBQUMsTUFBTSxDQUFDLEVBQXJELENBQXFELENBQUM7UUFDekUsV0FBTSxHQUFHLFVBQUEsSUFBSSxJQUFJLE9BQUEsSUFBSSxDQUFDLE1BQU0sQ0FBQyxLQUFJLENBQUMsUUFBUSxDQUFDLEVBQTFCLENBQTBCLENBQUM7UUFDNUMsU0FBSSxHQUFHLFVBQUEsSUFBSSxJQUFJLE9BQUEsSUFBSSxDQUFDLE1BQU0sQ0FBQyxLQUFJLENBQUMsTUFBTSxDQUFDLEVBQXhCLENBQXdCLENBQUM7UUFLeEMsZUFBVSxHQUFHLFVBQUEsSUFBSSxJQUFJ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LENBQUM7SUFDOUMsQ0FBQzs7Z0JBOUZGLFNBQVMsU0FBQztvQkFDVCxRQUFRLEVBQUUsbUJBQW1CO29CQUM3QiwybEVBQWlEOztpQkFFbEQ7Ozs7Z0JBTlEsb0JBQW9COzs7NEJBUTFCLEtBQUs7MEJBRUwsS0FBSzswQkFFTCxLQUFLOzJCQUVMLEtBQUs7a0NBRUwsTUFBTTs2QkFRTixTQUFTLFNBQUMsSUFBSSxFQUFFLEVBQUUsSUFBSSxFQUFFLFVBQVUsRUFBRTtxQkFFcEMsU0FBUyxTQUFDLElBQUk7O0lBeUVqQiwrQkFBQztDQUFBLEFBakdELElBaUdDO1NBNUZZLHdCQUF3Qjs7O0lBQ25DLDZDQUNxQjs7SUFDckIsMkNBQ2U7O0lBQ2YsMkNBQ2U7O0lBQ2YsNENBQ21COztJQUNuQixtREFDZ0Q7O0lBQ2hELCtDQUFxQjs7Ozs7SUFFckIsNENBQTBCOzs7OztJQUMxQiwwQ0FBd0I7Ozs7O0lBQ3hCLHVDQUE0Qjs7Ozs7SUFDNUIsdUNBQTRCOzs7OztJQUM1Qiw4Q0FDK0I7Ozs7O0lBQy9CLHNDQUMrQjs7SUErRC9CLDRDQUF5RTs7SUFDekUsMENBQTRDOztJQUM1Qyx3Q0FBd0M7O0lBS3hDLDhDQUFtRTs7SUFDbkUsOENBQTZDOzs7OztJQXJFakMsK0NBQWtEIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcclxuICBDb21wb25lbnQsXHJcbiAgT25Jbml0LFxyXG4gIElucHV0LFxyXG4gIE91dHB1dCxcclxuICBFdmVudEVtaXR0ZXIsXHJcbiAgRWxlbWVudFJlZixcclxuICBWaWV3Q2hpbGQsXHJcbiAgT25DaGFuZ2VzLFxyXG4gIFNpbXBsZUNoYW5nZXNcclxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgTmdiSW5wdXREYXRlcGlja2VyLCBOZ2JEYXRlIH0gZnJvbSAnQG5nLWJvb3RzdHJhcC9uZy1ib290c3RyYXAnO1xyXG5pbXBvcnQgeyBEYXRlUmFuZ2UgfSBmcm9tICcuLi9tb2RlbHMvZGF0ZS1yYW5nZSc7XHJcbmltcG9ydCB7IE5nYkRhdGVOYXRpdmVBZGFwdGVyIH0gZnJvbSAnLi4vc2VydmljZXMvTmdiRGF0ZU5hdGl2ZUFkYXB0ZXInO1xyXG5cclxuQENvbXBvbmVudCh7XHJcbiAgc2VsZWN0b3I6ICdkYXRlLXJhbmdlLXBpY2tlcicsXHJcbiAgdGVtcGxhdGVVcmw6ICcuL2RhdGUtcmFuZ2UtcGlja2VyLmNvbXBvbmVudC5odG1sJyxcclxuICBzdHlsZVVybHM6IFsnLi9kYXRlLXJhbmdlLXBpY2tlci5jb21wb25lbnQuY3NzJ11cclxufSlcclxuZXhwb3J0IGNsYXNzIERhdGVSYW5nZVBpY2tlckNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgT25DaGFuZ2VzIHtcclxuICBASW5wdXQoKVxyXG4gIGRhdGVSYW5nZTogRGF0ZVJhbmdlO1xyXG4gIEBJbnB1dCgpXHJcbiAgbWluRGF0ZT86IERhdGU7XHJcbiAgQElucHV0KClcclxuICBtYXhEYXRlPzogRGF0ZTtcclxuICBASW5wdXQoKVxyXG4gIGRpc2FibGVkID8gPSBmYWxzZTtcclxuICBAT3V0cHV0KClcclxuICBkYXRlUmFuZ2VDaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyPERhdGVSYW5nZT4oKTtcclxuICBob3ZlcmVkRGF0ZTogTmdiRGF0ZTtcclxuXHJcbiAgcHJpdmF0ZSBmcm9tRGF0ZTogTmdiRGF0ZTtcclxuICBwcml2YXRlIHRvRGF0ZTogTmdiRGF0ZTtcclxuICBwcml2YXRlIG1pbjogTmdiRGF0ZSB8IG51bGw7XHJcbiAgcHJpdmF0ZSBtYXg6IE5nYkRhdGUgfCBudWxsO1xyXG4gIEBWaWV3Q2hpbGQoJ2RwJywgeyByZWFkOiBFbGVtZW50UmVmIH0pXHJcbiAgcHJpdmF0ZSBpbnB1dEVsUmVmOiBFbGVtZW50UmVmO1xyXG4gIEBWaWV3Q2hpbGQoJ2RwJylcclxuICBwcml2YXRlIGRwOiBOZ2JJbnB1dERhdGVwaWNrZXI7XHJcblxyXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgcmVhZG9ubHkgZGF0ZUFkYXB0ZXI6IE5nYkRhdGVOYXRpdmVBZGFwdGVyKSB7fVxyXG5cclxuICBuZ09uSW5pdCgpIHtcclxuICAgIHRoaXMuZnJvbURhdGUgPSB0aGlzLmRhdGVBZGFwdGVyLmZyb21Nb2RlbCh0aGlzLmRhdGVSYW5nZS5zdGFydCk7XHJcbiAgICB0aGlzLnRvRGF0ZSA9IHRoaXMuZGF0ZUFkYXB0ZXIuZnJvbU1vZGVsKHRoaXMuZGF0ZVJhbmdlLmVuZCk7XHJcbiAgICB0aGlzLm1pbiA9IHRoaXMubWluRGF0ZSA/IHRoaXMuZGF0ZUFkYXB0ZXIuZnJvbU1vZGVsKHRoaXMubWluRGF0ZSkgOiBudWxsO1xyXG4gICAgdGhpcy5tYXggPSB0aGlzLm1heERhdGUgPyB0aGlzLmRhdGVBZGFwdGVyLmZyb21Nb2RlbCh0aGlzLm1heERhdGUpIDogbnVsbDtcclxuICAgIHRoaXMuaW5wdXRFbFJlZi5uYXRpdmVFbGVtZW50LnZhbHVlID0gdGhpcy5mb3JtYXRJbnB1dFRleHQoKTtcclxuICAgIGlmICh0aGlzLmZyb21EYXRlKSB7XHJcbiAgICAgIHRoaXMuZHAuc3RhcnREYXRlID0ge1xyXG4gICAgICAgIHllYXI6IHRoaXMuZnJvbURhdGUueWVhcixcclxuICAgICAgICBtb250aDogdGhpcy5mcm9tRGF0ZS5tb250aFxyXG4gICAgICB9O1xyXG4gICAgfVxyXG4gIH1cclxuICBuZ09uQ2hhbmdlcyhjaGFuZ2VzOiBTaW1wbGVDaGFuZ2VzKTogdm9pZCB7XHJcbiAgICBpZiAoY2hhbmdlcy5kYXRlUmFuZ2UgfHwgY2hhbmdlcy5kaXNhYmxlZCkge1xyXG4gICAgICB0aGlzLm5nT25Jbml0KCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBvbkRhdGVDaGFuZ2UoZGF0ZTogTmdiRGF0ZSwgZHA6IE5nYklucHV0RGF0ZXBpY2tlcikge1xyXG4gICAgaWYgKCF0aGlzLmZyb21EYXRlICYmICF0aGlzLnRvRGF0ZSkge1xyXG4gICAgICB0aGlzLmZyb21EYXRlID0gZGF0ZTtcclxuICAgICAgdGhpcy5kYXRlUmFuZ2Uuc3RhcnQgPSB0aGlzLmRhdGVBZGFwdGVyLnRvTW9kZWwodGhpcy5mcm9tRGF0ZSk7XHJcbiAgICB9IGVsc2UgaWYgKHRoaXMuZnJvbURhdGUgJiYgIXRoaXMudG9EYXRlICYmIGRhdGUuYWZ0ZXIodGhpcy5mcm9tRGF0ZSkpIHtcclxuICAgICAgdGhpcy50b0RhdGUgPSBkYXRlO1xyXG4gICAgICB0aGlzLmRhdGVSYW5nZS5lbmQgPSB0aGlzLmRhdGVBZGFwdGVyLnRvTW9kZWwodGhpcy50b0RhdGUpO1xyXG4gICAgICBkcC5jbG9zZSgpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy50b0RhdGUgPSBudWxsO1xyXG4gICAgICB0aGlzLmZyb21EYXRlID0gZGF0ZTtcclxuICAgICAgdGhpcy5kYXRlUmFuZ2Uuc3RhcnQgPSB0aGlzLmRhdGVBZGFwdGVyLnRvTW9kZWwodGhpcy5mcm9tRGF0ZSk7XHJcbiAgICAgIHRoaXMuZGF0ZVJhbmdlLmVuZCA9IG51bGw7XHJcbiAgICB9XHJcbiAgICB0aGlzLmlucHV0RWxSZWYubmF0aXZlRWxlbWVudC52YWx1ZSA9IHRoaXMuZm9ybWF0SW5wdXRUZXh0KCk7XHJcbiAgICB0aGlzLmRhdGVSYW5nZUNoYW5nZS5lbWl0KHRoaXMuZGF0ZVJhbmdlKTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgZm9ybWF0SW5wdXRUZXh0KCk6IHN0cmluZyB7XHJcbiAgICBpZiAoXHJcbiAgICAgIHRoaXMuZGF0ZVJhbmdlLnN0YXJ0ICYmXHJcbiAgICAgIHRoaXMuZGF0ZVJhbmdlLmVuZCAmJlxyXG4gICAgICBEYXRlUmFuZ2UuaXNWYWxpZERhdGUodGhpcy5kYXRlUmFuZ2Uuc3RhcnQpICYmXHJcbiAgICAgIERhdGVSYW5nZS5pc1ZhbGlkRGF0ZSh0aGlzLmRhdGVSYW5nZS5lbmQpXHJcbiAgICApIHtcclxuICAgICAgcmV0dXJuIGAke3RoaXMuZGF0ZVJhbmdlLnN0YXJ0LnRvTG9jYWxlRGF0ZVN0cmluZygpfSAtICR7dGhpcy5kYXRlUmFuZ2UuZW5kLnRvTG9jYWxlRGF0ZVN0cmluZygpfWA7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gJyc7XHJcbiAgfVxyXG5cclxuICBpc0hvdmVyZWQoZGF0ZSkge1xyXG4gICAgcmV0dXJuIChcclxuICAgICAgdGhpcy5mcm9tRGF0ZSAmJlxyXG4gICAgICAhdGhpcy50b0RhdGUgJiZcclxuICAgICAgdGhpcy5ob3ZlcmVkRGF0ZSAmJlxyXG4gICAgICBkYXRlLmFmdGVyKHRoaXMuZnJvbURhdGUpICYmXHJcbiAgICAgIGRhdGUuYmVmb3JlKHRoaXMuaG92ZXJlZERhdGUpXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgaXNJbnNpZGUgPSBkYXRlID0+IGRhdGUuYWZ0ZXIodGhpcy5mcm9tRGF0ZSkgJiYgZGF0ZS5iZWZvcmUodGhpcy50b0RhdGUpO1xyXG4gIGlzRnJvbSA9IGRhdGUgPT4gZGF0ZS5lcXVhbHModGhpcy5mcm9tRGF0ZSk7XHJcbiAgaXNUbyA9IGRhdGUgPT4gZGF0ZS5lcXVhbHModGhpcy50b0RhdGUpO1xyXG4gIGlzV2Vla2VuZChkYXRlOiBOZ2JEYXRlKSB7XHJcbiAgICBjb25zdCBkID0gbmV3IERhdGUoZGF0ZS55ZWFyLCBkYXRlLm1vbnRoIC0gMSwgZGF0ZS5kYXkpO1xyXG4gICAgcmV0dXJuIGQuZ2V0RGF5KCkgPT09IDAgfHwgZC5nZXREYXkoKSA9PT0gNjtcclxuICB9XHJcbiAgaXNEaXNhYmxlZCA9IGRhdGUgPT4gZGF0ZS5hZnRlcih0aGlzLm1heCkgfHwgZGF0ZS5iZWZvcmUodGhpcy5taW4pO1xyXG4gIGlzSW5GdXR1cmUgPSBkYXRlID0+IGRhdGUuYWZ0ZXIodGhpcy50b0RhdGUpO1xyXG59XHJcbiJdfQ==