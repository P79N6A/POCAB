<?xml version="1.0" encoding="utf-8"?>
<xsd:schema xmlns:NostroAccountReference="http://www.sophis.net/NostroAccountReference" xmlns:instrument="http://www.sophis.net/Instrument" xmlns:common="http://sophis.net/sophis/common" xmlns:tns="http://www.sophis.net/trade" xmlns:party="http://www.sophis.net/party" xmlns:user="http://www.sophis.net/user" xmlns:tag="http://www.sophis.net/Tag" attributeFormDefault="qualified" elementFormDefault="qualified" targetNamespace="http://www.sophis.net/trade" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:ssi="http://www.sophis.net/SSI">
  <xsd:annotation>
    <xsd:documentation source="http://www.sophis.net" xml:lang="en">
      Supported TradeIdSchemes:
      http://www.sophis.net/trade/tradeId/id
      http://www.sophis.net/trade/tradeId/externalReference
      http://www.sophis.net/trade/tradeId/farlegId

      Supported LinkIdSchemes:
      http://www.sophis.net/trade/linkId/positionId
      http://www.sophis.net/trade/linkId/operation
      http://www.sophis.net/trade/linkId/order
      http://www.sophis.net/trade/linkId/orderId
      http://www.sophis.net/trade/linkId/basket
      http://www.sophis.net/trade/linkId/externalReference
      http://www.sophis.net/trade/linkId/usi
      http://www.sophis.net/trade/linkId/prior_usi
      http://www.sophis.net/trade/linkId/block_usi
      http://www.sophis.net/trade/linkId/clearingId
      http://www.sophis.net/trade/linkId/elecId
      http://www.sophis.net/trade/linkId/cptyId

      Supported TraderSchemes:
      http://www.sophis.net/user/userId/name
      http://www.sophis.net/user/userId/id

      Supported paymentTypeScheme:
      http://www.sophis.net/trade/paymentType/brokerFees
      http://www.sophis.net/trade/paymentType/marketFees
      http://www.sophis.net/trade/paymentType/couterpartyFees

      Supported ConventionIdSchemes:
      http://www.sophis.net/trade/conventionId/ident
      http://www.sophis.net/trade/conventionId/name
      http://www.sophis.net/trade/conventionId/externalReference
    </xsd:documentation>
  </xsd:annotation>
  <xsd:import namespace="http://sophis.net/sophis/common" schemaLocation="common.xsd" />
  <xsd:import namespace="http://www.sophis.net/Instrument" schemaLocation="instrument.xsd" />
  <xsd:import namespace="http://www.sophis.net/party" schemaLocation="party.xsd" />
  <xsd:import namespace="http://www.sophis.net/user" schemaLocation="user.xsd" />
  <xsd:import namespace="http://www.sophis.net/Tag" schemaLocation="Tag.xsd"/>
  <xsd:import namespace="http://www.sophis.net/SSI" schemaLocation="ssi.xsd"/>
  <xsd:import namespace="http://www.sophis.net/NostroAccountReference" 	schemaLocation="NostroAccountReference.xsd"/>
  <xsd:attributeGroup name="CreationUpdateWorkflowEvent.model">
    <xsd:attribute name="creationWorkflowEventId" use="optional" type="xsd:int">
      <xsd:annotation>
        <xsd:documentation source="http://www.sophis.net" xml:lang="en">Since 5.3 : Workflow Event identifier to be applied during creation.</xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
    <xsd:attribute name="creationWorkflowEventName" use="optional" type="xsd:token">
      <xsd:annotation>
        <xsd:documentation source="http://www.sophis.net" xml:lang="en">
          Since 5.3 : Workflow Event name to be applied during creation.
          Alternative with (hence exclusive to) workflowEventId. The lookup is case insensitive.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
    <xsd:attribute name="updateWorkflowEventId" use="optional" type="xsd:int">
      <xsd:annotation>
        <xsd:documentation source="http://www.sophis.net" xml:lang="en">Since 5.3 : Workflow Event identifier to be applied during update.</xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
    <xsd:attribute name="updateWorkflowEventName" use="optional" type="xsd:token">
      <xsd:annotation>
        <xsd:documentation source="http://www.sophis.net" xml:lang="en">
          Since 5.3 : Workflow Event name to be applied during update.
          Alternative with (hence exclusive to) workflowEventId. The lookup is case insensitive.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
  </xsd:attributeGroup>

  <xsd:simpleType name="BOParamDefaultEvents">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">
        Lists of the default event parameters
      </xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:normalizedString">
      <xsd:enumeration value="FOCreation" />
      <xsd:enumeration value="MOCreation" />
      <xsd:enumeration value="FOModification" />
      <xsd:enumeration value="MOModification" />
      <xsd:enumeration value="FODeletion" />
      <xsd:enumeration value="MODeletion" />
      <xsd:enumeration value="TradeAlloc" />
      <xsd:enumeration value="TradeAllocAndAccept" />
      <xsd:enumeration value="LinePicking" />
      <xsd:enumeration value="TradePriceUpdateOTC" />
      <xsd:enumeration value="DragDropMove" />
    </xsd:restriction>
  </xsd:simpleType>

  <xsd:complexType name="TradeKernelEvent">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">
        since 6.1.2.5 : trade kernel event update element
      </xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element ref="tns:tradeIdentifier" minOccurs="1" maxOccurs="1" />
      <xsd:choice>
        <xsd:element name="eventId" type="xsd:int"  />
        <xsd:element name="eventName" type="xsd:string"/>
        <xsd:element name="eventParamName" type="tns:BOParamDefaultEvents">
          <xsd:annotation>
            <xsd:documentation source="http://www.sophis.net" xml:lang="en">
              Applies one of the events configured in the Default Kernel pannel of the Back Office Parameters. Used only at import.
            </xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:choice>
      <xsd:choice minOccurs="0" maxOccurs="1">
        <xsd:element name="finalStatus" type="xsd:int">
          <xsd:annotation>
            <xsd:documentation source="http://www.sophis.net" xml:lang="en">backOffice status after event update</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element name="finalStatusName" type="xsd:string">
          <xsd:annotation>
            <xsd:documentation source="http://www.sophis.net" xml:lang="en">backOffice status after event update</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:choice>
    </xsd:sequence>
    <xsd:attributeGroup ref="common:PersistentEntity.model">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">Since 5.3.3 add persitenceType for import</xsd:documentation>
      </xsd:annotation>
    </xsd:attributeGroup>
  </xsd:complexType>
  <xsd:element name="tradeKernelEvent" type="tns:TradeKernelEvent" />
  <xsd:complexType name="AbstractPostTradeEvent" abstract="true">
    <xsd:annotation>
      <xsd:documentation>Abstract base type for all events.</xsd:documentation>
    </xsd:annotation>
  </xsd:complexType>
  <xsd:element name="abstractPostTradeEvent" type="tns:AbstractPostTradeEvent" />
  <xsd:group name="AgreementAndEffectiveDates.model">
    <xsd:annotation>
      <xsd:documentation>A model group defining agreement and effective dates.</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="agreementDate" type="xsd:date">
        <xsd:annotation>
          <xsd:documentation>The date on which the change was agreed.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="effectiveDate" type="xsd:date">
        <xsd:annotation>
          <xsd:documentation>The date on which the change become effective.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:group>
  <xsd:group name="TradeAlterationPayment.model">
    <xsd:annotation>
      <xsd:documentation>A model group defining a payment structure.</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="payment" type="tns:Payment" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation>Describes a payment made in settlement of the change.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:group>
  <xsd:complexType name="TradeChangeBase">
    <xsd:annotation>
      <xsd:documentation>A structure describing a trade change.</xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="tns:AbstractPostTradeEvent">
        <xsd:sequence>
          <xsd:group ref="tns:AgreementAndEffectiveDates.model" />
          <xsd:group ref="tns:TradeAlterationPayment.model" />
        </xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:complexType name="TradeNotionalChange">
    <xsd:annotation>
      <xsd:documentation>A structure describing a change to the trade notional.</xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="tns:TradeChangeBase">
        <xsd:choice>
          <xsd:sequence>
            <xsd:element name="changeInNotionalAmount" type="instrument:Money">
              <xsd:annotation>
                <xsd:documentation xml:lang="en">Specifies the fixed amount by which the Notional Amount changes. The direction of the change (increase or decrease) is specified by the event type (Termination =&gt; reduction, Increase =&gt; greater.)</xsd:documentation>
              </xsd:annotation>
            </xsd:element>
            <xsd:element name="outstandingNotionalAmount" type="instrument:Money">
              <xsd:annotation>
                <xsd:documentation xml:lang="en">Specifies the Notional amount after the Change</xsd:documentation>
              </xsd:annotation>
            </xsd:element>
          </xsd:sequence>
          <xsd:sequence>
            <xsd:element name="changeInNumberOfOptions" type="xsd:decimal">
              <xsd:annotation>
                <xsd:documentation xml:lang="en">Specifies the fixed amount by which the Number of Options changes</xsd:documentation>
              </xsd:annotation>
            </xsd:element>
            <xsd:element name="outstandingNumberOfOptions" type="xsd:decimal">
              <xsd:annotation>
                <xsd:documentation xml:lang="en">Specifies the Number of Options after the Change.</xsd:documentation>
              </xsd:annotation>
            </xsd:element>
          </xsd:sequence>
          <xsd:sequence>
            <xsd:element name="changeInNumberOfUnits" type="xsd:decimal">
              <xsd:annotation>
                <xsd:documentation xml:lang="en">Specifies the fixed amount by which the Number of Units changes</xsd:documentation>
              </xsd:annotation>
            </xsd:element>
            <xsd:element name="outstandingNumberOfUnits" type="xsd:decimal">
              <xsd:annotation>
                <xsd:documentation xml:lang="en">Specifies the Number of Units</xsd:documentation>
              </xsd:annotation>
            </xsd:element>
          </xsd:sequence>
        </xsd:choice>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:complexType name="IncreaseEvent">
    <xsd:annotation>
      <xsd:documentation>A structure describing an increase of the trade notional.</xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="tns:TradeNotionalChange"/>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:element name="increaseEvent" type="tns:IncreaseEvent" substitutionGroup="tns:abstractPostTradeEvent" />
  <xsd:complexType name="TerminationEvent">
    <xsd:annotation>
      <xsd:documentation>A structure describing an decrease of the trade notional.</xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="tns:TradeNotionalChange"/>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:element name="terminationEvent" type="tns:TerminationEvent" substitutionGroup="tns:abstractPostTradeEvent" />
  <xsd:group name="NovationRoles.model">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">The roles of the parties involved in the novation.</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="transferor" type="party:PartyReference">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">A pointer style reference to a party identifier defined elsewhere in the document. In a three-way novation the party referenced is the Transferor (outgoing party) in the novation. The Transferor means a party which transfers by novation to a Transferee all of its rights, liabilities, duties and obligations with respect to a Remaining Party. In a four-way novation the party referenced is Transferor 1 which transfers by novation to Transferee 1 all of its rights, liabilities, duties and obligations with respect to Transferor 2. ISDA 2004 Novation Term: Transferor (three-way novation) or Transferor 1 (four-way novation).</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="transferee" type="party:PartyReference">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">A pointer style reference to a party identifier defined elsewhere in the document. In a three-way novation the party referenced is the Transferee (incoming party) in the novation. Transferee means a party which accepts by way of novation all rights, liabilities, duties and obligations of a Transferor with respect to a Remaining Party. In a four-way novation the party referenced is Transferee 1 which accepts by way of novation the rights, liabilities, duties and obligations of Transferor 1. ISDA 2004 Novation Term: Transferee (three-way novation) or Transferee 1 (four-way novation).</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="remainingParty" type="party:PartyReference">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">A pointer style reference to a party identifier defined elsewhere in the document. In a three-way novation the party referenced is the Remaining Party in the novation. Remaining Party means a party which consents to a Transferor's transfer by novation and the acceptance thereof by the Transferee of all of the Transferor's rights, liabilities, duties and obligations with respect to such Remaining Party under and with respect of the Novated Amount of a transaction. In a four-way novation the party referenced is Transferor 2 per the ISDA definition and acts in the role of a Transferor. Transferor 2 transfers by novation to Transferee 2 all of its rights, liabilities, duties and obligations with respect to Transferor 1. ISDA 2004 Novation Term: Remaining Party (three-way novation) or Transferor 2 (four-way novation).</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:group>
  <xsd:group name="NovationDates.model">
    <xsd:sequence>
      <xsd:element name="novationDate" type="xsd:date">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">Specifies the date that one party's legal obligations with regard to a trade are transferred to another party. It corresponds to the Novation Date section of the 2004 ISDA Novation Definitions, section 1.16.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:group>
  <xsd:group name="NovationAmounts.model">
    <xsd:choice>
      <xsd:annotation>
        <xsd:documentation xml:lang="en">Choice for expressing the novated amount as either a money amount, number of options, or number of units, according the the financial product which is being novated.</xsd:documentation>
      </xsd:annotation>
      <xsd:sequence>
        <xsd:element name="novatedAmount" type="instrument:Money">
          <xsd:annotation>
            <xsd:documentation xml:lang="en">The amount which represents the portion of the Old Contract being novated.</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element name="remainingAmount" type="instrument:Money" minOccurs="0">
          <xsd:annotation>
            <xsd:documentation xml:lang="en">The amount which represents the portion of the Old Contract not being novated.</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
      <xsd:sequence>
        <xsd:element name="novatedNumberOfOptions" type="xsd:decimal">
          <xsd:annotation>
            <xsd:documentation xml:lang="en">The number of options which represent the portion of the Old Contract being novated.</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element name="remainingNumberOfOptions" type="xsd:decimal" minOccurs="0">
          <xsd:annotation>
            <xsd:documentation xml:lang="en">The number of options which represent the portion of the Old Contract not being novated.</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
      <xsd:sequence>
        <xsd:element name="novatedNumberOfUnits" type="xsd:decimal">
          <xsd:annotation>
            <xsd:documentation xml:lang="en">The number of options which represent the portion of the Old Contract being novated.</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element name="remainingNumberOfUnits" type="xsd:decimal" minOccurs="0">
          <xsd:annotation>
            <xsd:documentation xml:lang="en">The number of options which represent the portion of the Old Contract not being novated.</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:sequence>
    </xsd:choice>
  </xsd:group>
  <xsd:complexType name="TradeNovationContent">
    <xsd:complexContent>
      <xsd:extension base="tns:AbstractPostTradeEvent">
        <xsd:sequence>
          <xsd:element name="newTradeIdentifier" type="tns:PartyTradeIdentifier"/>
          <xsd:group ref="tns:NovationRoles.model">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">The roles of the participants in the novation</xsd:documentation>
            </xsd:annotation>
          </xsd:group>
          <xsd:group ref="tns:NovationDates.model">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">The dates and times associated with the novation event.</xsd:documentation>
            </xsd:annotation>
          </xsd:group>
          <xsd:group ref="tns:NovationAmounts.model">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">The amounts novated and remaining. These are optional in some reporting views because when reporting standalone fee trades this information would be duplicated.</xsd:documentation>
            </xsd:annotation>
          </xsd:group>
          <xsd:element name="payment" type="tns:Payment" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation>Describes a payment made in settlement of the novation.</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
        </xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:complexType name="NovationEvent">
    <xsd:annotation>
      <xsd:documentation>A structure describing a novation.</xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="tns:TradeNovationContent"/>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:element name="novationEvent" type="tns:NovationEvent" substitutionGroup="tns:abstractPostTradeEvent"/>
  <xsd:group name="ClearingRoles.model">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">The roles of the parties involved in the clearing.</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="clearingHouse" type="party:PartyRole" minOccurs="0" maxOccurs="1" />
      <xsd:element name="clearingMember" type="party:PartyRole" minOccurs="0" maxOccurs="1" />
      <xsd:element name="clearedFrom" type="party:PartyRole" minOccurs="0" maxOccurs="1" />
      <xsd:element name="clearedTo" type="party:PartyRole" minOccurs="0" maxOccurs="1" />
    </xsd:sequence>
  </xsd:group>
  <xsd:group name="ClearingDates.model">
    <xsd:sequence>
      <xsd:element name="clearingDate" type="xsd:date" />
    </xsd:sequence>
  </xsd:group>
  <xsd:complexType name="TradeClearingContent">
    <xsd:complexContent>
      <xsd:extension base="tns:AbstractPostTradeEvent">
        <xsd:sequence>
          <xsd:group ref="tns:ClearingRoles.model">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">The roles of the participants in the novation</xsd:documentation>
            </xsd:annotation>
          </xsd:group>
          <xsd:group ref="tns:ClearingDates.model">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">The dates and times associated with the novation event.</xsd:documentation>
            </xsd:annotation>
          </xsd:group>
          <xsd:element name="payment" type="tns:Payment" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation>Describes a payment made in settlement of the novation.</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
        </xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:complexType name="ClearingEvent">
    <xsd:annotation>
      <xsd:documentation>A structure describing a clearing.</xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="tns:TradeClearingContent"/>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:element name="clearingEvent" type="tns:ClearingEvent" substitutionGroup="tns:abstractPostTradeEvent"/>
  <xsd:complexType name="PostTradeEvent">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">
        since 7.1: PostTrade Event creation/update/export
      </xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element ref="tns:tradeIdentifier" minOccurs="1" maxOccurs="1" />
      <xsd:element name="eventName" type="xsd:string" minOccurs="0" maxOccurs="1" />
      <xsd:element ref="tns:abstractPostTradeEvent" minOccurs="0" maxOccurs="1" />
    </xsd:sequence>
    <xsd:attributeGroup ref="common:PersistentEntity.model">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">Since 7.1: persitenceType for import</xsd:documentation>
      </xsd:annotation>
    </xsd:attributeGroup>
    <xsd:attributeGroup ref="tns:CreationUpdateWorkflowEvent.model">
      <xsd:annotation>
        <xsd:documentation>Since 7.1: Workflow Events to apply during creation or update</xsd:documentation>
      </xsd:annotation>
    </xsd:attributeGroup>
  </xsd:complexType>
  <xsd:element name="postTradeEvent" type="tns:PostTradeEvent" />
  <xsd:complexType name="Trade">
    <xsd:annotation>
      <xsd:documentation source="http://www.FpML.org" xml:lang="en">A type defining an FpML trade.</xsd:documentation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">Made the id attribute optional</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element ref="tns:tradeHeader">
        <xsd:annotation>
          <xsd:documentation source="http://www.FpML.org" xml:lang="en">The information on the trade which is not product specific, e.g. trade date.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element ref="tns:product" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">Since 5.3 : Made this element optional to ease trade updates</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="entityPartyReference" type="party:PartyReference" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">
            Either a link to one of the trade side which
            can be considered as the trade side of the entity, or a link to a Party defining the entity, or the identifiers
            of the entity. This is the way the sign of the trade is deducted.
            Since 6.1 : Made this element optional to ease trade updates
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="otherPartyPayment" type="tns:Payment" minOccurs="0" maxOccurs="unbounded">
        <xsd:annotation>
          <xsd:documentation source="http://www.FpML.org" xml:lang="en">Other fees or additional payments associated with the trade, e.g. broker commissions, where one or more of the parties involved are not principal parties involved in the trade.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="detailedFee" type="tns:DetailedFee" minOccurs="0" maxOccurs="unbounded">
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">Advanced Detailed Fees associated with the trade.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element ref="tns:tradeSide" minOccurs="0" maxOccurs="unbounded">
        <xsd:annotation>
          <xsd:documentation source="http://www.FpML.org" xml:lang="en">
            The parties to the Trade are grouped into Trade Sides. Each Trade has at least two sides. Each side is a buyer or receiver of each leg or stream.
          </xsd:documentation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">
            Since 5.3.5 : keep "unbounded" only for XML compatibility but only the first is taken
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="mirroring" type="tns:Mirroring" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">Contains the mirror rule, parent id and the id's of child deals</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="documentation" type="tns:Documentation" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation source ="http://www.FpML.org" xml:lang="en">
            Defines the definitions that govern the document and should include the year and type of definitions referenced, along with any relevant documentation (such as master agreement) and the date it was signed.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="swapTradeAdditionalFields" type="tns:SwapTradeAdditionalFields" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">Additional fields for swap trade.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
    <xsd:attribute name="id" type="xsd:ID" use="optional" />
    <xsd:attribute name="href" type="xsd:IDREF" use="optional" />
    <xsd:attributeGroup ref="common:PersistentEntity.model">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">Since 5.3.3 add persitenceType for import</xsd:documentation>
      </xsd:annotation>
    </xsd:attributeGroup>
    <xsd:attributeGroup ref="tns:CreationUpdateWorkflowEvent.model">
      <xsd:annotation>
        <xsd:documentation>Since 5.3.3: Workflow Events to apply during creation or update</xsd:documentation>
      </xsd:annotation>
    </xsd:attributeGroup>
  </xsd:complexType>
  <xsd:element name="trade" type="tns:Trade" />
  <xsd:complexType name="Trades">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">An unbound list of FPML trades</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element ref="tns:trade" minOccurs="0" maxOccurs="unbounded" />
    </xsd:sequence>
  </xsd:complexType>
  <xsd:element name="trades" type="tns:Trades" />
  <xsd:complexType name="TradeReference">
    <xsd:annotation>
      <xsd:documentation source="http://www.FpML.org" xml:lang="en">
        A list of ids defining a trade (all must match) or
        a link to a Trade defined in the document.
      </xsd:documentation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">
        Made the HRef attribute optional,
        and added the tradeId list
      </xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="tradeId" type="tns:TradeId" maxOccurs="unbounded" minOccurs="0" />
    </xsd:sequence>
    <xsd:attribute name="href" use="optional" />
    <!-- internal -->
    <xsd:attribute name="ID" type="xsd:ID" use="optional">
      <xsd:annotation>
        <xsd:documentation source="http://www.sophis.net" xml:lang="en">Internal, for gxml simplified soap.</xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
  </xsd:complexType>
  <xsd:element name="tradeReference" type="tns:TradeReference" />
  <xsd:complexType name="TradeHeader">
    <xsd:annotation>
      <xsd:documentation source="http://www.FpML.org" xml:lang="en">
        A type defining trade related information
        which is not product specific.
      </xsd:documentation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">
        Transformed the elements into refs
        onto global elements allowing easy derivation
      </xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element ref="tns:tradeIdentifier" minOccurs="0" maxOccurs="unbounded">
        <xsd:annotation>
          <xsd:documentation source="http://www.FpML.org" xml:lang="en">
            The trade reference identifier(s)
            allocated to the trade by the parties involved.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element ref="tns:partyTradeInformation" minOccurs="0" maxOccurs="unbounded">
        <xsd:annotation>
          <xsd:documentation source="http://www.FpML.org" xml:lang="en">
            Additional trade information
            that may be provided by each involved party.
          </xsd:documentation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">
            Since 5.3.5 : keep "unbounded" only for XML compatibility but only the first is taken
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element ref="tns:tradeDate" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation source="http://www.FpML.org" xml:lang="en">The trade date.</xsd:documentation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">
            Since 5.3 : Made this element optional to ease trade updates.
            If not present in creation, the trade is still refused.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element ref="tns:pnLDate" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation source="http://www.FpML.org" xml:lang="en">The pnl date.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="settlementDate" type="xsd:date" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">The delivery date.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="tradeTime" type="xsd:time" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">The trade time.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="paymentDate" type="xsd:date" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">The payment date.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="navDate" type="xsd:date" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">The nav date.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="commissionDate" type="xsd:date" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">The commission date used for maturity modification.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="forceLoad" type="xsd:int" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">update forceLoad in histomvts</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="tags" type="tag:Tags" minOccurs="0" >
        <xsd:annotation>
          <xsd:documentation  source="http://www.sophis.net" xml:lang="en">Since 7.1.0 : contains all tags applied to the instrument </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
    <xsd:attribute name="preventrecomputation" use="optional" type="xsd:boolean" >
      <xsd:annotation>
        <xsd:documentation source="http://www.sophis.net" xml:lang="en">To update trade fields without ticket recomputation set the parameter to true; default is false</xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
    <xsd:attribute name="resetDetailedFees" use="optional" type="xsd:boolean">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">
          Specifies wether to delete or not the existing detailed fees on a trade when no detailed fees specified in the trade XML.
          So it is taken into account only on a trade update and only when no detailed fees are specified in the input XML. Considered false if missing.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
  </xsd:complexType>
  <xsd:element name="tradeHeader" type="tns:TradeHeader" />
  <xsd:complexType name="Payment">
    <xsd:annotation>
      <xsd:documentation source="http://www.FpML.org" xml:lang="en">A type for defining payments</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:group ref="tns:PayerReceiver.model">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">Payer or Reciever model</xsd:documentation>
        </xsd:annotation>
      </xsd:group>
      <xsd:element name="paymentAmount" type="instrument:Money">
        <xsd:annotation>
          <xsd:documentation source="http://www.FpML.org" xml:lang="en">The currency amount of the payment.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="paymentDate" type="common:AdjustableDate" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation source="http://www.FpML.org" xml:lang="en">The payment date. This date is subject to adjustment in accordance with any applicable business day convention.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="adjustedPaymentDate" type="common:IdentifiedDate" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation source="http://www.FpML.org" xml:lang="en">The adjusted payment date. This date should already be adjusted for any applicable business day convention. This component is not intended for use in trade confirmation but my be specified to allow the fee structure to also serve as a cashflow type component (all dates the the Cashflows type are adjusted payment dates).</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
    <xsd:attribute name="paymentTypeScheme" type="xsd:anyURI">
      <xsd:annotation>
        <xsd:documentation source="http://www.FpML.org" xml:lang="en">A classification of the type of fee or additional payment, e.g. brokerage, upfront fee etc. FpML does not define domain values for this element.</xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
  </xsd:complexType>
  <xsd:complexType name="TradeDate">
    <xsd:annotation>
      <xsd:documentation source="http://www.FpML.org" xml:lang="en">The type used to define the trade date for a transaction.</xsd:documentation>
    </xsd:annotation>
    <xsd:simpleContent>
      <xsd:extension base="xsd:date">
        <xsd:attribute name="id" type="xsd:ID" use="optional" />
      </xsd:extension>
    </xsd:simpleContent>
  </xsd:complexType>
  <xsd:element name="tradeDate" type="tns:TradeDate" />
  <xsd:complexType name="PnLDate">
    <xsd:annotation>
      <xsd:documentation source="http://www.FpML.org" xml:lang="en">The type used to define the pnl date for a transaction.</xsd:documentation>
    </xsd:annotation>
    <xsd:simpleContent>
      <xsd:extension base="xsd:date">
        <xsd:attribute name="id" type="xsd:ID" use="optional" />
      </xsd:extension>
    </xsd:simpleContent>
  </xsd:complexType>
  <xsd:element name="pnLDate" type="tns:PnLDate" />
  <xsd:complexType name="IndependentAmount">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">
        Independent Amount is an amount that usually less creditworthy counterparties are asked to provide.
        It can either be a fixed amount or a percentage of the Transaction's value.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:choice>
        <xsd:annotation>
          <xsd:documentation xml:lang="en">Amount or percentage of independent amount</xsd:documentation>
        </xsd:annotation>
        <xsd:element name="amount" type="xsd:double" />
        <xsd:element name="factor" type="xsd:double" />
      </xsd:choice>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:element name="independentAmount" type="tns:IndependentAmount" />
  <xsd:complexType name="Product" abstract="true">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">Abstract type used to define the purpose of the trade. This must be extended for various types of products.</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element ref="tns:independentAmount" minOccurs="0" />
    </xsd:sequence>
  </xsd:complexType>
  <xsd:element name="product" type="tns:Product" />
  <xsd:complexType name="TradeInstrument">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">
        Type defining the instrument being purchased (in a generic trade product)
        This can be either an href pointing to an instrument defined elsewhere or the identifiers of the instrument
      </xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="instrument:Underlyer">
        <xsd:sequence>
          <xsd:choice>
            <xsd:annotation>
              <xsd:documentation xml:lang="en">A security, commodity, or other asset described in a derivative contact.</xsd:documentation>
            </xsd:annotation>
            <xsd:element name="isACfd" type="xsd:boolean" minOccurs="0">
              <xsd:annotation>
                <xsd:documentation source="http://www.sophis.net" xml:lang="en">
                  If this element is set to true, the instrument defined is considered to be
                  the underlyer of a Cfd. The Cfd is built with a template obtained with the Cfd Template Selector with the depositary of the trade, the market and
                  currency of the underlyer. If no template could be found, or if no depositary is defined in the trade, the trade is rejected.
                  Otherwise the template is cloned and its underlyer is set to the instrument pointed to by the TradeInstrument (if it does not already exist in db)
                  and saved with the trade.
                </xsd:documentation>
                <xsd:documentation source="http://www.sophis.net" xml:lang="en">Deprecated in 5.3.2 Use the new choise cfd.</xsd:documentation>
              </xsd:annotation>
            </xsd:element>
            <xsd:element name="contractForDifference" type="tns:ContractForDifference" minOccurs="0">
              <xsd:annotation>
                <xsd:documentation source="http://www.sophis.net" xml:lang="en">Used to specify that the trade is on a contract for difference and allows to specify some characteristics as borrowing costs and funding costs of the trade.</xsd:documentation>
              </xsd:annotation>
            </xsd:element>
          </xsd:choice>
          <xsd:element name="instrumentTypeHint" type="xsd:normalizedString" minOccurs="0" />
        </xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:complexType name="TradeProduct">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">Concrete product denoting to a general purchase or sale of a given sophis instrument.</xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="tns:Product">
        <xsd:sequence>
          <xsd:element name="instrument" type="tns:TradeInstrument" />
          <xsd:element name="securityCollateral" type="tns:SecurityCollateral" minOccurs="0" />
          <xsd:element ref="tns:principalPayment" minOccurs="1" maxOccurs="1" />
        </xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:element name="tradeProduct" type="tns:TradeProduct" substitutionGroup="tns:product" />
  <xsd:simpleType name="SpreadAdjustmentType">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">Must be specified when importing per-position spread/fees adjustment deals, otherwise should be omitted.</xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:normalizedString">
      <xsd:enumeration value="Global" />
      <xsd:enumeration value="RemainingPeriod" />
    </xsd:restriction>
  </xsd:simpleType>
  <xsd:complexType name="BasketTrsProduct">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">
        Product type used to describe specific deals on Basket Total Return Swaps, extends TradeProduct.
        Examples of such specific deals include: initial booking, per-position spread adjustment.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="tns:TradeProduct">
        <xsd:sequence>
          <xsd:element name="spread" type="xsd:double">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">
                Spread for the deal, specified in percent.
              </xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="spreadAdjustmentType" type="tns:SpreadAdjustmentType" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">
                Must be specified when importing per-position spread/fees adjustment deals, otherwise should be omitted.
              </xsd:documentation>
            </xsd:annotation>
          </xsd:element>
        </xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:element name="basketTrsProduct" type="tns:BasketTrsProduct" substitutionGroup="tns:product" />
  <xsd:simpleType name="SwapTransactionType">
    <xsd:restriction base="xsd:normalizedString">
      <xsd:enumeration value="BuyFixedLeg" />
      <xsd:enumeration value="SellFixedLeg" />
    </xsd:restriction>
  </xsd:simpleType>
  <xsd:complexType name="SwapProduct">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">
        Product type used to describe specific deals on Swaps (such as IRS or CDS), extends TradeProduct.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="tns:TradeProduct">
        <xsd:sequence>
          <xsd:element name="swapTransactionType" type="tns:SwapTransactionType" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">The Buy/Sell fixed leg flag for IRS and CDS.</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
        </xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:element name="swapProduct" type="tns:SwapProduct" substitutionGroup="tns:product" />
  <xsd:complexType name="PrincipalPayment">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">
        Type used to define characteristics of the payment of the purchased instrument.
        Basically defines the buyer/seller sides of the trade and a variable element describing the settlement.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:group ref="tns:BuyerSeller.model">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">buyer or seller model</xsd:documentation>
        </xsd:annotation>
      </xsd:group>
      <xsd:element ref="tns:abstractPrincipalSettlement" />
      <xsd:element name="accruedCoupon" type="tns:AccruedCoupon" minOccurs="0" />
      <xsd:group ref="tns:SophisTradeCharacteristics.model">
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">obsolete kept only for compatibility. Use the trade characteristics defined in s instead.</xsd:documentation>
        </xsd:annotation>
      </xsd:group>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:element name="principalPayment" type="tns:PrincipalPayment" />
  <xsd:complexType name="Spot">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">Type used to define the price per product</xsd:documentation>
    </xsd:annotation>
    <xsd:simpleContent>
      <xsd:extension base="xsd:double">
        <xsd:attribute name="type" type="tns:SpotType" use="optional" />
        <xsd:attribute name="srType" type="tns:SRType" use="optional">
          <xsd:annotation>
            <xsd:documentation source="http://www.sophis.net" xml:lang="en">Only meaningful when underlying instrument is an external fund</xsd:documentation>
          </xsd:annotation>
        </xsd:attribute>
        <xsd:attribute name="inSettlementCurrency" type="xsd:boolean" use="optional" default="false">
          <xsd:annotation>
            <xsd:documentation source="http://www.sophis.net" xml:lang="en">Only meaningful if priceType is InAmount or InAmountWithoutAccrued</xsd:documentation>
          </xsd:annotation>
        </xsd:attribute>
      </xsd:extension>
    </xsd:simpleContent>
  </xsd:complexType>
  <xsd:simpleType name="SpotType">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">how the spot value is defined</xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:normalizedString">
      <xsd:enumeration value="InAmount" />
      <xsd:enumeration value="InRate" />
      <xsd:enumeration value="InPercentage" />
      <xsd:enumeration value="InAmountWithoutAccrued">
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">Only meaningful if product may have an accrued coupon</xsd:documentation>
        </xsd:annotation>
      </xsd:enumeration>
      <xsd:enumeration value="InPercentageWithAccrued">
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">Only meaningful if product may have an accrued coupon</xsd:documentation>
        </xsd:annotation>
      </xsd:enumeration>
      <xsd:enumeration value="InAnotherCurrency">
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">
            Only meaningful if spot is in underlying currency and if currency of instrument underlying is
            different from currency of instrument. Used for compo stock loan.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:enumeration>
      <xsd:enumeration value="Uncertain">
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">Only meaningful for forex trades</xsd:documentation>
        </xsd:annotation>
      </xsd:enumeration>
      <xsd:enumeration value="InDiscountMargin">
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">Only meaningful for floating bonds</xsd:documentation>
        </xsd:annotation>
      </xsd:enumeration>
    </xsd:restriction>
  </xsd:simpleType>
  <xsd:simpleType name="SRType">
    <xsd:restriction base="xsd:normalizedString">
      <xsd:enumeration value="NoStatus" />
      <xsd:enumeration value="InQuantity" />
      <xsd:enumeration value="InAmount" />
      <xsd:enumeration value="Validated" />
    </xsd:restriction>
  </xsd:simpleType>
  <xsd:complexType name="Amount">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">net amount of the deal</xsd:documentation>
    </xsd:annotation>
    <xsd:simpleContent>
      <xsd:extension base="xsd:double">
        <xsd:attribute name="negative" type="xsd:boolean" use="optional">
          <xsd:annotation>
            <xsd:documentation source="http://www.sophis.net" xml:lang="en">
              optional ; if not present keeps the old behavior
              if true amount value will be negative (except if the value is already negative : it will become positive)
            </xsd:documentation>
          </xsd:annotation>
        </xsd:attribute>
      </xsd:extension>
    </xsd:simpleContent>
  </xsd:complexType>
  <xsd:complexType name="SettlementAmount">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">
        Type used to define the amount of the principal payment
        of a trade. This type is different from the type instrument:Money generally used for describing amount in several aspects:
        It is possible here the define a forex rate used between the payment currency and the currency of the product, which is required
        if they are different, but prohibited if they are the same.
        Note: The amount represents here the net amount (which can be calculated as the price per product * spot).
        Note: The gross amount, is defined as an otherPartyPayment and not a principalPayment, since it includes the various fees.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="currency" type="instrument:Currency" />
      <xsd:element name="amount" type="tns:Amount" minOccurs="0" />
      <xsd:element name="forex" type="xsd:double" minOccurs="0" />
      <xsd:element name="certainty" type="tns:Certainty" minOccurs="0" />
    </xsd:sequence>
  </xsd:complexType>
  <xsd:simpleType name="Certainty">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">Forex order between the currency and the reference currency from the deal.</xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:normalizedString">
      <xsd:enumeration value="Certain" />
      <xsd:enumeration value="Uncertain" />
    </xsd:restriction>
  </xsd:simpleType>
  <xsd:complexType name="AccruedCoupon">
    <xsd:annotation>
      <xsd:documentation source="http://www.FpML.org" xml:lang="en">Accrued interest on the dividend or coupon payment. When the TRS is structured to pay a dividend or coupon on reset after payable date, you may earn interest on these amounts. This field indicates the interest accrued on dividend/coupon from pay date to statement date. This will only apply to a handful of agreements where dividendss are held to the next reset AND you receive/pay interest on unpaid amounts.</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="date" type="common:AdjustableDate" minOccurs="0" />
      <xsd:element name="rate" type="xsd:double" minOccurs="0" />
      <xsd:element name="entitlementDate" type="xsd:date" minOccurs="0" />
      <xsd:element name="payingAmount" type="xsd:double" minOccurs="0" />
      <xsd:element name="receivingAmount" type="xsd:double" minOccurs="0" />
      <xsd:element name="payingAmount2" type="xsd:double" minOccurs="0" />
      <xsd:element name="receivingAmount2" type="xsd:double" minOccurs="0" />
    </xsd:sequence>
  </xsd:complexType>
  <xsd:group name="NumOrNotional">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">Number of securities or Notional </xsd:documentation>
    </xsd:annotation>
    <xsd:choice>
      <xsd:annotation>
        <xsd:documentation xml:lang="en">Number of securities or Notional </xsd:documentation>
      </xsd:annotation>
      <xsd:element name="numberOfSecurities" type="xsd:double" />
      <xsd:element name="notional" type="xsd:double" />
    </xsd:choice>
  </xsd:group>
  <xsd:complexType name="AbstractPrincipalSettlement" abstract="true">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">Abstract type used to define the amount of product purchased. Made abstract so that it may be derived for various kind of products.</xsd:documentation>
    </xsd:annotation>
  </xsd:complexType>
  <xsd:element name="abstractPrincipalSettlement" type="tns:AbstractPrincipalSettlement" />
  <xsd:complexType name="PrincipalSettlement">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">Concrete description of the quantity of product purchased (in number of notional).</xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="tns:AbstractPrincipalSettlement">
        <xsd:sequence>
          <!--<xsd:group ref="tns:NumOrNotional"/>-->
          <xsd:element name="numberOfSecurities" type="xsd:double" minOccurs="0" >
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">
                Before the group NumOrNotional but this causes troubles to dot net binding.
                Warning : Only numberOfSecurities or notional should be set in an imported trade;
                If both are set, notional only will be taken into account
              </xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="notional" type="xsd:double" minOccurs="0" >
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">
                Before the group NumOrNotional but this causes troubles to dot net binding.
                Warning : Only numberOfSecurities or notional should be set in an imported trade;
                If both are set, notional only will be taken into account
              </xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="floatingNotional" type="xsd:double" minOccurs="0" />
          <xsd:element name="poolFactor" type="xsd:double" minOccurs="0" />
          <xsd:element name="indexRatio" type="xsd:double" minOccurs="0" />
          <xsd:element name="spot" type="tns:Spot" minOccurs="1" />
          <xsd:element name="tradeYtm" type="xsd:double" minOccurs="0" />
          <xsd:element name="paymentMethod" type="xsd:normalizedString" minOccurs="0" />
          <xsd:element name="SMDT" type="xsd:normalizedString" minOccurs="0" />
          <xsd:element name="amount" type="tns:SettlementAmount" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">
                result of the calculation of quantity multiplied by the spot,
                Expressed in the payment currency.
              </xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="grossAmount" type="tns:SettlementAmount" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">
                Net Amount minus the fees
              </xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <!-- Normal trade needs all four accounts-->
          <xsd:element name="nostroCash" type="ssi:SSI" minOccurs="0" />
          <xsd:element name="nostroSecurity" type="ssi:SSI" minOccurs="0" />
          <xsd:element name="lostroCash" type="ssi:SSI" minOccurs="0" />
          <xsd:element name="lostroSecurity" type="ssi:SSI" minOccurs="0" />
          <xsd:element name="valueDate" type="common:AdjustableDate" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">
                Deprecated. Use of paymentDate in the tradeHeader is preferred. When both are specified on import, the valueDate is used.
              </xsd:documentation>
            </xsd:annotation>
          </xsd:element>
        </xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:element name="principalSettlement" type="tns:PrincipalSettlement" substitutionGroup="tns:abstractPrincipalSettlement" />
  <xsd:complexType name="BasketSettlement">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">Concrete description of the quantity of product purchased, when it is about basket trades.</xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="tns:AbstractPrincipalSettlement">
        <xsd:sequence>
          <xsd:element name="numberOfSecurities" type="xsd:double" />
        </xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:element name="basketSettlement" type="tns:BasketSettlement" substitutionGroup="tns:abstractPrincipalSettlement" />
  <xsd:complexType name="TradeId">
    <xsd:annotation>
      <xsd:documentation source="http://www.FpML.org" xml:lang="en">A trade reference identifier allocated by a party. FpML does not define the domain values associated with this element. Note that the domain values for this element are not strictly an enumerated list.</xsd:documentation>
    </xsd:annotation>
    <xsd:simpleContent>
      <xsd:extension base="xsd:normalizedString">
        <xsd:attribute name="tradeIdScheme" type="xsd:anyURI" use="required" />
        <xsd:attribute name="search" type="xsd:boolean" use="optional" default="true" />
        <xsd:attribute name="update" type="xsd:boolean" use="optional" default="true" />
      </xsd:extension>
    </xsd:simpleContent>
  </xsd:complexType>
  <xsd:complexType name="TradeIdentifier">
    <xsd:annotation>
      <xsd:documentation source="http://www.FpML.org" xml:lang="en">A type defining a trade identifier issued by the indicated party.</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element ref="party:partyReference" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation source="http://www.FpML.org" xml:lang="en">The party referenced has allocated the trade identifier.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="tradeId" type="tns:TradeId" minOccurs="0" maxOccurs="unbounded" />
    </xsd:sequence>
  </xsd:complexType>
  <xsd:element name="tradeIdentifier" type="tns:TradeIdentifier" />
  <xsd:complexType name="PartyTradeIdentifier">
    <xsd:annotation>
      <xsd:documentation source="http://www.FpML.org" xml:lang="en">A type defining one or more trade identifiers allocated to the trade by a party. A link identifier allows the trade to be associated with other related trades, e.g. trades forming part of a larger structured transaction. It is expected that for external communication of trade there will be only one tradeId sent in the document per party.</xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="tns:TradeIdentifier">
        <xsd:sequence>
          <xsd:element name="linkId" type="tns:LinkId" minOccurs="0" maxOccurs="unbounded">
            <xsd:annotation>
              <xsd:documentation source="http://www.FpML.org" xml:lang="en">A link identifier allowing the trade to be associated with other related trades, e.g. the linkId may contain a tradeId for an associated trade or several related trades may be given the same linkId. FpML does not define the domain values associated with this element. Note that the domain values for this element are not strictly an enumerated list.</xsd:documentation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">
                If a position link is given (scheme http://www.sophis.net/trade/linkId/positionId or http://www.sophis.net/trade/linkId/operation) the trade will be bound to this position.
                If the position doesn't exist, it will be created.
              </xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="allocationTradeId" type="tns:TradeIdentifier" minOccurs="0" maxOccurs="unbounded">
            <xsd:annotation>
              <xsd:documentation source="http://www.FpML.org" xml:lang="en">The trade id of the allocated trade. This is used by the block trade to reference the allocated trade.</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="blockTradeId" type="tns:TradeIdentifier" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation source="http://www.FpML.org" xml:lang="en">The trade id of the block trade. This is used by each one of the allocated trades to reference the block trade. This element can also represent the trade id of the parent trade for N-level allocations. In the case, this element is only used to model N-level allocations in which the trade acts as block and allocated trade at the same time. This basically means the ability to allocate a block trade to multiple allocation trades, and then allocate these in turn to other allocation trades (and so on if desired).</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
        </xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:element name="partyTradeIdentifier" type="tns:PartyTradeIdentifier" substitutionGroup="tns:tradeIdentifier" />
  <xsd:complexType name="LinkId">
    <xsd:annotation>
      <xsd:documentation source="http://www.FpML.org" xml:lang="en">The data type used for link identifiers.</xsd:documentation>
    </xsd:annotation>
    <xsd:simpleContent>
      <xsd:extension base="xsd:normalizedString">
        <xsd:attribute name="id" type="xsd:ID" use="optional" />
        <xsd:attribute name="linkIdScheme" type="xsd:anyURI" use="required" />
      </xsd:extension>
    </xsd:simpleContent>
  </xsd:complexType>
  <xsd:complexType name="PositionIdentifier">
    <xsd:annotation>
      <xsd:documentation source="http://www.FpML.org" xml:lang="en">A type defining one or more trade identifiers allocated to the trade by a party. A link identifier allows the trade to be associated with other related trades, e.g. trades forming part of a larger structured transaction. It is expected that for external communication of trade there will be only one tradeId sent in the document per party.</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element ref="party:partyReference" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation source="http://www.FpML.org" xml:lang="en">The party referenced has allocated the trade identifier.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="linkId" type="tns:LinkId" minOccurs="0" maxOccurs="unbounded">
        <xsd:annotation>
          <xsd:documentation source="http://www.FpML.org" xml:lang="en">A link identifier allowing the trade to be associated with other related trades, e.g. the linkId may contain a tradeId for an associated trade or several related trades may be given the same linkId. FpML does not define the domain values associated with this element. Note that the domain values for this element are not strictly an enumerated list.</xsd:documentation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">
            If a position link is given (scheme http://www.sophis.net/trade/linkId/positionId or http://www.sophis.net/trade/linkId/operation) the trade will be bound to this position.
            If the position doesn't exist, it will be created.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:element name="positionIdentifier" type="tns:PositionIdentifier"/>
  <xsd:complexType name="PartyTradeIdentifiers">
    <xsd:annotation>
      <xsd:documentation source="http://www.FpML.org" xml:lang="en">A type containing multiple partyTradeIdentifier.</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element ref="tns:partyTradeIdentifier" maxOccurs="unbounded" />
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="Trader">
    <xsd:annotation>
      <xsd:documentation source="http://www.FpML.org" xml:lang="en">Identifies the person or persons who assumed the role of trader for this trade.</xsd:documentation>
    </xsd:annotation>
    <xsd:simpleContent>
      <xsd:extension base="xsd:normalizedString">
        <xsd:attribute name="traderScheme" type="xsd:anyURI" use="optional" />
      </xsd:extension>
    </xsd:simpleContent>
  </xsd:complexType>
  <xsd:complexType name="UserComment">
    <xsd:sequence>
      <xsd:choice minOccurs="0" maxOccurs="1">
        <xsd:element name="positionIdentifier" type="tns:PositionIdentifier" />
        <xsd:element ref="tns:tradeIdentifier"/>
      </xsd:choice>
      <xsd:element name="user" type="tns:Trader" minOccurs="0" maxOccurs="unbounded" />
      <xsd:element name="dateTime" type="xsd:dateTime" minOccurs="0" />
      <xsd:element name="comment" type="xsd:string" />
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="TradeSide">
    <xsd:annotation>
      <xsd:documentation source="http://www.FpML.org" xml:lang="en">The parties to the trade form into sides. Each side has defined roles in the lifecyle of the trade fulfilled by parties. Each party role is given in the likely order they would be filled during the lifecycle of a trade.</xsd:documentation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">
        Made the attribute id optional as well as the element
        creditor.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:annotation>
        <xsd:documentation source="http://www.FpML.org" xml:lang="en">Agency relations occur when one Party undertakes one role and another undertakes a different role. For example a Fund would be Beneficiary, use a Fund Manager as Orderer, use a trading firm as Introducer, and a broker as Executor, but give up Clearing to their prime broker. All roles always exist. An absent element means the role isn't stated.</xsd:documentation>
      </xsd:annotation>
      <xsd:element name="orderer" type="party:PartyRole" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation source="http://www.FpML.org" xml:lang="en">The Party placing the order. This could be a fund manager acting on behalf of a client, or a hedge fund acting on it's own behalf. This is the role with the investment discretion.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="introducer" type="party:PartyRole" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation source="http://www.FpML.org" xml:lang="en">Party that can relay an order directly to the trading floor at a firm. This is potentially a different firm, but may be the same as that taking the order. In effect the introducer is the first dealer to take the order. The reason an introducing dealer may forward a trade is sometime because it doesn't have the capacity to execute effectively but does have the relationship with the Orderer. Introducing Party is an industry standard term. This is semantically equivalent to the FIX and ISO20022 Introducing Firm.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="executor" type="party:PartyRole" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation source="http://www.FpML.org" xml:lang="en">The Party executing or striking the trade. Executing Party is an industry standard term. This is semantically equivalent to the FIX and ISO20022 Executing Firm or Trader.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="confirmer" type="party:PartyRole" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation source="http://www.FpML.org" xml:lang="en">The party that undertakes the confirmation process for this Trade Side. The confirmer essentially manages the matching and affirmation of trades. This is often the creditor or is increasingly outsourced to service providers such as Swapswire.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="creditor" type="party:PartyRole" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation source="http://www.FpML.org" xml:lang="en">The party whose name appears on the contract as being responsible for credit of the trade. This is the party in the Trade Side the credit risk is against. For example if a hedge fund was to trade in the name of it's prime broker, then the prime broker would be the creditor.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="calculater" type="party:PartyRole" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation source="http://www.FpML.org" xml:lang="en">The calculater is the Party that calculates, negotiates, and agrees the values to be paid at each payment date.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="settler" type="party:PartyRole" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation source="http://www.FpML.org" xml:lang="en">The Settler is the party that makes the payments. Increasingly this is a service that can be externalized from the other roles. An example of a settlement service provide is SwapClear.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="beneficiary" type="party:PartyRole" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation source="http://www.FpML.org" xml:lang="en">The party that suffers the economic effect of the trade. This is usually referred to as the primary Principal in FIX and ISO20022 - which is slightly confusing in that there are potentially many Princiapal/Agency relationships. The beneficiary may be distinct from the creditor - an example is a Hedge Fund trading in the name of it's Prime Broker.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="accountant" type="party:PartyRole" minOccurs="0" maxOccurs="unbounded">
        <xsd:annotation>
          <xsd:documentation source="http://www.FpML.org" xml:lang="en">The Accountants for the trade. There are potentially many accountants. This is known in FIX and ISO20022  for Collective Investment Vehicles as the Third Party Administrator (TPA), however all trades for all parties have at least one party accounting for the trade.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
    <xsd:attribute name="id" type="xsd:ID" use="optional" />
  </xsd:complexType>
  <xsd:element name="tradeSide" type="tns:TradeSide" />
  <xsd:complexType name="ExtendedTradeSide">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">Additions to the primary roles definitions</xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="tns:TradeSide">
        <xsd:sequence>
          <xsd:element name="entity" type="party:PartyRole" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation source="http://www.FpML.org" xml:lang="en">
                If not defined takes
                (in the order of precedence):
                orderer
              </xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="counterparty" type="party:PartyRole" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation source="http://www.FpML.org" xml:lang="en">
                If not defined takes
                (in the order of precedence):
                orderer of the other side
              </xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="secondCounterparty" type="party:PartyRole" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">Since 5.3.3 ; used only if business event needs a second counterparty</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="depositary" type="party:PartyRole" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation source="http://www.FpML.org" xml:lang="en">
                If not defined takes
                (in the order of precedence):
                creditor
                settler
              </xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="broker" type="party:PartyRole" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation source="http://www.FpML.org" xml:lang="en">
                If not defined takes
                (in the order of precedence):
                introducer
                executor
              </xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:choice minOccurs="0">
            <xsd:element name="counterpartyDepositary" type="party:PartyRole">
              <xsd:annotation>
                <xsd:documentation source="http://www.FpML.org" xml:lang="en">Since 5.3.2 depositary of the counterparty</xsd:documentation>
              </xsd:annotation>
            </xsd:element>
            <xsd:element name="depositary2" type="party:PartyRole">
              <xsd:annotation>
                <xsd:documentation source="http://www.FpML.org" xml:lang="en">For forex trade : depositary for currency2</xsd:documentation>
              </xsd:annotation>
            </xsd:element>
          </xsd:choice>
          <xsd:element name="storagePlace" type="xsd:int" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">
                If not defined takes
                (in the order of precedence):
                orderer of the other side
              </xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="clearingHouse" type="party:PartyRole" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation source="http://www.FpML.org" xml:lang="en">Since 7.1 Clearing House</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="clearingMember" type="party:PartyRole" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation source="http://www.FpML.org" xml:lang="en">Since 7.1 Clearing Member</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="reportingParty" type="party:PartyRole" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation source="http://www.FpML.org" xml:lang="en">Dodd Frank Regulation Reporting Party</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="executionVenue" type="party:PartyRole" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation source="http://www.FpML.org" xml:lang="en">Dodd Frank Regulation Execution Venue</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="tradeRepositary" type="party:PartyRole" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation source="http://www.FpML.org" xml:lang="en">Dodd Frank Regulation Trade Repositary</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="otherTradeRepositary" type="party:PartyRole" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation source="http://www.FpML.org" xml:lang="en">Dodd Frank Regulation Other Trade Repositary</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="clearingExceptionParty" type="party:PartyRole" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation source="http://www.FpML.org" xml:lang="en">Dodd Frank Regulation Clearing Exception Party</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="jurisdiction" type="xsd:string" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">counterparty|entity jurisdiction</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
        </xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:element name="extendedTradeSide" type="tns:ExtendedTradeSide" substitutionGroup="tns:tradeSide" />
  <xsd:complexType name="PartyTradeInformation">
    <xsd:annotation>
      <xsd:documentation source="http://www.FpML.org" xml:lang="en">
        A type defining additional information
        that may be recorded against a trade.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="partyReference" type="party:PartyReference" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation source="http://www.FpML.org" xml:lang="en">
            Identifies that party that has
            ownership of this information.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="decisionMaker" type="tns:Trader" minOccurs="0" maxOccurs="unbounded">
        <xsd:annotation>
          <xsd:documentation source="http://www.FpML.org" xml:lang="en">
            Identifies the person or persons
            who assumed the role of decision maker for this trade.
          </xsd:documentation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">
            It is populated automatically by OMS, or manually if there is no OMS.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="trader" type="tns:Trader" minOccurs="0" maxOccurs="unbounded">
        <xsd:annotation>
          <xsd:documentation source="http://www.FpML.org" xml:lang="en">
            Identifies the person or persons
            who assumed the role of trader for this trade.
          </xsd:documentation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">
            Only the first Trader is taken
            into account for the Operator of the trade.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:group ref="tns:SophisTradeCharacteristics.model">
        <xsd:annotation>
          <xsd:documentation xml:lang="en"></xsd:documentation>
        </xsd:annotation>
      </xsd:group>
      <xsd:element name="intentToClear" type="xsd:boolean" minOccurs="0"></xsd:element>
      <xsd:element name="largeSizeTrade" type="xsd:boolean" minOccurs="0"></xsd:element>
      <xsd:element name="executionType" type="tns:ExecutionType" minOccurs="0"></xsd:element>
      <xsd:element name="executionVenueType" type="xsd:string" minOccurs="0"></xsd:element>
      <xsd:element name="originatingEvent" type="tns:OriginatingEvent" minOccurs="0"></xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:element name="partyTradeInformation" type="tns:PartyTradeInformation" />
  <xsd:complexType name="ExtendedPartyTradeInformation">
    <xsd:annotation>
      <xsd:documentation source="http://www.Sophis.net" xml:lang="en">
        Additions to the identifying information of the party that has
        ownership of this information.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="tns:PartyTradeInformation">
        <xsd:sequence>
          <xsd:element name="extraFields" type="common:ExtraFields" minOccurs="0" />
        </xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:element name="extendedPartyTradeInformation" type="tns:ExtendedPartyTradeInformation" substitutionGroup="tns:partyTradeInformation" />
  <xsd:simpleType name="Origin">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">The origin transfer method.</xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:normalizedString">
      <xsd:enumeration value="Manual" />
      <xsd:enumeration value="Automatic" />
      <xsd:enumeration value="Electronic" />
    </xsd:restriction>
  </xsd:simpleType>
  <xsd:complexType name="AllocationRule">
    <xsd:annotation>
      <xsd:documentation source="http://www.FpML.org" xml:lang="en">
        A generic portfolio allocation rule type.
        This can be extended to provide specialization of allocation rule.
      </xsd:documentation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">That is in which folio the trade is aimed to.</xsd:documentation>
    </xsd:annotation>
  </xsd:complexType>
  <xsd:element name="allocationRule" type="tns:AllocationRule" />
  <xsd:complexType name="AccountAllocationRule">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">The destination folio is resolved by finding the entry in table 'compte_back' matching .</xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="tns:AllocationRule">
        <xsd:sequence>
          <xsd:element name="account" type="xsd:normalizedString" />
        </xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:element name="accountAllocationRule" type="tns:AccountAllocationRule" substitutionGroup="tns:allocationRule" />
  <xsd:complexType name="FundStrategyAllocationRule">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">Not implemented, reserved for future use. field is ignored.</xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="tns:AllocationRule">
        <xsd:sequence>
          <xsd:element name="tradeAllocationRule" type="xsd:normalizedString" />
        </xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:element name="fundStrategyAllocationRule" type="tns:FundStrategyAllocationRule" substitutionGroup="tns:allocationRule" />
  <!-- groups -->
  <xsd:group name="BuyerSeller.model">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">Define whether buy or sell</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="buyerPartyReference" type="party:PartyReference" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation source="http://www.FpML.org" xml:lang="en">
            A reference to the party that buys this
            instrument, ie. pays for this instrument and receives the rights defined by it. See 2000 ISDA
            definitions Article 11.1 (b). In the case of FRAs this the fixed rate payer.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="sellerPartyReference" type="party:PartyReference" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation source="http://www.FpML.org" xml:lang="en">
            A reference to the party that sells ("writes")
            this instrument, i.e. that grants the rights defined by this instrument and in return receives a payment
            for it. See 2000 ISDA definitions Article 11.1 (a).
            In the case of FRAs this is the floating rate payer.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:group>
  <xsd:group name="PayerReceiver.model">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">define whether payer or receiver</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="payerPartyReference" type="party:PartyReference">
        <xsd:annotation>
          <xsd:documentation source="http://www.FpML.org" xml:lang="en">
            A reference to the party responsible for
            making the payments defined by this structure.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="receiverPartyReference" type="party:PartyReference">
        <xsd:annotation>
          <xsd:documentation source="http://www.FpML.org" xml:lang="en">
            A reference to the party that receives
            the payments corresponding to this structure.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:group>
  <xsd:complexType name="UserComments">
    <xsd:annotation>
      <xsd:documentation xml:lang="en"></xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="userComment" type="tns:UserComment" maxOccurs="unbounded"/>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:group name="SophisTradeCharacteristics.model">
    <xsd:annotation>
      <xsd:documentation xml:lang="en"></xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element ref="tns:allocationRule" minOccurs="0" maxOccurs="1" />
      <xsd:element name="businessEventId" type="xsd:int" minOccurs="0" maxOccurs="1"/>
      <xsd:element name="businessEvent" type="xsd:normalizedString" minOccurs="0" />
      <xsd:element name="origin" type="tns:Origin" minOccurs="0" default="Manual" />
      <xsd:element name="comment" type="xsd:string" minOccurs="0" />
      <xsd:element name="boComment" type="xsd:string" minOccurs="0" />
      <xsd:element name="userComments" type="tns:UserComments" minOccurs="0" />
      <xsd:element name="backofficeStatus" type="xsd:normalizedString" default="No Status" minOccurs="0" />
      <xsd:element name="backofficeStatusGroups" type="tns:KernelStatusGroups" minOccurs="0" maxOccurs="1" />
    </xsd:sequence>
  </xsd:group>
  <!-- Listed options -->
  <xsd:simpleType name="ListedOptionType">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">
        Describes the type of option.
        Possible values: Call or Put
      </xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:string">
      <xsd:enumeration value="Call"></xsd:enumeration>
      <xsd:enumeration value="Put"></xsd:enumeration>
    </xsd:restriction>
  </xsd:simpleType>
  <xsd:simpleType name="ExecutionType">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">POPULATE HERE DEPENDING ON DROP DOWN "Verification"</xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:string">
      <xsd:enumeration value="Electronic"></xsd:enumeration>
      <xsd:enumeration value="Written"></xsd:enumeration>
      <xsd:enumeration value="Voice"></xsd:enumeration>
    </xsd:restriction>
  </xsd:simpleType>
  <xsd:simpleType name="OriginatingEvent">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">depends if compression is ticked</xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:string">
      <xsd:enumeration value="Trade"></xsd:enumeration>
      <xsd:enumeration value="PortfolioCompression"></xsd:enumeration>
    </xsd:restriction>
  </xsd:simpleType>
  <xsd:simpleType name="SourceType">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">
        Describes the type of the
        source for an option. Possible values: Bellfox or Other
      </xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:string">
      <xsd:enumeration value="Bellfox"></xsd:enumeration>
      <xsd:enumeration value="Other"></xsd:enumeration>
    </xsd:restriction>
  </xsd:simpleType>
  <xsd:simpleType name="ExerciseType">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">
        Describes exercise type for an
        option. Possible values: European, American or Bermuda
      </xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:string">
      <xsd:enumeration value="European"></xsd:enumeration>
      <xsd:enumeration value="American"></xsd:enumeration>
      <xsd:enumeration value="Bermuda"></xsd:enumeration>
    </xsd:restriction>
  </xsd:simpleType>
  <xsd:complexType name="ExternalListedMarketRef">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">The reference of the external listed market</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="externalRef" type="xsd:string" />
      <xsd:element name="transcodColumn" type="xsd:string" />
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="ListedMarketRef">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">The reference of the listed markets</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:choice maxOccurs="unbounded">
        <xsd:annotation>
          <xsd:documentation xml:lang="en"></xsd:documentation>
        </xsd:annotation>
        <xsd:element name="sophisCode" type="xsd:int" />
        <xsd:element name="externalListedMarketRef" type="tns:ExternalListedMarketRef" maxOccurs="unbounded" />
      </xsd:choice>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="StandardOption">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">Type describing the standard parameters of an option.</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="underlyer" type="instrument:Underlyer" />
      <xsd:element name="listedMarketRef" type="tns:ListedMarketRef"></xsd:element>
    </xsd:sequence>
    <xsd:attribute name="maturity" type="xsd:date" use="required"></xsd:attribute>
    <xsd:attribute name="strike" type="xsd:double" use="required"></xsd:attribute>
    <xsd:attribute name="type" type="tns:ListedOptionType" use="required"></xsd:attribute>
    <xsd:attribute name="source" type="tns:SourceType" use="optional" default="Other"></xsd:attribute>
    <xsd:attribute name="exercise" type="tns:ExerciseType" use="optional" default="European"></xsd:attribute>
    <xsd:attribute name="quota" type="xsd:double" use="optional">
      <xsd:annotation>
        <xsd:documentation source="http://www.sophis.net" xml:lang="en">
          Deprecated. Not parsed anymore. Only kept for xml backward compatibility.
        </xsd:documentation>
      </xsd:annotation>
    </xsd:attribute>
    <xsd:attribute name="series" type="xsd:string" use="optional"></xsd:attribute>
    <xsd:attribute name="seriesVersion" type="xsd:int" use="optional"></xsd:attribute>
  </xsd:complexType>
  <xsd:complexType name="KernelStatusGroup">
    <xsd:sequence>
      <xsd:element name="groupName" type="xsd:string" />
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="KernelStatusGroups">
    <xsd:sequence>
      <xsd:element name="statusGroup" type="tns:KernelStatusGroup" minOccurs="0" maxOccurs="unbounded" />
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="WithSupport">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">
        Deprecated. Not parsed anymore. Only kept for xml backward compatibility.
        Type describing the support and others parameters of an option.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:attribute name="supportReference" type="xsd:normalizedString" use="required" />
    <xsd:attribute name="maturity" type="xsd:date" use="required"></xsd:attribute>
    <xsd:attribute name="strike" type="xsd:double" use="required"></xsd:attribute>
    <xsd:attribute name="type" type="tns:ListedOptionType" use="required"></xsd:attribute>
    <xsd:attribute name="source" type="tns:SourceType" use="optional" default="Other"></xsd:attribute>
  </xsd:complexType>
  <xsd:complexType name="ListedOptionInstrument">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">
        Type defining properties for how to find or create a listed option.
        This allows applying more than one strategy, in the specified order.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="instrument:Underlyer">
        <xsd:sequence>
          <xsd:choice minOccurs="0" maxOccurs="unbounded">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">A security, commodity, or other asset described in a derivative contact.</xsd:documentation>
            </xsd:annotation>
            <xsd:element name="standardOption" type="tns:StandardOption">
              <xsd:annotation>
                <xsd:documentation source="http://www.sophis.net" xml:lang="en">
                  Provides the standard elements for finding or creating a listed option
                </xsd:documentation>
              </xsd:annotation>
            </xsd:element>
            <xsd:element name="withSupport" type="tns:WithSupport">
              <xsd:annotation>
                <xsd:documentation source="http://www.sophis.net" xml:lang="en">
                  Deprecated. Not parsed anymore. Only kept for xml backward compatibility.
                  Provides the support for finding or creating a listed option
                </xsd:documentation>
              </xsd:annotation>
            </xsd:element>
            <xsd:element name="optionDynamicReference" type="xsd:normalizedString">
              <xsd:annotation>
                <xsd:documentation source="http://www.sophis.net" xml:lang="en">
                  Deprecated. Not parsed anymore. Only kept for xml backward compatibility.
                  Provides the option reference from the external system
                </xsd:documentation>
              </xsd:annotation>
            </xsd:element>
            <xsd:element name="optionUniversalReference" type="instrument:Underlyer">
              <xsd:annotation>
                <xsd:documentation source="http://www.sophis.net" xml:lang="en">
                  Provides the instrument universal reference. If not existing, the listed option is
                  not created.
                </xsd:documentation>
              </xsd:annotation>
            </xsd:element>
          </xsd:choice>
        </xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:complexType name="ListedOptionProduct">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">A type that represents a Sophis listed option.</xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="tns:Product">
        <xsd:sequence>
          <xsd:element name="listedOptionInstrument" type="tns:ListedOptionInstrument" minOccurs="1" maxOccurs="1" />
          <xsd:element ref="tns:principalPayment" minOccurs="1" maxOccurs="1" />
        </xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:element name="listedOptionProduct" type="tns:ListedOptionProduct" substitutionGroup="tns:product" />
  <xsd:complexType name="StandardFuture">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">Type describing the standard parameters to find an a future.</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="underlyer" type="instrument:Underlyer" />
    </xsd:sequence>
    <xsd:attribute name="maturity" type="xsd:date" use="required"></xsd:attribute>
    <xsd:attribute name="source" type="tns:SourceType" use="optional" default="Other"></xsd:attribute>
  </xsd:complexType>
  <xsd:complexType name="FutureInstrument">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">
        Type defining properties for how to find a future.
        This allows applying more than one strategy, in the specified order.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="instrument:Underlyer">
        <xsd:sequence>
          <xsd:choice minOccurs="0" maxOccurs="unbounded">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">A security, commodity, or other asset described in a derivative contact.</xsd:documentation>
            </xsd:annotation>
            <xsd:element name="standardFuture" type="tns:StandardFuture">
              <xsd:annotation>
                <xsd:documentation source="http://www.sophis.net" xml:lang="en">
                  Provides the standard elements for finding a future.
                  Unlike the listed options, the futures are not created on the fly if not existing.
                </xsd:documentation>
              </xsd:annotation>
            </xsd:element>
            <xsd:element name="futureUniversalReference" type="instrument:Underlyer">
              <xsd:annotation>
                <xsd:documentation source="http://www.sophis.net" xml:lang="en">Provides the instrument universal reference.</xsd:documentation>
              </xsd:annotation>
            </xsd:element>
          </xsd:choice>
        </xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:complexType name="FutureProduct">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">A type that represents a Sophis future.</xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="tns:Product">
        <xsd:sequence>
          <xsd:element name="futureInstrument" type="tns:FutureInstrument" minOccurs="1" maxOccurs="1" />
          <xsd:element ref="tns:principalPayment" minOccurs="1" maxOccurs="1" />
        </xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:element name="futureProduct" type="tns:FutureProduct" substitutionGroup="tns:product" />
  <xsd:complexType name="TradeQuotedCurrencyPair">
    <xsd:annotation>
      <xsd:documentation source="http://www.FpML.org" xml:lang="en">A type that describes the composition of a rate that has been quoted or is to be quoted. This includes the two currencies and the quotation relationship between the two currencies and is used as a building block throughout the FX specification.</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="currency1" type="instrument:Currency">
        <xsd:annotation>
          <xsd:documentation source="http://www.FpML.org" xml:lang="en">The first currency specified when a pair of currencies is to be evaluated.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="currency2" type="instrument:Currency">
        <xsd:annotation>
          <xsd:documentation source="http://www.FpML.org" xml:lang="en">The second currency specified when a pair of currencies is to be evaluated.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="quoteBasis" type="instrument:QuoteBasisEnum">
        <xsd:annotation>
          <xsd:documentation source="http://www.FpML.org" xml:lang="en">The method by which the exchange rate is quoted.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="TradeFxRate">
    <xsd:annotation>
      <xsd:documentation source="http://www.FpML.org" xml:lang="en">A type describing the rate of a currency conversion: pair of currency, quotation mode and exchange rate.</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="quotedCurrencyPair" type="tns:TradeQuotedCurrencyPair">
        <xsd:annotation>
          <xsd:documentation source="http://www.FpML.org" xml:lang="en">Defines the two currencies for an FX trade and the quotation relationship between the two currencies.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="rate" type="xsd:decimal">
        <xsd:annotation>
          <xsd:documentation source="http://www.FpML.org" xml:lang="en">The rate of exchange between the two currencies of the leg of a deal. Must be specified with a quote basis.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="FXLegBuySellInfo">
    <xsd:annotation>
      <xsd:documentation source="http://www.FpML.org" xml:lang="en">A type describing which currency is bought and which currency is sold by the leg</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="Buy" type="instrument:Currency"/>
      <xsd:element name="Sell" type="instrument:Currency"/>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="FxLeg">
    <xsd:annotation>
      <xsd:documentation source="http://www.FpML.org" xml:lang="en">A type that represents a single exchange of one currency for another.</xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="tns:Product">
        <xsd:sequence>
          <xsd:element name="exchangedCurrency1" type="tns:Payment">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">This is the first of the two currency flows that define a single leg of a standard foreign exchange transaction.</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:choice>
            <xsd:annotation>
              <xsd:documentation xml:lang="en"></xsd:documentation>
            </xsd:annotation>
            <xsd:element name="exchangedCurrency2" type="tns:Payment">
              <xsd:annotation>
                <xsd:documentation xml:lang="en">This is the second of the two currency flows that define a single leg of a standard foreign exchange transaction.</xsd:documentation>
              </xsd:annotation>
            </xsd:element>
            <xsd:element name="currency2" type="instrument:Currency"></xsd:element>
          </xsd:choice>
          <xsd:element name="valueDate" type="xsd:date" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">The date on which both currencies traded will settle.</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="exchangeRate" type="tns:TradeFxRate">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">The rate of exchange between the two currencies.</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="contractType" type="tns:contractType" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">The contract Type. Default is forward. Used for FX Spot and Non Deliverable forward.</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="fxLegBuySellInfo" type="tns:FXLegBuySellInfo" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">Informative field giving which currency is bought and which currency is sold</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="depositaryCurrency" type="instrument:Currency" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">Informative field giving the currency to which the depositary correspond.</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="depositary2Currency" type="instrument:Currency" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">Informative field giving the currency to which the depositary2 correspond.</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="referenceCurrency" type="instrument:Currency" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">This is the reference currency of the spot or the forward contract.</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="ndfSettlementCurrency" type="instrument:Currency" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">This is the settlement currency of the NDF.</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="ndfFixingType" type="instrument:FixingType" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">The fixing type of the NDF reference price (ex: last, high, new_historical_column).</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="ndfFixingDate" type="xsd:date" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">The date on which the NDF reference price will be fixed.</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="fixingDate" type="xsd:date" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">The date on which the forward reference price will be fixed. For Non Deliverable Forward, please see ndfFixingDate element.</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="forwardCommission" type="xsd:decimal" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">Defines the commission in case of Forward or NDF leg. Used for Forward and NDF.</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="calculationType" type="tns:CalculationType" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">Defines the calculation type used to calculate the forward commission. Used for Forward and NDF.</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="rateFirstCurrency" type="xsd:decimal" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">The interest rate for the first currency when the calculation type is either AbsoluteRate or RelativeRate. Used for Forward and NDF.</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="rateSecondCurrency" type="xsd:decimal" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">The interest rate for the second currency when the calculation type is either AbsoluteRate or RelativeRate. Used for Forward and NDF.</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <!-- Normal trade needs all four accounts-->
          <xsd:element name="nostroCash" type="ssi:SSI" minOccurs="0" />
          <xsd:element name="nostroSecurity" type="ssi:SSI" minOccurs="0" />
          <xsd:element name="lostroCash" type="ssi:SSI" minOccurs="0" />
          <xsd:element name="lostroSecurity" type="ssi:SSI" minOccurs="0" />
          <xsd:element name="discountCurveFamily" type="xsd:unsignedInt" minOccurs="0" />
          <xsd:group ref="tns:SophisTradeCharacteristics.model">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">obsolete kept only for compatibility. Use the trade characteristics defined in PartyTradeInformations instead.</xsd:documentation>
            </xsd:annotation>
          </xsd:group>
        </xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:element name="fxLeg" type="tns:FxLeg" substitutionGroup="tns:product" />
  <xsd:complexType name="FxNdfExercise">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">A type that represents a single exchange of one currency for another.</xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="tns:TradeProduct">
        <xsd:sequence>
          <xsd:element name="backOfficeReference" type="xsd:long" minOccurs="1">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">The trade id of the exercised NDF trade.</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:group ref="tns:SophisTradeCharacteristics.model">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">obsolete kept only for compatibility. Use the trade characteristics defined in PartyTradeInformations instead.</xsd:documentation>
            </xsd:annotation>
          </xsd:group>
        </xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:element name="fxNdfExercise" type="tns:FxNdfExercise" substitutionGroup="tns:product" />
  <xsd:simpleType name="contractType">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">The contract Type. Default is forward. Used for FX Spot and Non Deliverable forward.</xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:normalizedString">
      <xsd:enumeration value="Spot" />
      <xsd:enumeration value="Forward" />
      <xsd:enumeration value="NDF" />
    </xsd:restriction>
  </xsd:simpleType>
  <xsd:simpleType name="CalculationType">
    <xsd:annotation>
      <xsd:documentation xml:lang="en"></xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:normalizedString">
      <xsd:enumeration value="NotDefined" />
      <xsd:enumeration value="AbsoluteForward" />
      <xsd:enumeration value="RelativeForward" />
      <xsd:enumeration value="AbsoluteForwardAddPoint" />
      <xsd:enumeration value="RelativeForwardAddPoint" />
      <xsd:enumeration value="AbsoluteRate" />
      <xsd:enumeration value="RelativeRate" />
    </xsd:restriction>
  </xsd:simpleType>
  <xsd:complexType name="FxSwap">
    <xsd:annotation>
      <xsd:documentation source="http://www.FpML.org" xml:lang="en">A type that represents a Forex Swap, i.e. a pair of Forex exchanges.</xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="tns:Product">
        <xsd:sequence>
          <xsd:element name="fxLeg1" type="tns:FxLeg">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">This is the first FX flow of the Forex Swap.</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="fxLeg2" type="tns:FxLeg">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">This is the second FX flow of the Forex Swap.</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
        </xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:element name="fxSwap" type="tns:FxSwap" substitutionGroup="tns:product" />
  <!-- Stock loans -->
  <xsd:simpleType name="PnLPricing">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">
        Defines the PnL Pricing type for a
        repo trade.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:string">
      <xsd:enumeration value="UsePnLPref"></xsd:enumeration>
      <xsd:enumeration value="DiscountComputation"></xsd:enumeration>
      <xsd:enumeration value="AccruedComputation"></xsd:enumeration>
    </xsd:restriction>
  </xsd:simpleType>
  <xsd:complexType name="LoanOrRepo" abstract="true">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">Defines whether a loan or repo.</xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="tns:Product">
        <xsd:sequence>
          <xsd:group ref="tns:LenderBorrower.model">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">Define wheter lender or borrower</xsd:documentation>
            </xsd:annotation>
          </xsd:group>
          <xsd:element name="allotment" type="xsd:normalizedString" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">Defines the allotment.</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="pnLPricing" type="tns:PnLPricing" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">
                Defines the PnLPricing. If not present, the
                template's one will be used
              </xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element ref="tns:convention" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">
                The convention defines a agreement between the lender and the borrower.
                If not defined, the unique lba between lender and borrower is taken. if no lba can be found (none defined or not unique) an error is reported.
              </xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="valueDate" type="common:AdjustableDate" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">
                The Payment Date.
                Deprecated. Use of paymentDate in the tradeHeader is preferred. When both are specified on import, the valueDate is used.
              </xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element ref="tns:termination">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">This is the definition of the loan call : delivery date, commission date and callable section.</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element ref="tns:collateral">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">Defines the collateral of loan/repo which can be cash, security or Treasury bills.</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element ref="tns:commission">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">Defines the commission.</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <!--	  <xsd:element name="lostroSecurity" type="ssi:SSI" minOccurs="0" /> -->
          <!--	  <xsd:element name="nostroSecurity" type="ssi:SSI" minOccurs="0" /> -->
          <xsd:element name="nostroCash" type="ssi:SSI" minOccurs="0" />
          <xsd:element name="lostroCash" type="ssi:SSI" minOccurs="0" />
          <xsd:element name="paymentMethod" type="xsd:normalizedString" minOccurs="0" />
          <xsd:element name="SMDT" type="xsd:normalizedString" minOccurs="0" />
        </xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:element name="loanOrRepo" type="tns:LoanOrRepo" substitutionGroup="tns:product" />
  <xsd:complexType name="StockLoan">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">A stock loan is a loan of securities.</xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="tns:LoanOrRepo">
        <xsd:sequence>
          <xsd:element ref="tns:securityPrincipal">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">A stock loan is a loan of securities.</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
        </xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:element name="stockLoan" type="tns:StockLoan" substitutionGroup="tns:loanOrRepo" />
  <xsd:complexType name="BuyAndSellBack">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">Note that Repo Sec Buy and sell back must be input as stock loan.</xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="tns:LoanOrRepo">
        <xsd:sequence>
          <xsd:element ref="tns:securityPrincipal" />
        </xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:element name="buyAndSellBack" type="tns:BuyAndSellBack" substitutionGroup="tns:loanOrRepo" />
  <xsd:complexType name="Repo">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">A Repo is a loan of cash.</xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="tns:LoanOrRepo">
        <xsd:sequence>
          <xsd:element ref="tns:cashPrincipal">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">A Repo is a loan of cash.</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
        </xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:element name="repo" type="tns:Repo" substitutionGroup="tns:loanOrRepo" />
  <xsd:complexType name="BondRepo">
    <xsd:complexContent>
      <xsd:extension base="tns:LoanOrRepo">
        <xsd:sequence>
          <xsd:element ref="tns:cashPrincipal">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">Bond Repo</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
        </xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:element name="bondRepo" type="tns:BondRepo" substitutionGroup="tns:loanOrRepo"/>
  <xsd:complexType name="ExchangeRepo">
    <xsd:complexContent>
      <xsd:extension base="tns:LoanOrRepo">
        <xsd:sequence>
          <xsd:element ref="tns:cashPrincipal">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">Exchange Repo</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="term" type="xsd:int">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">This is the term for the exchange repo.</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
        </xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:element name="exchangeRepo" type="tns:ExchangeRepo" substitutionGroup="tns:loanOrRepo"/>
  <xsd:complexType name="LoanPrincipal">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">Principal of the loan</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence></xsd:sequence>
  </xsd:complexType>
  <xsd:element name="principal" type="tns:LoanPrincipal" />
  <xsd:complexType name="SecurityPrincipal">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">Security principal</xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="tns:LoanPrincipal">
        <xsd:sequence>
          <!--<xsd:group ref="tns:NumOrNotional"/>-->
          <xsd:choice>
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">Should be the group NumOrNotional but this causes troubles to dot net binding.</xsd:documentation>
            </xsd:annotation>
            <xsd:element name="numberOfSecurities" type="xsd:double" />
            <xsd:element name="notional" type="xsd:double" />
          </xsd:choice>
          <xsd:element name="instrument" type="instrument:Underlyer">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">This is the underlying reference of the stock loan.</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="dividendRebate" type="tns:DividendRebate" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">Defines the distributed rate and the payment date of these dividends.</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="roll" type="tns:Roll" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en"> Defines whether this stock loan is a roll, and gives the original position so that expiry tickets can be generated.</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
        </xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:element name="securityPrincipal" type="tns:SecurityPrincipal" substitutionGroup="tns:principal" />
  <xsd:simpleType name="NowOrInFine">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">When no date input on stock loan dividend equals now otherwise date supplied</xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:token">
      <xsd:enumeration value="Now" />
      <xsd:enumeration value="InFine" />
    </xsd:restriction>
  </xsd:simpleType>

  <xsd:complexType name="DividendRebate">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">define the dividend rebate ratio for shares</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="rate" type="xsd:double">
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">Defines the distributed rate.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="date">
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">Defines the payment date of these dividends.</xsd:documentation>
        </xsd:annotation>
        <xsd:simpleType>
          <xsd:annotation>
            <xsd:documentation xml:lang="en">When no date input on stock loan dividend equals now otherwise date supplied</xsd:documentation>
          </xsd:annotation>
          <xsd:union memberTypes="tns:NowOrInFine xsd:date"></xsd:union>
        </xsd:simpleType>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>

  <xsd:complexType name="Roll">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">
        Section detailing
      </xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element ref="tns:mainPosition" minOccurs="1" />
    </xsd:sequence>
  </xsd:complexType>

  <xsd:complexType name="CashPrincipal">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">A Repo is based on a quantity of cash.</xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="tns:LoanPrincipal">
        <xsd:sequence>
          <xsd:element name="amount" type="instrument:Money">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">Defines the underlying currency and the amount of the cash.</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="roll" type="tns:Roll" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en"> Defines whether this repo is a roll, and gives the original position so that expiry tickets can be generated.</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
        </xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:element name="cashPrincipal" type="tns:CashPrincipal" substitutionGroup="tns:principal" />
  <xsd:complexType name="ConventionId">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">A convention identifier.</xsd:documentation>
    </xsd:annotation>
    <xsd:simpleContent>
      <xsd:extension base="xsd:normalizedString">
        <xsd:attribute name="conventionIdScheme" type="xsd:anyURI" use="required" />
      </xsd:extension>
    </xsd:simpleContent>
  </xsd:complexType>
  <xsd:complexType name="Convention">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">A convention is used to consolidate the elements of collateral management.</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="conventionId" type="tns:ConventionId" maxOccurs="unbounded">
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">This is the convention identifier.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="template" type="instrument:Underlyer" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">
            This is a loan/repo template. When a data is missing, we get it in this template.
            If this field is not defined, we take the first template associated with the convention corresponding to the type (loan/repo).
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="editModel" type="xsd:normalizedString" minOccurs="0">
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:element name="convention" type="tns:Convention" />
  <xsd:complexType name="Termination">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">Termination of the loan.</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="startDate" type="common:AdjustableDate">
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">
            This is the delivery date.
            This is a compulsory field.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="endDate" type="common:AdjustableDate" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">This is the commission date. if not specified contract is open.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="callable" type="tns:Callable" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">
            Defines the advance notice clause.
            If not specified, the value is taken from template. if not specified in template, the value "EithersDiscretion" with a callable period of 2 days is set.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="exerciseDate" type="common:AdjustableDate" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">
            This is the excercise date. Available only for some NotificationTypes.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:element name="termination" type="tns:Termination" />
  <xsd:complexType name="Callable">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">
        The number of days between
        the announcement that the loan is called and the exercising of the call.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:simpleContent>
      <xsd:extension base="xsd:int">
        <xsd:attribute name="type" type="tns:NotificationType" use="required" />
      </xsd:extension>
    </xsd:simpleContent>
  </xsd:complexType>
  <xsd:simpleType name="NotificationType">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">Notification requirements of the loan.</xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:token">
      <xsd:enumeration value="WithoutNotice">
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">loan can be called in without prior notice.</xsd:documentation>
        </xsd:annotation>
      </xsd:enumeration>
      <xsd:enumeration value="LendersDiscretion">
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">The lender can choose when to call in the loan.</xsd:documentation>
        </xsd:annotation>
      </xsd:enumeration>
      <xsd:enumeration value="BorrowersDiscretion">
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">The borrower can choose when to call in the loan.</xsd:documentation>
        </xsd:annotation>
      </xsd:enumeration>
      <xsd:enumeration value="EithersDiscretion">
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">Either the lender or the borrower can choose when to call in the loan.</xsd:documentation>
        </xsd:annotation>
      </xsd:enumeration>
      <xsd:enumeration value="NotCallable">
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">The loan cannot be called in.</xsd:documentation>
        </xsd:annotation>
      </xsd:enumeration>
    </xsd:restriction>
  </xsd:simpleType>
  <xsd:complexType name="Commission">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">define the commision</xsd:documentation>
    </xsd:annotation>
  </xsd:complexType>
  <xsd:element name="commission" type="tns:Commission" />
  <xsd:complexType name="NoCommission">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">Defines the values when no commission.</xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="tns:Commission">
        <xsd:sequence>
          <xsd:element name="spot" type="xsd:double" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">This is the stock spot of the transaction. Optional for backwards compatibility.</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
        </xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:element name="noCommission" type="tns:NoCommission" substitutionGroup="tns:commission" />
  <xsd:complexType name="CommissionCommon">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">Defines the commission.</xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="tns:Commission">
        <xsd:sequence>
          <xsd:element name="minimum" type="xsd:double" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">
                This is the commission minimum amount.
                If not specified, takes the value from template. if not specified in the template, takes 0.
              </xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="billing" type="tns:CommissionBilling" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">
                Defines the billing commission : frequency and currency.
                If not specified takes values from the template, otherwise takes Final/underlying currency
              </xsd:documentation>
            </xsd:annotation>
          </xsd:element>
        </xsd:sequence>
        <xsd:attribute name="type" type="tns:CommissionType" use="optional">
          <xsd:annotation>
            <xsd:documentation source="http://www.sophis.net" xml:lang="en">
              Defines the comission type.
              If not specified, takes value from template, otherwise takes FixedPrice.
            </xsd:documentation>
          </xsd:annotation>
        </xsd:attribute>
        <xsd:attribute name="mode" type="tns:CommissionMode" use="optional">
          <xsd:annotation>
            <xsd:documentation source="http://www.sophis.net" xml:lang="en">
              Defines the comission calculation mode.
              If not specified, takes value from template, otherwise takes Linear.
            </xsd:documentation>
          </xsd:annotation>
        </xsd:attribute>
        <xsd:attribute name="accrualMode" type="tns:CommissionAccrualMode" use="optional">
          <xsd:annotation>
            <xsd:documentation source="http://www.sophis.net" xml:lang="en">
              Defines the comission accrual calculation mode.
              If not specified, takes value from template, otherwise takes value from CommissionMode attribute.
            </xsd:documentation>
          </xsd:annotation>
        </xsd:attribute>
        <xsd:attribute name="roundingLevel" type="tns:FeesRoundingLevel" use="optional">
          <xsd:annotation>
            <xsd:documentation source="http://www.sophis.net" xml:lang="en">
              Defines commission rounding level.
              This value is exported for information only and ignore on import.
            </xsd:documentation>
          </xsd:annotation>
        </xsd:attribute>
        <xsd:attribute name="roundingType" type="tns:FeesRoundingType" use="optional">
          <xsd:annotation>
            <xsd:documentation source="http://www.sophis.net" xml:lang="en">
              Defines commission rounding type.
              This value is exported for information only and ignore on import.
            </xsd:documentation>
          </xsd:annotation>
        </xsd:attribute>
        <xsd:attribute name="roundingValue" type="xsd:double" use="optional">
          <xsd:annotation>
            <xsd:documentation source="http://www.sophis.net" xml:lang="en">
              Defines commission rounding value.
              This value is exported for information only and ignore on import.
            </xsd:documentation>
          </xsd:annotation>
        </xsd:attribute>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:complexType name="LoanCommission">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">Defines the loan commission.</xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="tns:CommissionCommon">
        <xsd:sequence>
          <xsd:element name="rate" type="xsd:double">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">This is the commission rate. Compulsory field.</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="spot" type="xsd:double">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">This is the stock spot of the transaction. Compulsory field.</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="dayCountBasis" type="instrument:DayCountBasis" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">
                This is the time equivalence convention with respect to the commission.
                If not specified, takes the value from the template, otherwise sets Actual/360
              </xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <!-- redundant with billing currency
					<xsd:element name="currency" type="instrument:Currency" minOccurs="0"/>
					-->
          <xsd:element name="spotForCommission" minOccurs="0" maxOccurs="1">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">
                Defines contractual price used to calculate commission.
                Can be expressed either as price in commission (billing) currency or as forex between underlying and billing currencies.
                Applicable only when commission type is Fixed Price or Fixed Price with Revisable Spot.
              </xsd:documentation>
            </xsd:annotation>
            <xsd:complexType>
              <xsd:choice>
                <xsd:element name="spot" type="xsd:double">
                  <xsd:annotation>
                    <xsd:documentation source="http://www.sophis.net" xml:lang="en">
                      Defines contractual price used to calculate commission. Value is always in commission (billing) currency.
                      Applicable only when commission type is Fixed Price or Fixed Price with Revisable Spot.
                    </xsd:documentation>
                  </xsd:annotation>
                </xsd:element>
                <xsd:element name="fx" type="tns:TradeFxRate">
                  <xsd:annotation>
                    <xsd:documentation source="http://www.sophis.net" xml:lang="en">
                      Defines contractual forex rate between underlying and commission (billing) currency.
                      Applicable only when commission type is Fixed or Fixed Price with Revisable Spot and
                      commission (billing) currency is different from underlying currency.
                    </xsd:documentation>
                  </xsd:annotation>
                </xsd:element>
              </xsd:choice>
            </xsd:complexType>
          </xsd:element>
          <!--
			<xsd:choice>
				<xsd:annotation>
				</xsd:annotation>
				<xsd:element name="spotCommission" type="xsd:double" minOccurs="0">
					<xsd:annotation>
						<xsd:documentation source="http://www.sophis.net" xml:lang="en">
							This is contractual price used to calculate commission. Value is always in commission currency.
							Applicable only when commission type is Fixed Price or Fixed Price with Revisable Spot.
						</xsd:documentation>
					</xsd:annotation>
				</xsd:element>
				<xsd:element name="fxCommission" type="tns:TradeFxRate" minOccurs="0">
					<xsd:annotation>
						<xsd:documentation source="http://www.sophis.net" xml:lang="en">
							This is contractual forex rate between underlying and commission currency.
							Applicable only when commission type is Fixed or Fixed Price with Revisable Spot and
							commission currency is different from underlying currency.
						</xsd:documentation>
					</xsd:annotation>
				</xsd:element>
			</xsd:choice>
			-->
        </xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:element name="loanCommission" type="tns:LoanCommission" substitutionGroup="tns:commission" />
  <xsd:complexType name="RepoCommission">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">Defines the repo commission.</xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="tns:CommissionCommon">
        <xsd:sequence>
          <xsd:element name="interest" type="instrument:InterestType">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">
                The interest rate of the commission can be floating or fixed.
                This is a compulsory field.
              </xsd:documentation>
            </xsd:annotation>
          </xsd:element>
        </xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:element name="repoCommission" type="tns:RepoCommission" substitutionGroup="tns:commission" />
  <xsd:simpleType name="CommissionType">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">Defines the type of commission.</xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:token">
      <xsd:enumeration value="FixedPrice" />
      <xsd:enumeration value="OpenBasis" />
      <xsd:enumeration value="MonetaryUnit" />
      <xsd:enumeration value="FeeMark" />
      <xsd:enumeration value="FixedPriceRevisable" />
      <xsd:enumeration value="Rebate" />
      <xsd:enumeration value="ActuarialFixedPrice" />
    </xsd:restriction>
  </xsd:simpleType>
  <xsd:simpleType name="CommissionMode">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">Defines calculation mode of commission.</xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:token">
      <xsd:enumeration value="Linear"/>
      <xsd:enumeration value="Actuarial"/>
    </xsd:restriction>
  </xsd:simpleType>
  <xsd:simpleType name="CommissionAccrualMode">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">Defines calculation mode of accrued commission.</xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:token">
      <xsd:enumeration value="Linear"/>
      <xsd:enumeration value="Actuarial"/>
      <xsd:enumeration value="Chinese Repo"/>
    </xsd:restriction>
  </xsd:simpleType>
  <xsd:simpleType name="FeesRoundingLevel">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">Defines fees rounding level.</xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:token">
      <xsd:enumeration value="None"/>
      <xsd:enumeration value="Daily"/>
      <xsd:enumeration value="Whole Period"/>
    </xsd:restriction>
  </xsd:simpleType>
  <xsd:simpleType name="FeesRoundingType">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">Defines fees rounding type.</xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:token">
      <xsd:enumeration value="Real"/>
      <xsd:enumeration value="Up"/>
      <xsd:enumeration value="Down"/>
      <xsd:enumeration value="Nearest"/>
    </xsd:restriction>
  </xsd:simpleType>
  <xsd:complexType name="CommissionBilling">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">Defines the details of the commission billing.</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="frequency" type="xsd:normalizedString" minOccurs="0">
        <!-- may be toolkited -->
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">
            This is the commission payment frequency.
            If not specified takes value from the template, otherwise takes Final.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="currency" type="instrument:Currency" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">
            This is the commission payment currency.
            If not specified takes value from the template, otherwise takes underlying currency.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="Collateral" abstract="true">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">
        collateral details
      </xsd:documentation>
    </xsd:annotation>
  </xsd:complexType>
  <xsd:element name="collateral" type="tns:Collateral" />
  <xsd:complexType name="SecurityCollateral">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">TriParty collateral details</xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="tns:Collateral">
        <xsd:sequence>
          <xsd:element name="instrument" type="tns:TradeInstrument" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">
                Defines the underlying instrument for collateral trade.
              </xsd:documentation>
            </xsd:annotation>
          </xsd:element>
        </xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:element name="securityCollateral" type="tns:SecurityCollateral" substitutionGroup="tns:collateral" />
  <xsd:complexType name="WithoutCollateral">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">When no collateral is provided</xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="tns:Collateral"></xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:element name="withoutCollateral" type="tns:WithoutCollateral" substitutionGroup="tns:collateral" />
  <xsd:complexType name="TripartyCollateral">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">TriParty collateral details</xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="tns:Collateral"></xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:element name="tripartyCollateral" type="tns:TripartyCollateral" substitutionGroup="tns:collateral" />
  <xsd:complexType name="CollateralCommon" abstract="true">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">Collateral details</xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="tns:Collateral">
        <xsd:sequence>
          <xsd:element name="hedgingRatio" type="xsd:double" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">
                Defines the hedging ratio.
                If not specified, takes value from the template, otherwise 100%.
              </xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="hairCut" type="xsd:double" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">
                Defines the collateral haircut.
                If not specified, takes value from the template, otherwise takes 100%
              </xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="inverseHaircut" type="tns:InverseHairCut" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">Defines inverse haircut and hedging type. If not present, Use Global Pref will be used</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
        </xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:simpleType name="InverseHairCut">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">Defines inverse haircut and hedging type.</xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:string">
      <xsd:enumeration value="Use Global Pref"></xsd:enumeration>
      <xsd:enumeration value="Inverse None"></xsd:enumeration>
      <xsd:enumeration value="Inverse Haircut"></xsd:enumeration>
      <xsd:enumeration value="Inverse Hedging"></xsd:enumeration>
      <xsd:enumeration value="Inverse Haircut and Hedging"></xsd:enumeration>
    </xsd:restriction>
  </xsd:simpleType>
  <xsd:complexType name="SecurityPoolCollateral">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">Defines a security pool collateral.</xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="tns:CollateralCommon"></xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:element name="securityPoolCollateral" type="tns:SecurityPoolCollateral" substitutionGroup="tns:collateral" />
  <xsd:complexType name="SecurityPerContractCollateral">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">Defines a security per contract collateral.</xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="tns:CollateralCommon">
        <xsd:sequence>
          <!--<xsd:group ref="tns:NumOrNotional"/>-->
          <xsd:choice>
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">Should be the group NumOrNotional but this causes troubles to dot net binding.</xsd:documentation>
            </xsd:annotation>
            <xsd:element name="numberOfSecurities" type="xsd:double" />
            <xsd:element name="notional" type="xsd:double" />
          </xsd:choice>
          <xsd:element name="fxRate" type="tns:TradeFxRate" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">
                This is the forex rate when the collateral currency is different from the principal currency.
                If not specified takes forex=1.0
              </xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="lastSpot" type="xsd:double" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">The last spot in the currency of the collateral instrument.</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="instrument" type="instrument:Underlyer">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">This is the collateral instrument. This is a compulsory field</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="paymentMethod" type="xsd:normalizedString" minOccurs="0" />
          <xsd:element name="SMDT" type="xsd:normalizedString" minOccurs="0" />
          <!-- <xsd:element name="lostroSecurity" type="ssi:SSI" minOccurs="0" /> -->
          <!-- <xsd:element name="nostroSecurity" type="ssi:SSI" minOccurs="0" /> -->
          <xsd:element name="nostroSecurity" type="ssi:SSI" minOccurs="0" />
          <xsd:element name="lostroSecurity" type="ssi:SSI" minOccurs="0" />
          <xsd:element name="collateralDividendDate" type="xsd:date" minOccurs="0" />
          <xsd:element name="collateralDividendRate" type="xsd:double" minOccurs="0" />
          <xsd:element name="defaultSmDtPm" type="xsd:boolean" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">
                Only read when both 'paymentMethod' and 'SMDT' are missing, then, if present and set to true, forces
                the values for SM/DT/PM to be calculated automatically. Unlike in 'LoanOrRepo' or 'TradeProduct', when
                those two elements are not present here, the SM/DT/PM are set to XXX/XXX. This has been done to preserve
                behaviour of older versions of the software.
              </xsd:documentation>
            </xsd:annotation>
          </xsd:element>
        </xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:element name="securityPerContractCollateral" type="tns:SecurityPerContractCollateral" substitutionGroup="tns:collateral" />
  <xsd:complexType name="DedicatedPool">
    <xsd:sequence>
      <xsd:element name="instrument"   type="instrument:Underlyer" minOccurs="0" />
      <xsd:element name="quantity"     type="xsd:int"              minOccurs="0" />
      <xsd:element name="haircut"      type="xsd:double"           minOccurs="0" />
      <xsd:element name="nominal"      type="xsd:double"           minOccurs="0" />
      <xsd:element name="spot"         type="xsd:double"           minOccurs="0" />
      <xsd:element name="dividendRate" type="xsd:double"           minOccurs="0" />
    </xsd:sequence>
  </xsd:complexType>

  <xsd:complexType name="SecurityDedicatedPoolCollateral">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">Defines a dedicated pool collateral.</xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="tns:CollateralCommon">
        <xsd:sequence>
          <xsd:element name="dedicatedPool" type="tns:DedicatedPool" minOccurs="0" maxOccurs="unbounded"/>
        </xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:element name="securityDedicatedPoolCollateral" type="tns:SecurityDedicatedPoolCollateral" substitutionGroup="tns:collateral"/>
  <xsd:complexType name="CashPoolCollateral">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">Defines a cash pool collateral.</xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="tns:CollateralCommon">
        <xsd:sequence>
          <xsd:element name="amount" type="tns:SettlementAmount">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">
                Defines the amount of the collateral. It is calculated
                from the quantity of principal multiplied by the forex between the two currencies (if they are different).
              </xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="interest" type="instrument:InterestType">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">
                This is the cash interest type : fixed of floating and its properties.
                This is a compulsory field.
              </xsd:documentation>
            </xsd:annotation>
          </xsd:element>
        </xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:element name="cashPoolCollateral" type="tns:CashPoolCollateral" substitutionGroup="tns:collateral" />
  <xsd:complexType name="CashPerContractCollateral">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">Defines a cash per contract collateral.</xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="tns:CollateralCommon">
        <xsd:sequence>
          <xsd:element name="amount" type="tns:SettlementAmount">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">
                Defines the amount of the collateral. It is calculated
                from the quantity of principal multiplied by the forex between the two currencies (if they are different).
                This is a compulsory field.
              </xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="interest" type="instrument:InterestType">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">
                This is the cash interest type : fixed of floating and it properties.
                This is a compulsory field.
              </xsd:documentation>
            </xsd:annotation>
          </xsd:element>
        </xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:element name="cashPerContractCollateral" type="tns:CashPerContractCollateral" substitutionGroup="tns:collateral" />
  <xsd:group name="LenderBorrower.model">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">Lending and borrowing details of the trade</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="lenderPartyReference" type="party:PartyReference">
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">
            A reference to the party that lends
            this instrument (resp. cash), i.e. that grants for a certain period of time, the rights defined by this instrument and in return receives a payment
            for it.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="borrowerPartyReference" type="party:PartyReference">
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">
            A reference to the party that borrows this
            instrument (resp. cash), ie. pays for this instrument and receives the rights defined by it for a certain period of time.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:group>
  <xsd:complexType name="ContractForDifference">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">Type specifying the characteristic of a trade on a contract for difference.</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="instrument" type="instrument:Underlyer" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">Since 5.3.2.2 References of the cfd</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="fundingCosts" type="tns:FundingCosts" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">Define the section of Funding costs</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="borrowingCosts" type="tns:BorrowingCosts" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">Define the section of Borrowing costs</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="advancedCFD" type="tns:AdvancedCFD" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">This contains the information needed to identify the CFD agreement, instrument and template. It is only used for advanced CFD.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="spread" type="xsd:double" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">This is the CFD spread rate. This is not compulsory for advanced CFD.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="extraFields" type="common:ExtraFields" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">Since 5.3.2.2 Tookited Fields</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="FundingCosts">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">Define the section of Funding costs</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="spread" type="xsd:double" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">This is a spread to applicate on the standard rate defined for the prime broker on funding expressed as 0.001 for 10 basis. If not defined, the standard spread is applied.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="BorrowingCosts">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">Define the section of borrowing costs</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="rate" type="xsd:double" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">This is a rate to applicate on short position expressed as 0.001 for 10 basis. If not defined, the standard borrowing cost defined for the prime broker is applied.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="CFDDividendDistributedRate">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">Specifies the rate for the dividends to be paid</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="longRate" type="xsd:double" minOccurs="1" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">The long dividend distributed rate for advanced CFD.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="shortRate" type="xsd:double" minOccurs="1" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">The short dividend distributed rate for advanced CFD.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="AdvancedCFD">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">Advanced CFD module</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="cfdDividendDistributedRate" type="tns:CFDDividendDistributedRate" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">This contains the dividend distributed rates for advanced CFD.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="template" type="instrument:Identifier" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">This is the template to be used when creating the CFD.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="convention" type="xsd:int" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">This is the convention of the CFD agreement.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="MainPosition">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">
        Link to the main position in the special Margin Call cases.
        If multiple ids are given, they must refer to the same position.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="linkId" type="tns:LinkId" minOccurs="0" maxOccurs="unbounded" />
    </xsd:sequence>
  </xsd:complexType>
  <xsd:element name="mainPosition" type="tns:MainPosition" />

  <xsd:complexType name="Movement">
    <xsd:complexContent>
      <xsd:extension base="tns:Product">
        <xsd:sequence>
          <xsd:element name="account1" type="NostroAccountReference:NostroAccountReference"/>
          <xsd:element name="account2" type="NostroAccountReference:NostroAccountReference" minOccurs="0"/>
          <xsd:element name="currency" type="instrument:Currency" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">Must be specified when the interest is fixed. If specified in the floating rate case, the currencies must match.</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="movementType" type="xsd:int"/>
          <xsd:element name="amount" type="xsd:double"/>
        </xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:element name="movement" type="tns:Movement" substitutionGroup="tns:product"/>

  <xsd:complexType name="PartialReturn">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">
        Section detailing partial return
      </xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="tns:Product">
        <xsd:sequence>
          <xsd:element name="collateralQuantity" type="xsd:double" minOccurs="0"/>
          <xsd:element name="principalQuantity" type="xsd:double" minOccurs="0"/>
          <xsd:element name="principalSpot" type="xsd:double" minOccurs="0"/>
          <xsd:element ref="tns:mainPosition" minOccurs="1" />
          <xsd:element name="paymentMethodCollateral" type="xsd:normalizedString" minOccurs="0" />
          <xsd:element name="SMDTCollateral" type="xsd:normalizedString" minOccurs="0" />
          <xsd:element name="paymentMethodPrincipal" type="xsd:normalizedString" minOccurs="0" />
          <xsd:element name="SMDTPrincipal" type="xsd:normalizedString" minOccurs="0" />
          <xsd:element name="depositary" type="party:PartyRole" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation source="http://www.FpML.org" xml:lang="en">
                If not defined takes
                (in the order of precedence):
                creditor
                settler
              </xsd:documentation>
            </xsd:annotation>
          </xsd:element>
        </xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:element name="partialReturn" type="tns:PartialReturn" substitutionGroup="tns:product"/>

  <xsd:complexType name="Repricing">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">
        Section detailing Repricing for Stockloan
      </xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="tns:Product">
        <xsd:sequence>
          <xsd:element name="principalSpot" type="xsd:double" minOccurs="1"/>
          <xsd:element name="deltaCash" type="xsd:double" minOccurs="0"/>
          <xsd:element name="interest" type="xsd:double" minOccurs="0"/>
          <xsd:element name="commission" type="xsd:double" minOccurs="0"/>
          <xsd:element ref="tns:mainPosition" minOccurs="1" />
        </xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:element name="repricing" type="tns:Repricing" substitutionGroup="tns:product"/>

  <xsd:complexType name="MaturityModification">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">
        Section detailing
      </xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="tns:Product">
        <xsd:sequence>
          <xsd:element ref="tns:mainPosition" minOccurs="1" />
          <xsd:element name="generateTicket" type="xsd:boolean" minOccurs="0" />
          <xsd:element name="maturityDate" type="xsd:date" minOccurs="0" />
        </xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:element name="maturityModification" type="tns:MaturityModification" substitutionGroup="tns:product"/>

  <xsd:complexType name="MarginCall" abstract="true">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">
        Section detailing margin call
      </xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="tns:Product">
        <xsd:sequence>
          <xsd:element ref="tns:convention" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">
                The convention defines a agreement between the lender and the borrower.
                If not defined, the unique lba between lender and borrower is taken. if no lba can be found (none defined or not unique) an error is reported.
              </xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element ref="tns:mainPosition" minOccurs="0" />
          <xsd:element name="marginAccount" type="NostroAccountReference:NostroAccountReference" minOccurs="0" />
          <xsd:element name="custodyAccount" type="NostroAccountReference:NostroAccountReference" minOccurs="0" />
        </xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:element name="marginCall" type="tns:MarginCall" substitutionGroup="tns:product" />

  <xsd:complexType name="CashMarginCall">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">
        Cash margin calls
      </xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="tns:MarginCall">
        <xsd:sequence>
          <xsd:element name="movementType" type="xsd:normalizedString" minOccurs="0" />
          <xsd:element name="requirementType" type="xsd:normalizedString" minOccurs="0" />
          <xsd:element name="interest" type="instrument:InterestType" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">An existing rate must be referenced.</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="currency" type="instrument:Currency" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">Must be specified when the interest is fixed. If specified in the floating rate case, the currencies must match.</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="amount" type="xsd:double" />
          <xsd:element name="accrualInterest" type="xsd:double" minOccurs="0" />
        </xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:element name="cashMarginCall" type="tns:CashMarginCall" substitutionGroup="tns:marginCall" />

  <xsd:complexType name="CashPerContractMarginCall">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">
        Per Contract Cash margin calls
      </xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="tns:Product">
        <xsd:sequence>
          <xsd:element ref="tns:mainPosition" minOccurs="1" />
          <xsd:element name="amount" type="xsd:double" />
          <xsd:element name="price" type="xsd:double" minOccurs="0" />
          <xsd:element name="markSpot" type="xsd:boolean" minOccurs="0" />
        </xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:element name="cashPerContractMarginCall" type="tns:CashPerContractMarginCall" substitutionGroup="tns:product" />

  <xsd:complexType name="SecuritiesMarginCall">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">
        Securities provide for margin calls
      </xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="tns:MarginCall">
        <xsd:sequence>
          <xsd:element name="instrument" type="instrument:Underlyer" />
          <xsd:element name="numberOfSecurities" type="xsd:double" />
          <xsd:element name="lastPrice" type="xsd:double" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">If not present, the "current last" price is used.</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
        </xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:element name="securitiesMarginCall" type="tns:SecuritiesMarginCall" substitutionGroup="tns:marginCall" />


  <xsd:complexType name="SecuritiesPerContractMarginCall">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">
        Per Contract Securities margin calls
      </xsd:documentation>
    </xsd:annotation>
    <xsd:complexContent>
      <xsd:extension base="tns:MarginCall">
        <xsd:sequence>
          <xsd:element name="interest" type="instrument:InterestType">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">An existing rate must be referenced.</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="currency" type="instrument:Currency" minOccurs="0">
            <xsd:annotation>
              <xsd:documentation source="http://www.sophis.net" xml:lang="en">Must be specified when the interest is fixed. If specified in the floating rate case, the currencies must match.</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="amount" type="xsd:double" />
          <xsd:element name="accrualInterest" type="xsd:double" minOccurs="0" />
          <xsd:element name="markSpot" type="xsd:boolean" minOccurs="0" />
        </xsd:sequence>
      </xsd:extension>
    </xsd:complexContent>
  </xsd:complexType>
  <xsd:element name="securitiesPerContractMarginCall" type="tns:SecuritiesPerContractMarginCall" substitutionGroup="tns:marginCall" />

  <xsd:complexType name="Mirroring">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">
        section for linked or mirrored deals
      </xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="mirroringInfo" type="tns:MirroringInfo" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">This contains information about a mirrored deal. If a transaction is a mirrored transaction, this will contain information about the parent/child deals. But when importing it is not possible to use these fields to specify the id's of the child deals</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="mirrorRule" type="xsd:normalizedString" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">This is the mirroring rule used (export), or to be used (import)</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="MirroringInfo">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">
        information about the linked or mirrored deals
      </xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="parentId" type="xsd:double" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">This contains the id of the parent deal. It is -1 if the deal is a parent</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="childId" type="xsd:double" minOccurs="0" maxOccurs="unbounded">
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">This contains the id of child deal. There can be several. It depends on the number of behaviors for the mirror rule</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:simpleType name="FeeType">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">
        Type of fee detailed
      </xsd:documentation>
    </xsd:annotation>
    <xsd:restriction base="xsd:token">
      <xsd:enumeration value="ERROR" />
      <xsd:enumeration value="Broker Fee" />
      <xsd:enumeration value="Counterparty Fee" />
      <xsd:enumeration value="Market Fee" />
      <xsd:enumeration value="No impact on transaction" />
    </xsd:restriction>
  </xsd:simpleType>
  <xsd:complexType name="DetailedFee">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">
        Fee information
      </xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="name" type="xsd:string">
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">Fee name taken from Fees definition.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="type" type="tns:FeeType">
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">Fee type taken from Fees definition. Type specifies in which standard fee the mount in deal currency is aggregated.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="third" type="party:PartyRole" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">Third value linked to the detailed fee.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="currency" type="instrument:Currency">
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">Currency specific for this fee.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="feeAmount" type="xsd:double">
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">Fee amount specified in fee currency.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="forexRate" type="xsd:double">
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">Forex rate between the fee currency and the reference currency from the deal.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="forexOrder" type="tns:Certainty">
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">Forex order between the fee currency and the reference currency from the deal.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="amountInDealCurrency" type="xsd:double">
        <xsd:annotation>
          <xsd:documentation source="http://www.sophis.net" xml:lang="en">Fee amount converted to the deal currency. This amount is aggregated to the standard fees.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="MasterAgreement">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">An entity for defining the agreement executed between the parties and intended to govern all OTC derivatives transactions between those parties.</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="masterAgreementType" type="tns:MasterAgreementType">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">The agreement executed between the parties and intended to govern product-specific derivatives transactions between those parties.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="masterAgreementVersion" type="tns:MasterAgreementVersion" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">The version of the master agreement.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="masterAgreementDate" type="xsd:date" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">The date on which the master agreement was signed.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="MasterAgreementType">
    <xsd:simpleContent>
      <xsd:extension base="xsd:normalizedString">
        <xsd:attribute name="masterAgreementTypeScheme" type="xsd:anyURI" default="http://www.fpml.org/coding-scheme/master-agreement-type" />
      </xsd:extension>
    </xsd:simpleContent>
  </xsd:complexType>
  <xsd:complexType name="MasterAgreementVersion">
    <xsd:simpleContent>
      <xsd:extension base="xsd:normalizedString">
        <xsd:attribute name="masterAgreementVersionScheme" type="xsd:anyURI" default="http://www.fpml.org/coding-scheme/master-agreement-version" />
      </xsd:extension>
    </xsd:simpleContent>
  </xsd:complexType>
  <xsd:complexType name="MasterConfirmation">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">An entity for defining the master confirmation agreement executed between the parties.</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="masterConfirmationType" type="tns:MasterConfirmationType">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">The type of master confirmation executed between the parties.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="masterConfirmationDate" type="xsd:date">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">The date of the confirmation executed between the parties and intended to govern all relevant transactions between those parties.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="masterConfirmationAnnexDate" type="xsd:date" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">The date that an annex to the master confirmation was executed between the parties.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="masterConfirmationAnnexType" type="tns:MasterConfirmationAnnexType" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">The type of master confirmation annex executed between the parties.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="MasterConfirmationAnnexType">
    <xsd:simpleContent>
      <xsd:extension base="xsd:normalizedString">
        <xsd:attribute name="masterConfirmationAnnexTypeScheme" type="xsd:anyURI" default="http://www.fpml.org/coding-scheme/master-confirmation-annex-type" />
      </xsd:extension>
    </xsd:simpleContent>
  </xsd:complexType>
  <xsd:complexType name="MasterConfirmationType">
    <xsd:simpleContent>
      <xsd:extension base="xsd:normalizedString">
        <xsd:attribute name="masterConfirmationTypeScheme" type="xsd:anyURI" default="http://www.fpml.org/coding-scheme/master-confirmation-type" />
      </xsd:extension>
    </xsd:simpleContent>
  </xsd:complexType>
  <xsd:complexType name="MatrixType">
    <xsd:simpleContent>
      <xsd:extension base="xsd:normalizedString">
        <xsd:attribute name="matrixTypeScheme" type="xsd:anyURI" default="http://www.fpml.org/coding-scheme/matrix-type" />
      </xsd:extension>
    </xsd:simpleContent>
  </xsd:complexType>
  <xsd:complexType name="MatrixTerm">
    <xsd:simpleContent>
      <xsd:extension base="xsd:normalizedString">
        <xsd:attribute name="matrixTermScheme" type="xsd:anyURI" default="http://www.fpml.org/coding-scheme/credit-matrix-transaction-type" />
      </xsd:extension>
    </xsd:simpleContent>
  </xsd:complexType>
  <xsd:complexType name="ContractualMatrix">
    <xsd:sequence>
      <xsd:element name="matrixType" type="tns:MatrixType">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">Identifies the form of applicable matrix.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="publicationDate" type="xsd:date" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">Specifies the publication date of the applicable version of the matrix. When this element is omitted, the ISDA supplemental language for incorporation of the relevant matrix will generally define rules for which version of the matrix is applicable.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="matrixTerm" type="tns:MatrixTerm" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">Defines any applicable key into the relevant matrix. For example, the Transaction Type would be the single term required for the Credit Derivatives Physical Settlement Matrix. This element should be omitted in the case of the 2000 ISDA Definitions Settlement Matrix for Early Termination and Swaptions.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="ContractualSupplement">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">A contractual supplement (such as those published by ISDA) that will apply to the trade.</xsd:documentation>
    </xsd:annotation>
    <xsd:simpleContent>
      <xsd:extension base="xsd:normalizedString">
        <xsd:attribute name="contractualSupplementScheme" type="xsd:anyURI" default="http://www.fpml.org/coding-scheme/contractual-supplement" />
      </xsd:extension>
    </xsd:simpleContent>
  </xsd:complexType>
  <xsd:complexType name="ContractualTermsSupplement">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">A contractual supplement (such as those published by ISDA) and its publication date that will apply to the trade.</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="type" type="tns:ContractualSupplement">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">Identifies the form of applicable contractual supplement.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="publicationDate" type="xsd:date" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">Specifies the publication date of the applicable version of the contractual supplement.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="AgreementIdentifier">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">Agreement External Reference Id : Identifies collateral agreement.</xsd:documentation>
    </xsd:annotation>
    <xsd:simpleContent>
      <xsd:extension base="xsd:normalizedString">
        <xsd:attribute name="creditSupportAgreementIdScheme" type="xsd:anyURI" default="http://www.sophis.net/CollateralAgreement/Identifier"/>
      </xsd:extension>
    </xsd:simpleContent>
  </xsd:complexType>
  <xsd:complexType name="AgreementType">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">Agreement Convention.</xsd:documentation>
    </xsd:annotation>
    <xsd:simpleContent>
      <xsd:extension base="xsd:normalizedString">
        <xsd:attribute name="creditSupportAgreementTypeScheme" type="xsd:anyURI" default="http://www.fpml.org/coding-scheme/credit-support-agreement-type" />
      </xsd:extension>
    </xsd:simpleContent>
  </xsd:complexType>
  <xsd:complexType name="AgreementProperty">
    <xsd:sequence>
      <xsd:element name="propertyName" type="xsd:string">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">The name of the property</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="propertyValue" type="xsd:string">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">The value of the property</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="AgreementProperties">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">The properties of Credit Support Agreement</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element minOccurs="0" name="agreementProperty" type="tns:AgreementProperty"/>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="CreditSupportAgreement">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">The agreement executed between the parties and intended to govern collateral arrangement for all OTC derivatives transactions between those parties.</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="type" type="tns:AgreementType">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">The type of ISDA Credit Support Agreement</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="date" type="xsd:date">
        <xsd:annotation>
          <xsd:documentation>The date of the agreement executed between the parties and intended to govern collateral arrangements for all OTC derivatives transactions between those parties.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="identifier" type="tns:AgreementIdentifier">
        <xsd:annotation>
          <xsd:documentation>An identifier used to uniquely identify the CSA</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element minOccurs="0" name="agreementProperties" type="tns:AgreementProperties">
        <xsd:annotation>
          <xsd:documentation>The properties of the agreement</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="Documentation">
    <xsd:annotation>
      <xsd:documentation xml:lang="en">An entity for defining the definitions that govern the document and should include the year and type of definitions referenced, along with any relevant documentation (such as master agreement) and the date it was signed.</xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="masterAgreement" type="tns:MasterAgreement" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">The agreement executed between the parties and intended to govern all OTC derivatives transactions between those parties.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="masterConfirmation" type="tns:MasterConfirmation" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">The agreement executed between the parties and intended to govern all OTC derivatives transactions between those parties.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="contractualTermsSupplement" type="tns:ContractualTermsSupplement" minOccurs="0" maxOccurs="unbounded">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">A contractual supplement (such as those published by ISDA) that will apply to the trade.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="contractualMatrix" type="tns:ContractualMatrix" minOccurs="0" maxOccurs="unbounded">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">A reference to a contractual matrix of elected terms/values (such as those published by ISDA) that shall be deemed to apply to the trade. The applicable matrix is identified by reference to a name and optionally a publication date. Depending on the structure of the matrix, an additional term (specified in the matrixTerm element) may be required to further identify a subset of applicable terms/values within the matrix.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="creditSupportAgreement" type="tns:CreditSupportAgreement" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">The agreement executed between the parties and intended to govern collateral arrangement for all OTC derivatives transactions between those parties.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="TradeDocumentation">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">
        since 7.1: Trade Documentation
      </xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element ref="tns:tradeIdentifier" />
      <xsd:element name="calculationAgentBusinessCenter" minOccurs="0" type="common:BusinessCenter"/>
      <xsd:element name="documentation" minOccurs="0" type="tns:Documentation"/>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:element name="tradeDocumentation" type="tns:TradeDocumentation" />
  <xsd:element name="repoExecution" type="tns:RepoExecution" />

  <!-- For swap trade -->
  <xsd:simpleType name="DividendEligibility">
    <xsd:restriction base="xsd:string">
      <xsd:enumeration value="Standard" />
      <xsd:enumeration value="Special ex" />
      <xsd:enumeration value="Special cum" />
    </xsd:restriction>
  </xsd:simpleType>

  <xsd:simpleType name="MarketWayForFX">
    <xsd:restriction base="xsd:string">
      <xsd:enumeration value="WrapperVSInstrument" />
      <xsd:enumeration value="InstrumentVSWrapper" />
    </xsd:restriction>
  </xsd:simpleType>

  <xsd:simpleType name="SyntheticReset">
    <xsd:restriction base="xsd:string">
      <xsd:enumeration value="No" />
      <xsd:enumeration value="Yes" />
    </xsd:restriction>
  </xsd:simpleType>

  <xsd:simpleType name="SpreadReset">
    <xsd:restriction base="xsd:string">
      <xsd:enumeration value="None" />
      <xsd:enumeration value="Funding spread" />
      <xsd:enumeration value="Borrowing spread" />
      <xsd:enumeration value="Both" />
    </xsd:restriction>
  </xsd:simpleType>

  <xsd:simpleType name="TimingPayment">
    <xsd:restriction base="xsd:string">
      <xsd:enumeration value="Immediate payment" />
      <xsd:enumeration value="Deferred payment" />
    </xsd:restriction>
  </xsd:simpleType>

  <xsd:complexType name="SwapTradeAdditionalFields">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en">
        Used to describe swap trade.
      </xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element name="irIndex" type="xsd:int" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            The interest rate index for swap trade.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="irFixingLong" type="xsd:double" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            The IR fixing long for swap trade.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="irFixingShort" type="xsd:double" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            The IR fixing short for swap trade.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="fundingSpreadLong" type="xsd:double" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            The funding spread long for swap trade.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="fundingSpreadShort" type="xsd:double" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            The funding spread short for swap trade.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="borrowingSpreadLong" type="xsd:double" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            The borrowing spread long for swap trade.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="borrowingSpreadShort" type="xsd:double" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            The borrowing spread short for swap trade.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="dividendRatioLong" type="xsd:double" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            The dividend ratio long for swap trade.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="dividendRatioShort" type="xsd:double" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            The dividend ratio short for swap trade.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="dividendEligibility" type="tns:DividendEligibility" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            The dividend eligibility for swap trade.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="convention" type="xsd:int" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            The master agreement for swap trade.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="marketWayForFX" type="tns:MarketWayForFX" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            The market way of FX for swap trade.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="syntheticReset" type="tns:SyntheticReset" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            The synthetic reset for asset price of swap trade.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="spreadReset" type="tns:SpreadReset" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            The spread reset for swap trade.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="timingPayment" type="tns:TimingPayment" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            The timing payment for swap trade.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="wrapperId" type="xsd:int" minOccurs="0" maxOccurs="1">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            The wrapper ID for swap trade.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
  </xsd:complexType>

  <xsd:simpleType name="RepoSide">
    <xsd:restriction base="xsd:string">
      <xsd:enumeration value="ReverseRepo"/>
      <xsd:enumeration value="Repo"/>
    </xsd:restriction>
  </xsd:simpleType>

  <xsd:complexType name="RepoExecution">
    <xsd:sequence>
      <xsd:element name="side" type="tns:RepoSide" />
      <xsd:element name="securityID" type="instrument:Identifier"/>
      <xsd:element name="convention" type="xsd:int" minOccurs="0"/>
      <xsd:element name="agreement" type="xsd:int" minOccurs="0"/>
      <xsd:element name="term" type="xsd:int"/>
      <xsd:element name="currency" type="instrument:Currency"/>
      <xsd:element name="interestRate" type="instrument:Identifier" minOccurs="0"/>
      <xsd:element name="paymentMethod" type="xsd:int" />
      <xsd:element name="rateOrSpread" type="xsd:double" />
      <xsd:element name="amount" type="xsd:double" />
      <xsd:element name="marginRatio" type="xsd:double" />
      <xsd:element name="collateralSettlementDate" type="xsd:date" />
      <xsd:element name="startDate" type="xsd:date" />
      <xsd:element name="maturity" type="xsd:date" minOccurs="0"/>
      <xsd:element name="collateralSecurities" type="tns:CollateralSecurities" minOccurs="0"/>
    </xsd:sequence>
  </xsd:complexType>

  <xsd:complexType name="CollateralSecurities">
    <xsd:sequence>
      <xsd:element name="collateralSecurity" type="tns:CollateralSecurity" maxOccurs="unbounded"/>
    </xsd:sequence>
  </xsd:complexType>

  <xsd:complexType name="CollateralSecurity">
    <xsd:sequence>
      <xsd:element name="identifier" type="instrument:Identifier" minOccurs="0"/>
      <xsd:element name="hairCut" type="xsd:double" />
      <xsd:element name="quantity" type="xsd:double" />
      <xsd:element name="allInPrice" type="xsd:double" />
      <xsd:element name="nominal" type="xsd:double" />
    </xsd:sequence>
  </xsd:complexType>

  <xsd:element name="pledgeExecution" type="tns:PledgeExecution" />

  <xsd:simpleType name="PledgeSide">
    <xsd:restriction base="xsd:string">
      <xsd:enumeration value="Pledge-In"/>
      <xsd:enumeration value="Pledge-Out"/>
    </xsd:restriction>
  </xsd:simpleType>

  <xsd:complexType name="PledgeExecution">
    <xsd:sequence>
      <xsd:element name="side" type="tns:PledgeSide" />
      <xsd:element name="convention" type="xsd:int" minOccurs="0" />
      <xsd:element name="agreement" type="xsd:int" minOccurs="0" />
      <xsd:element name="collateralSettlementDate" type="xsd:date" />
      <xsd:element name="collateralSecurities" type="tns:CollateralSecurities"/>
    </xsd:sequence>
  </xsd:complexType>

  <xsd:complexType name="Allocation">
    <xsd:sequence>
      <xsd:element name="allocationTradeId" type="tns:TradeIdentifier">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">Unique ID for the allocation.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element ref="party:partyReference" minOccurs="0">
        <xsd:annotation>
          <xsd:documentation source="http://www.FpML.org" xml:lang="en">The party referenced has allocated the trade identifier.</xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:choice>
        <xsd:element name="allocatedFraction" type="xsd:decimal">
          <xsd:annotation>
            <xsd:documentation source="http://www.FpML.org" xml:lang="en">The fractional allocation (0.45 = 45%) of the notional and "block" fees to this particular client subaccount.</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
        <xsd:element name="allocatedNotional" type="instrument:Money" maxOccurs="2">
          <xsd:annotation>
            <xsd:documentation source="http://www.FpML.org" xml:lang="en">The notional allocation (amount and currency) to this particular client account.</xsd:documentation>
          </xsd:annotation>
        </xsd:element>
      </xsd:choice>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="Allocations">
    <xsd:sequence>
      <xsd:element name="allocation" type="tns:Allocation" minOccurs="1" maxOccurs="unbounded"/>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:complexType name="TradeAllocationDetails">
    <xsd:sequence>
      <xsd:element name="allocationEngine" type="xsd:string" />
      <xsd:element name="blockTradeIdentifier" type="tns:TradeIdentifier" />
      <xsd:element name="allocations" type="tns:Allocations" />
    </xsd:sequence>
  </xsd:complexType>
  <xsd:element name="tradeAllocationDetails" type="tns:TradeAllocationDetails" />
  <xsd:complexType name="TradeAllocationDetailsExport">
    <xsd:sequence>
      <xsd:element name="allocationEngine" type="xsd:string" minOccurs="0"/>
      <xsd:choice>
        <xsd:sequence>
          <xsd:element name="tradeIdentifier" type="tns:TradeIdentifier" minOccurs="1" maxOccurs="unbounded">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">Identifier of a trade part of an allocation.</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="blockTradeIdentifier" type="tns:TradeIdentifier" minOccurs="0" maxOccurs="unbounded">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">Identifier of a trade acting as the block in an allocation.</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="allocationTradeId" type="tns:TradeIdentifier" minOccurs="0" maxOccurs="unbounded">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">Identifier of a allocated trade part of an allocation.</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
        </xsd:sequence>
        <xsd:sequence>
          <xsd:element name="blockTradeIdentifier" type="tns:TradeIdentifier" minOccurs="1" maxOccurs="unbounded">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">Identifier of a trade acting as the block in an allocation.</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
          <xsd:element name="allocationTradeId" type="tns:TradeIdentifier" minOccurs="0" maxOccurs="unbounded">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">Identifier of a allocated trade part of an allocation.</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
        </xsd:sequence>
        <xsd:sequence>
          <xsd:element name="allocationTradeId" type="tns:TradeIdentifier" minOccurs="1" maxOccurs="unbounded">
            <xsd:annotation>
              <xsd:documentation xml:lang="en">Identifier of a allocated trade part of an allocation.</xsd:documentation>
            </xsd:annotation>
          </xsd:element>
        </xsd:sequence>
      </xsd:choice>
    </xsd:sequence>
  </xsd:complexType>
  <xsd:element name="tradeAllocationDetailsExport" type="tns:TradeAllocationDetailsExport" />

  <xsd:complexType name="BsTradeRematch">
    <xsd:annotation>
      <xsd:documentation source="http://www.sophis.net" xml:lang="en"></xsd:documentation>
    </xsd:annotation>
    <xsd:sequence>
      <xsd:element ref="tns:tradeIdentifier">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            Contains a list of trade references.
            1. The references marked with search="true" will be used to find the trade. Not found means error.
            2. The trade is applied the MO Creation event
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="execExternalRef" type="xsd:string" minOccurs="0" />
      <xsd:element name="matchId" type="tns:TradeId">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            3. Regarding this matchId: the existing value of the trade is stored in a "ToCancel" table and the new value is saved at the trade level.
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
      <xsd:element name="unchangedSide" type="xsd:string">
        <xsd:annotation>
          <xsd:documentation xml:lang="en">
            Indicates which side is unchanged. For example if the rematch triggered by a hedge trade then the adjustment trades have to be cancelled.
            In the case of Traiana, the valid values for unchangedSide are "Broker" (hedge) and "Client" (adjustment)
          </xsd:documentation>
        </xsd:annotation>
      </xsd:element>
    </xsd:sequence>
    <xsd:attributeGroup ref="common:PersistentEntity.model">
      <xsd:annotation>
        <xsd:documentation xml:lang="en">persitenceType for import</xsd:documentation>
      </xsd:annotation>
    </xsd:attributeGroup>
  </xsd:complexType>
  <xsd:element name="bsTradeRematch" type="tns:BsTradeRematch" />

</xsd:schema>

